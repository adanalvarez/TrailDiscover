{
    "title": "TrailDiscover AWS Events Insights",
    "description": "",
    "widgets": [
        {
            "id": 2066777487,
            "definition": {
                "type": "image",
                "url": "https://traildiscover.cloud/logo.png",
                "sizing": "contain",
                "margin": "md",
                "has_background": false,
                "has_border": false,
                "vertical_align": "center",
                "horizontal_align": "center"
            },
            "layout": {
                "x": 0,
                "y": 0,
                "width": 6,
                "height": 2
            }
        },
        {
            "id": 8265946211738038,
            "definition": {
                "type": "group",
                "layout_type": "ordered",
                "background_color": "blue",
                "title": "Overview",
                "show_title": true,
                "widgets": [
                    {
                        "id": 8265946211738036,
                        "definition": {
                            "title": "MITRE ATT&CK Tactics Events Timeline",
                            "title_size": "16",
                            "title_align": "left",
                            "show_legend": true,
                            "legend_layout": "auto",
                            "legend_columns": [
                                "avg",
                                "min",
                                "max",
                                "value",
                                "sum"
                            ],
                            "time": {},
                            "type": "timeseries",
                            "requests": [
                                {
                                    "formulas": [
                                        {
                                            "alias": "TA0003 - Persistence",
                                            "formula": "query1"
                                        },
                                        {
                                            "alias": "TA0040 - Impact",
                                            "formula": "query2"
                                        },
                                        {
                                            "alias": "TA0007 - Discovery",
                                            "formula": "query3"
                                        },
                                        {
                                            "alias": "TA0005 - Defense Evasion",
                                            "formula": "query4"
                                        },
                                        {
                                            "alias": "TA0001 - Initial Access",
                                            "formula": "query5"
                                        },
                                        {
                                            "alias": "TA0008 - Lateral Movement",
                                            "formula": "query6"
                                        },
                                        {
                                            "alias": "TA0004 - Privilege Escalation",
                                            "formula": "query7"
                                        },
                                        {
                                            "alias": "TA0009 - Collection",
                                            "formula": "query8"
                                        },
                                        {
                                            "alias": "TA0006 - Credential Access",
                                            "formula": "query9"
                                        },
                                        {
                                            "alias": "TA0010 - Exfiltration",
                                            "formula": "query10"
                                        },
                                        {
                                            "alias": "TA0002 - Execution",
                                            "formula": "query11"
                                        }
                                    ],
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:(AddMemberToGroup OR CreateGroup OR UpdateSsoConfiguration OR CreateAccountAssignment OR CreateUser OR GetFederationToken OR AssumeRole OR CreateFunction20150331 OR UpdateFunctionConfiguration20150331v2 OR AddPermission20150331v2 OR UpdateFunctionCode20150331v2 OR PutTargets OR PutRule OR CreateSAMLProvider OR UpdateLoginProfile OR UpdateAccessKey OR UpdateAssumeRolePolicy OR CreateAccessKey OR UpdateSAMLProvider OR StartSSO OR CreateOpenIDConnectProvider OR AttachUserPolicy OR PutUserPolicy OR ChangePassword OR CreateLoginProfile OR CreateUser OR CreateRole OR UpdateGraphqlApi OR CreateApiKey OR UpdateResolver OR StartInstances OR CreateSecurityGroup OR CreateDefaultVpc OR CreateNetworkAclEntry OR CreateKeyPair OR AuthorizeSecurityGroupIngress OR RunInstances OR ImportKeyPair OR CreateStage OR CreateApi OR CreateIntegration OR CreateRoute) $userIdentity.arn $network.client.ip $account"
                                            },
                                            "group_by": [],
                                            "storage": "hot"
                                        },
                                        {
                                            "data_source": "logs",
                                            "name": "query2",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:(ChangeResourceRecordSets OR RegisterDomain OR CreateHostedZone OR CreateStack OR Publish OR CreateFunction20150331 OR UpdateFunctionCode20150331v2 OR Invoke OR DeleteFileSystem OR DeleteMountTarget OR DeleteRule OR RemoveTargets OR DisableRule OR PutRule OR CreateInstances OR GenerateDataKeyWithoutPlaintext OR PutKeyPolicy OR ScheduleKeyDeletion OR Encrypt OR CreateKey OR PutObject OR PutBucketVersioning OR PutBucketLifecycle OR DeleteBucket OR PutBucketEncryption OR DeleteObject OR InvokeModel OR PutFoundationModelEntitlement OR InvokeModelWithResponseStream OR PutUseCaseForModelAccess OR CreateFoundationModelAgreement OR DeleteVolume OR StartInstances OR CreateDefaultVpc OR TerminateInstances OR StopInstances OR DeleteSnapshot OR RunInstances OR DeleteGlobalCluster OR DeleteDBCluster OR DeleteDBInstance OR CreateEmailIdentity OR UpdateAccountSendingEnabled OR VerifyEmailIdentity OR RegisterTaskDefinition OR CreateService OR CreateCluster OR RequestServiceQuotaIncrease) $userIdentity.arn $network.client.ip $account"
                                            },
                                            "group_by": [],
                                            "storage": "hot"
                                        },
                                        {
                                            "data_source": "logs",
                                            "name": "query3",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:(ListDomains OR GetHostedZoneCount OR DescribeOrganization OR ListOrganizationalUnitsForParent OR ListAccounts OR GetCallerIdentity OR ListTopics OR ListSubscriptions OR ListOriginationNumbers OR GetSMSAttributes OR GetSMSSandboxAccountStatus OR IssueCertificate OR GetCertificate OR DescribeLogGroups OR DescribeSubscriptionFilters OR DescribeLogStreams OR GetLogRecord OR GetQueryResults OR ListTargetsByRule OR ListRules OR GetInstances OR GetRegions OR GetCostAndUsage OR ListGroupsForUser OR ListAccessKeys OR ListUserPolicies OR SimulatePrincipalPolicy OR GetAccountAuthorizationDetails OR ListGroups OR ListUsers OR ListAttachedUserPolicies OR ListRoles OR ListSAMLProviders OR GetUser OR ListAttachedRolePolicies OR ListServiceSpecificCredentials OR ListRolePolicies OR ListSigningCertificates OR ListInstanceProfiles OR ListSSHPublicKeys OR ListOpenIDConnectProviders OR GetLoginProfile OR DescribeLoadBalancers OR DescribeListeners OR ListAssociatedAccessPolicies OR ListClusters OR DescribeAccessEntry OR DescribeCluster OR Search OR DescribeKey OR LookupEvents OR GetIntrospectionSchema OR GetBucketVersioning OR GetBucketAccelerateConfiguration OR GetBucketLogging OR GetObjectLockConfiguration OR GetBucketPolicy OR GetBucketOwnershipControls OR ListBuckets OR GetBucketReplication OR GetBucketLocation OR GetBucketAcl OR HeadObject OR ListVaults OR GetBucketLifecycle OR GetPublicAccessBlock OR GetBucketTagging OR GetBucketRequestPayment OR ListObjects OR InvokeModel OR GetUseCaseForModelAccess OR ListProvisionedModelThroughputs OR GetFoundationModelAvailability OR ListFoundationModels OR ListFoundationModelAgreementOffers OR GetModelInvocationLoggingConfiguration OR GetConsoleScreenshot OR DescribeSnapshotTierStatus OR DescribeImages OR GetEbsDefaultKmsKeyId OR DescribeAvailabilityZones OR DescribeInstances OR GetTransitGatewayRouteTableAssociations OR GetLaunchTemplateData OR DescribeKeyPairs OR GetEbsEncryptionByDefault OR DescribeCarrierGateways OR GetFlowLogsIntegrationTemplate OR DescribeTransitGatewayMulticastDomains OR DescribeInstanceAttribute OR DescribeDhcpOptions OR DescribeVpcEndpointConnectionNotifications OR DescribeFlowLogs OR DescribeSnapshotAttribute OR DescribeVolumesModifications OR DescribeRegions OR DescribeSecurityGroups OR DescribeVpcs OR DescribeBundleTasks OR DescribeAccountAttributes OR DescribeVolumes OR DescribeInstanceTypes OR DescribeClientVpnRoutes OR GetLaunchTemplateData OR GetParameters OR DescribeInstanceInformation OR ListEmailIdentities OR GetIdentityVerificationAttributes OR GetAccountSendingEnabled OR ListIdentities OR GetSendQuota OR GetAccount OR GetFindings OR ListFindings OR ListDetectors OR GetDetector OR ListIPSets OR ListServiceQuotas) $userIdentity.arn $network.client.ip $account"
                                            },
                                            "group_by": [],
                                            "storage": "hot"
                                        },
                                        {
                                            "data_source": "logs",
                                            "name": "query4",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:(InviteAccountToOrganization OR CreateAccount OR LeaveOrganization OR PutLogEvents OR DeleteAlarms OR DeleteLogGroup OR DeleteLogStream OR CreateLogStream OR DeleteRule OR RemoveTargets OR DisableRule OR PutRule OR CreateInstances OR DeleteMembers OR DetachRolePolicy OR DeleteUserPolicy OR DeleteAccessKey OR DeleteUser OR DetachUserPolicy OR DeleteLoginProfile OR DeactivateMFADevice OR CreateRule OR StopLogging OR UpdateTrail OR DeleteTrail OR PutEventSelectors OR UpdateGraphqlApi OR CreateApiKey OR UpdateResolver OR DeleteBucketPolicy OR DeleteFlowLogs OR DeleteNetworkAcl OR TerminateInstances OR DeleteNetworkAclEntry OR StopInstances OR AuthorizeDBSecurityGroupIngress OR ModifyActivityStream OR DeleteIdentity OR UpdateIPSet OR DeleteInvitations OR UpdateDetector OR DeleteDetector OR DeletePublishingDestination OR DisassociateMembers OR DisassociateFromMasterAccount OR StopMonitoringMembers OR CreateIPSet OR CreateFilter OR DeleteMembers OR DeleteConfigurationRecorder OR DeleteDeliveryChannel OR StopConfigurationRecorder OR DeleteConfigRule OR DeleteRuleGroup OR UpdateIPSet OR DeleteWebACL) $userIdentity.arn $network.client.ip $account"
                                            },
                                            "group_by": [],
                                            "storage": "hot"
                                        },
                                        {
                                            "data_source": "logs",
                                            "name": "query5",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:(AssumeRoleWithWebIdentity OR GetSessionToken OR AssumeRole OR AssumeRoleWithSAML OR PasswordRecoveryRequested OR ConsoleLogin OR GetSigninToken) $userIdentity.arn $network.client.ip $account"
                                            },
                                            "group_by": [],
                                            "storage": "hot"
                                        },
                                        {
                                            "data_source": "logs",
                                            "name": "query6",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:(AssumeRoleWithWebIdentity OR SwitchRole OR EnableSerialConsoleAccess OR CreateVolume OR CreateSecurityGroup OR AuthorizeSecurityGroupIngress OR SendSSHPublicKey OR CreateSnapshot OR RunInstances OR AttachVolume OR SendSerialConsoleSSHPublicKey OR ModifyDBInstance OR SendCommand OR StartSession OR ResumeSession) $userIdentity.arn $network.client.ip $account"
                                            },
                                            "group_by": [],
                                            "storage": "hot"
                                        },
                                        {
                                            "data_source": "logs",
                                            "name": "query7",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:(AssumeRole OR GetCredentialsForIdentity OR GetId OR CreateFunction20150331 OR CreateEventSourceMapping20150331 OR AddPermission20150331v2 OR Invoke OR UpdateEventSourceMapping20150331 OR DeleteRolePolicy OR DetachRolePolicy OR UpdateLoginProfile OR CreatePolicy OR AddUserToGroup OR UpdateAssumeRolePolicy OR CreateAccessKey OR CreatePolicyVersion OR DeleteUserPolicy OR UpdateSAMLProvider OR PutRolePermissionsBoundary OR PutUserPermissionsBoundary OR DeleteUserPermissionsBoundary OR AttachRolePolicy OR SetDefaultPolicyVersion OR AttachUserPolicy OR CreateGroup OR PutUserPolicy OR DeleteRolePermissionsBoundary OR PutGroupPolicy OR ChangePassword OR CreateLoginProfile OR DetachUserPolicy OR PutRolePolicy OR AddRoleToInstanceProfile OR AttachGroupPolicy OR AssociateAccessPolicy OR CreateAccessEntry OR ModifyInstanceAttribute OR ReplaceIamInstanceProfileAssociation OR CreateDevEndpoint OR UpdateJob OR CreateJob OR UpdateDevEndpoint) $userIdentity.arn $network.client.ip $account"
                                            },
                                            "group_by": [],
                                            "storage": "hot"
                                        },
                                        {
                                            "data_source": "logs",
                                            "name": "query8",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:(UpdateFunctionCode20150331v2 OR UpdateDistribution OR PublishFunction OR CreateFunction OR CreateInstanceExportTask OR CreateTrafficMirrorTarget OR CreateTrafficMirrorSession OR CreateRoute OR CreateTrafficMirrorFilter OR CreateTrafficMirrorFilterRule) $userIdentity.arn $network.client.ip $account"
                                            },
                                            "group_by": [],
                                            "storage": "hot"
                                        },
                                        {
                                            "data_source": "logs",
                                            "name": "query9",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:(GetSecretValue OR DescribeSecret OR ListSecrets OR GetPasswordData OR ModifyDBInstance OR GetParameters) $userIdentity.arn $network.client.ip $account"
                                            },
                                            "group_by": [],
                                            "storage": "hot"
                                        },
                                        {
                                            "data_source": "logs",
                                            "name": "query10",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:(CreateUser OR CreateServer OR PutBucketPolicy OR PutBucketAcl OR PutBucketVersioning OR PutBucketReplication OR GetObject OR JobCreated OR CreateInstanceExportTask OR ModifySnapshotAttribute OR SharedSnapshotCopyInitiated OR SharedSnapshotVolumeCreated OR CreateSnapshot OR CreateImage OR AuthorizeSecurityGroupEgress OR ModifyImageAttribute OR ModifyDBSnapshotAttribute OR StartExportTask OR CreateDBSecurityGroup OR CreateDBSnapshot) $userIdentity.arn $network.client.ip $account"
                                            },
                                            "group_by": [],
                                            "storage": "hot"
                                        },
                                        {
                                            "data_source": "logs",
                                            "name": "query11",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:(SendCommand OR StartSession OR ResumeSession) $userIdentity.arn $network.client.ip $account"
                                            },
                                            "group_by": [],
                                            "storage": "hot"
                                        }
                                    ],
                                    "response_format": "timeseries",
                                    "style": {
                                        "palette": "dog_classic",
                                        "line_type": "solid",
                                        "line_width": "normal"
                                    },
                                    "display_type": "bars"
                                }
                            ]
                        },
                        "layout": {
                            "x": 0,
                            "y": 2,
                            "width": 6,
                            "height": 2
                        }
                    },
                    {
                        "id": 2985843941260464,
                        "definition": {
                            "title": "Top 10 CloudTrail Events exploited in the wild",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "toplist",
                            "requests": [
                                {
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "group_by": [
                                                {
                                                    "facet": "@evt.name",
                                                    "limit": 10,
                                                    "sort": {
                                                        "order": "desc",
                                                        "aggregation": "count"
                                                    }
                                                }
                                            ],
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:(AddMemberToGroup OR CreateGroup OR UpdateSsoConfiguration OR CreateAccountAssignment OR CreateUser OR ChangeResourceRecordSets OR RegisterDomain OR CreateHostedZone OR InviteAccountToOrganization OR CreateAccount OR DescribeOrganization OR ListOrganizationalUnitsForParent OR ListAccounts OR CreateStack OR GetFederationToken OR GetSessionToken OR AssumeRole OR GetCallerIdentity OR GetSMSAttributes OR Publish OR GetSMSSandboxAccountStatus OR PutLogEvents OR DescribeLogGroups OR DescribeSubscriptionFilters OR DescribeLogStreams OR GetLogRecord OR CreateLogStream OR PasswordRecoveryRequested OR SwitchRole OR ConsoleLogin OR GetSigninToken OR CreateFunction20150331 OR AddPermission20150331v2 OR Invoke OR GetQueryResults OR PutTargets OR PutRule OR CreateInstances OR GetCostAndUsage OR ListGroupsForUser OR CreateSAMLProvider OR ListAccessKeys OR DetachRolePolicy OR ListUserPolicies OR UpdateLoginProfile OR SimulatePrincipalPolicy OR CreatePolicy OR ListGroups OR ListUsers OR CreateAccessKey OR DeleteUserPolicy OR ListAttachedUserPolicies OR ListRoles OR StartSSO OR ListSAMLProviders OR GetUser OR DeleteAccessKey OR DeleteUser OR AttachRolePolicy OR CreateOpenIDConnectProvider OR AttachUserPolicy OR ListAttachedRolePolicies OR PutUserPolicy OR ListServiceSpecificCredentials OR ListRolePolicies OR CreateLoginProfile OR CreateUser OR ListSigningCertificates OR ListInstanceProfiles OR DetachUserPolicy OR ListSSHPublicKeys OR ListOpenIDConnectProviders OR CreateRole OR DeleteLoginProfile OR AttachGroupPolicy OR GetLoginProfile OR GetSecretValue OR DescribeSecret OR ListSecrets OR CreateUser OR CreateServer OR Search OR GenerateDataKeyWithoutPlaintext OR Encrypt OR LookupEvents OR UpdateTrail OR DeleteTrail OR PutEventSelectors OR PutObject OR GetBucketVersioning OR PutBucketVersioning OR GetBucketAccelerateConfiguration OR GetBucketLogging OR GetObjectLockConfiguration OR GetBucketPolicy OR GetBucketOwnershipControls OR ListBuckets OR GetBucketReplication OR GetObject OR GetBucketLocation OR PutBucketLifecycle OR DeleteBucket OR GetBucketAcl OR HeadObject OR ListVaults OR GetBucketLifecycle OR GetPublicAccessBlock OR GetBucketTagging OR DeleteObject OR GetBucketRequestPayment OR ListObjects OR InvokeModel OR GetUseCaseForModelAccess OR ListProvisionedModelThroughputs OR PutFoundationModelEntitlement OR InvokeModelWithResponseStream OR PutUseCaseForModelAccess OR GetFoundationModelAvailability OR ListFoundationModels OR ListFoundationModelAgreementOffers OR GetModelInvocationLoggingConfiguration OR CreateFoundationModelAgreement OR GetConsoleScreenshot OR DeleteVolume OR DescribeSnapshotTierStatus OR DescribeImages OR GetEbsDefaultKmsKeyId OR EnableSerialConsoleAccess OR DescribeAvailabilityZones OR GetPasswordData OR CreateVolume OR StartInstances OR CreateSecurityGroup OR DescribeInstances OR GetTransitGatewayRouteTableAssociations OR ModifySnapshotAttribute OR CreateDefaultVpc OR DeleteFlowLogs OR GetLaunchTemplateData OR DescribeKeyPairs OR GetEbsEncryptionByDefault OR CreateKeyPair OR SharedSnapshotCopyInitiated OR DescribeCarrierGateways OR TerminateInstances OR GetFlowLogsIntegrationTemplate OR DescribeTransitGatewayMulticastDomains OR StopInstances OR DescribeInstanceAttribute OR DescribeDhcpOptions OR AuthorizeSecurityGroupIngress OR DescribeVpcEndpointConnectionNotifications OR DescribeFlowLogs OR SendSSHPublicKey OR DescribeSnapshotAttribute OR DescribeVolumesModifications OR DescribeRegions OR DeleteSnapshot OR SharedSnapshotVolumeCreated OR CreateSnapshot OR ReplaceIamInstanceProfileAssociation OR RunInstances OR DescribeSecurityGroups OR DescribeVpcs OR AttachVolume OR ImportKeyPair OR DescribeBundleTasks OR DescribeAccountAttributes OR DescribeVolumes OR DescribeInstanceTypes OR DescribeClientVpnRoutes OR GetLaunchTemplateData OR CreateImage OR AuthorizeSecurityGroupEgress OR SendSerialConsoleSSHPublicKey OR ModifyDBSnapshotAttribute OR ModifyDBInstance OR DeleteDBCluster OR DeleteDBInstance OR CreateDBSnapshot OR ModifyActivityStream OR SendCommand OR StartSession OR DescribeInstanceInformation OR ListEmailIdentities OR CreateEmailIdentity OR GetIdentityVerificationAttributes OR UpdateAccountSendingEnabled OR GetAccountSendingEnabled OR ListIdentities OR GetSendQuota OR VerifyEmailIdentity OR GetAccount OR DeleteIdentity OR DeleteInvitations OR GetFindings OR ListFindings OR ListDetectors OR DeleteDetector OR GetDetector OR DisassociateFromMasterAccount OR RegisterTaskDefinition OR CreateService OR CreateCluster OR CreateStage OR CreateApi OR CreateIntegration OR CreateRoute OR ListServiceQuotas OR RequestServiceQuotaIncrease) $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "response_format": "scalar"
                                }
                            ],
                            "style": {
                                "display": {
                                    "type": "stacked",
                                    "legend": "automatic"
                                }
                            }
                        },
                        "layout": {
                            "x": 0,
                            "y": 0,
                            "width": 6,
                            "height": 2
                        }
                    }
                ]
            },
            "layout": {
                "x": 6,
                "y": 0,
                "width": 6,
                "height": 5
            }
        },
        {
            "id": 2066777488,
            "definition": {
                "type": "note",
                "content": " # [TrailDiscover](https://traildiscover.cloud/)\n\nThis dashboard, built using data from traildiscover.cloud, offers a detailed visualization of AWS CloudTrail events that have been utilized or are potentially used by attackers. Events are organized according to MITRE ATT&CK tactics. Each event is presented with two widgets: one provides a description, a direct link to traildiscover.cloud, and references to related incidents and research; the other features a counter displaying the frequency of these events in your AWS environment.",
                "background_color": "white",
                "font_size": "14",
                "text_align": "left",
                "vertical_align": "top",
                "show_tick": false,
                "tick_pos": "50%",
                "tick_edge": "left",
                "has_padding": true
            },
            "layout": {
                "x": 0,
                "y": 2,
                "width": 6,
                "height": 3
            }
        },
        {
            "id": 3723537445,
            "definition": {
                "type": "group",
                "layout_type": "ordered",
                "background_color": "blue",
                "title": "TA0001 - Initial Access",
                "show_title": true,
                "widgets": [
                    {
                        "id": 4107154980,
                        "definition": {
                            "type": "note",
                            "content": "### [AssumeRoleWithWebIdentity](https://traildiscover.cloud/#STS-AssumeRoleWithWebIdentity)\n\n**Description:** Returns a set of temporary security credentials for users who have been authenticated in a mobile or web application with a web identity provider.\n\n**Related Research:**\n- [From GitHub To Account Takeover: Misconfigured Actions Place GCP & AWS Accounts At Risk](https://www.rezonate.io/blog/github-misconfigurations-put-gcp-aws-in-account-takeover-risk/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2131217046,
                        "definition": {
                            "title": "AssumeRoleWithWebIdentity",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AssumeRoleWithWebIdentity $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2484671875,
                        "definition": {
                            "type": "note",
                            "content": "### [GetSessionToken](https://traildiscover.cloud/#STS-GetSessionToken)\n\n**Description:** Returns a set of temporary credentials for an AWS account or IAM user.\n\n**Related Incidents:**\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n**Related Research:**\n- [AWS STS GetSessionToken Abuse](https://www.elastic.co/guide/en/security/7.17/aws-sts-getsessiontoken-abuse.html)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 508733941,
                        "definition": {
                            "title": "GetSessionToken",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetSessionToken $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3524868979,
                        "definition": {
                            "type": "note",
                            "content": "### [AssumeRole](https://traildiscover.cloud/#STS-AssumeRole)\n\n**Description:** Returns a set of temporary security credentials that you can use to access AWS resources.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Trouble in Paradise](https://blog.darklab.hk/2021/07/06/trouble-in-paradise/)\n- [Tales from the cloud trenches: Unwanted visitor](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-unwanted-visitor/)\n**Related Research:**\n- [Role Chain Juggling](https://hackingthe.cloud/aws/post_exploitation/role-chain-juggling/)\n- [Detecting and removing risky actions out of your IAM security policies](https://www.solvo.cloud/blog/detecting-and-removing-risky-actions-out-of-your-iam-security-policies/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1548931045,
                        "definition": {
                            "title": "AssumeRole",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AssumeRole $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1959058045,
                        "definition": {
                            "type": "note",
                            "content": "### [AssumeRoleWithSAML](https://traildiscover.cloud/#STS-AssumeRoleWithSAML)\n\n**Description:** Returns a set of temporary security credentials for users who have been authenticated via a SAML authentication response.\n\n**Related Research:**\n- [AWS - STS Privesc](https://cloud.hacktricks.xyz/pentesting-cloud/aws-security/aws-privilege-escalation/aws-sts-privesc)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2031264872,
                        "definition": {
                            "title": "AssumeRoleWithSAML",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AssumeRoleWithSAML $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4259788967,
                        "definition": {
                            "type": "note",
                            "content": "### [PasswordRecoveryRequested](https://traildiscover.cloud/#SignIn-PasswordRecoveryRequested)\n\n**Description:** This is the CloudTrail event generated when you request a password recovery.\n\n**Related Incidents:**\n- [An Ongoing AWS Phishing Campaign](https://www.cadosecurity.com/an-ongoing-aws-phishing-campaign/)\n- [Disclosure of Security Incidents on imToken](https://support.token.im/hc/en-us/articles/360005681954-Disclosure-of-Security-Incidents-on-imToken)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2283851033,
                        "definition": {
                            "title": "PasswordRecoveryRequested",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PasswordRecoveryRequested $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3400671720,
                        "definition": {
                            "type": "note",
                            "content": "### [ConsoleLogin](https://traildiscover.cloud/#SignIn-ConsoleLogin)\n\n**Description:** This is the CloudTrail event generated when you sign-in.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Responding to an attack in AWS](https://awstip.com/responding-to-an-attack-in-aws-9048a1a551ac)\n- [Credential Phishing](https://ramimac.me/aws-phishing#credential-phishing)\n- [Incident report: From CLI to console, chasing an attacker in AWS](https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/)\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n- [Not a SIMulation: CrowdStrike Investigations Reveal Intrusion Campaign Targeting Telco and BPO Companies](https://www.crowdstrike.com/blog/analysis-of-intrusion-campaign-targeting-telecom-and-bpo-companies/)\n- [Tales from the cloud trenches: Unwanted visitor](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-unwanted-visitor/)\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n**Related Research:**\n- [Compromising AWS Console credentials](https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/compromising-aws-console-credentials/)\n- [Create a Console Session from IAM Credentials](https://hackingthe.cloud/aws/post_exploitation/create_a_console_session_from_iam_credentials/)\n- [Enhancing Your Security Visibility and DetectionResponse Operations in AWS](https://pages.awscloud.com/rs/112-TZM-766/images/Visibility_detect_respond_AWS_SANS_whitepaper.pdf)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1424733786,
                        "definition": {
                            "title": "ConsoleLogin",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ConsoleLogin $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2206646550,
                        "definition": {
                            "type": "note",
                            "content": "### [GetSigninToken](https://traildiscover.cloud/#SignIn-GetSigninToken)\n\n**Description:** Generate a SigninToken that can be used to login to the the AWS Management Console.\n\n**Related Incidents:**\n- [Cloud-Conscious Tactics, Techniques,and Procedures (TTPs)](https://fwdcloudsec.org/assets/presentations/2024/europe/sebastian-walla-cloud-conscious-tactics-techniques-and-procedures-an-overview.pdf)\n- [Tales from the cloud trenches: Unwanted visitor](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-unwanted-visitor/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 230708616,
                        "definition": {
                            "title": "GetSigninToken",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetSigninToken $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    }
                ]
            },
            "layout": {
                "x": 0,
                "y": 5,
                "width": 12,
                "height": 8
            }
        },
        {
            "id": 924640913,
            "definition": {
                "type": "group",
                "layout_type": "ordered",
                "background_color": "blue",
                "title": "TA0002 - Execution",
                "show_title": true,
                "widgets": [
                    {
                        "id": 2543299299,
                        "definition": {
                            "type": "note",
                            "content": "### [SendCommand](https://traildiscover.cloud/#SSM-SendCommand)\n\n**Description:** Runs commands on one or more managed nodes.\n\n**Related Incidents:**\n- [Navigating the Cloud: Exploring Lateral Movement Techniques](https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/)\n- [Cloud-Conscious Tactics, Techniques,and Procedures (TTPs)](https://fwdcloudsec.org/assets/presentations/2024/europe/sebastian-walla-cloud-conscious-tactics-techniques-and-procedures-an-overview.pdf)\n**Related Research:**\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [Run Shell Commands on EC2 with Send Command or Session Manager](https://hackingthe.cloud/aws/post_exploitation/run_shell_commands_on_ec2/)\n- [Attack Paths Into VMs in the Cloud](https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2615506126,
                        "definition": {
                            "title": "SendCommand",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:SendCommand $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 914612931,
                        "definition": {
                            "type": "note",
                            "content": "### [StartSession](https://traildiscover.cloud/#SSM-StartSession)\n\n**Description:** Initiates a connection to a target (for example, a managed node) for a Session Manager session.\n\n**Related Incidents:**\n- [Navigating the Cloud: Exploring Lateral Movement Techniques](https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/)\n**Related Research:**\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [Run Shell Commands on EC2 with Send Command or Session Manager](https://hackingthe.cloud/aws/post_exploitation/run_shell_commands_on_ec2/)\n- [Attack Paths Into VMs in the Cloud](https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3233642293,
                        "definition": {
                            "title": "StartSession",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:StartSession $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2972986675,
                        "definition": {
                            "type": "note",
                            "content": "### [ResumeSession](https://traildiscover.cloud/#SSM-ResumeSession)\n\n**Description:** Reconnects a session to a managed node after it has been disconnected.\n\n**Related Research:**\n- [Attack Paths Into VMs in the Cloud](https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 997048741,
                        "definition": {
                            "title": "ResumeSession",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ResumeSession $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    }
                ]
            },
            "layout": {
                "x": 0,
                "y": 13,
                "width": 12,
                "height": 4
            }
        },
        {
            "id": 172523488,
            "definition": {
                "type": "group",
                "layout_type": "ordered",
                "background_color": "blue",
                "title": "TA0003 - Persistence",
                "show_title": true,
                "widgets": [
                    {
                        "id": 4168904613,
                        "definition": {
                            "type": "note",
                            "content": "### [AddMemberToGroup](https://traildiscover.cloud/#SSO-AddMemberToGroup)\n\n**Description:** Adds a member to a group within the specified identity store.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2093627792,
                        "definition": {
                            "title": "AddMemberToGroup",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AddMemberToGroup $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2631035920,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateGroup](https://traildiscover.cloud/#SSO-CreateGroup)\n\n**Description:** Creates a group within the specified identity store.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 655097986,
                        "definition": {
                            "title": "CreateGroup",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateGroup $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 477789574,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateSsoConfiguration](https://traildiscover.cloud/#SSO-UpdateSsoConfiguration)\n\n**Description:** Updates the SSO configuration for the specified instance.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2796818936,
                        "definition": {
                            "title": "UpdateSsoConfiguration",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateSsoConfiguration $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 431559309,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateAccountAssignment](https://traildiscover.cloud/#SSO-CreateAccountAssignment)\n\n**Description:** Assigns access to a principal for a specified AWS account using a specified permission set.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2750588671,
                        "definition": {
                            "title": "CreateAccountAssignment",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateAccountAssignment $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3715378098,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateUser](https://traildiscover.cloud/#SSO-CreateUser)\n\n**Description:** Creates a user within the specified identity store.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1739440164,
                        "definition": {
                            "title": "CreateUser",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateUser $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2849957236,
                        "definition": {
                            "type": "note",
                            "content": "### [GetFederationToken](https://traildiscover.cloud/#STS-GetFederationToken)\n\n**Description:** Returns a set of temporary security credentials (consisting of an access key ID, a secret access key, and a security token) for a user.\n\n**Related Incidents:**\n- [How Adversaries Can Persist with AWS User Federation](https://www.crowdstrike.com/blog/how-adversaries-persist-with-aws-user-federation/)\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n- [Cloud-Conscious Tactics, Techniques,and Procedures (TTPs)](https://fwdcloudsec.org/assets/presentations/2024/europe/sebastian-walla-cloud-conscious-tactics-techniques-and-procedures-an-overview.pdf)\n- [Tales from the cloud trenches: Unwanted visitor](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-unwanted-visitor/)\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n**Related Research:**\n- [Create a Console Session from IAM Credentials](https://hackingthe.cloud/aws/post_exploitation/create_a_console_session_from_iam_credentials/)\n- [Survive Access Key Deletion with sts:GetFederationToken](https://hackingthe.cloud/aws/post_exploitation/survive_access_key_deletion_with_sts_getfederationtoken/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 874019302,
                        "definition": {
                            "title": "GetFederationToken",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetFederationToken $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1204184010,
                        "definition": {
                            "type": "note",
                            "content": "### [AssumeRole](https://traildiscover.cloud/#STS-AssumeRole)\n\n**Description:** Returns a set of temporary security credentials that you can use to access AWS resources.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Trouble in Paradise](https://blog.darklab.hk/2021/07/06/trouble-in-paradise/)\n- [Tales from the cloud trenches: Unwanted visitor](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-unwanted-visitor/)\n**Related Research:**\n- [Role Chain Juggling](https://hackingthe.cloud/aws/post_exploitation/role-chain-juggling/)\n- [Detecting and removing risky actions out of your IAM security policies](https://www.solvo.cloud/blog/detecting-and-removing-risky-actions-out-of-your-iam-security-policies/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3523213372,
                        "definition": {
                            "title": "AssumeRole",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AssumeRole $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 533309251,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateFunction20150331](https://traildiscover.cloud/#Lambda-CreateFunction20150331)\n\n**Description:** Creates a Lambda function.\n\n**Related Incidents:**\n- [Mining Crypto](https://twitter.com/jonnyplatt/status/1471453527390277638)\n- [Cloud Security Stories: From Risky Permissions to Ransomware Execution](https://sonraisecurity.com/blog/cloud-security-stories-from-risky-permissions-to-ransomware-execution/)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n**Related Research:**\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2852338613,
                        "definition": {
                            "title": "CreateFunction20150331",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateFunction20150331 $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4244562579,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateFunctionConfiguration20150331v2](https://traildiscover.cloud/#Lambda-UpdateFunctionConfiguration20150331v2)\n\n**Description:** Modify the version-specific settings of a Lambda function.\n\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n- [Enhancing Your Security Visibility and DetectionResponse Operations in AWS](https://pages.awscloud.com/rs/112-TZM-766/images/Visibility_detect_respond_AWS_SANS_whitepaper.pdf)\n- [LambdaSpy - Implanting the Lambda execution environment (Part two)](https://www.clearvector.com/blog/lambda-spy/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 121140997,
                        "definition": {
                            "title": "UpdateFunctionConfiguration20150331v2",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateFunctionConfiguration20150331v2 $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2348252789,
                        "definition": {
                            "type": "note",
                            "content": "### [AddPermission20150331v2](https://traildiscover.cloud/#Lambda-AddPermission20150331v2)\n\n**Description:** Grants an AWS service, AWS account, or AWS organization permission to use a function.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 372314855,
                        "definition": {
                            "title": "AddPermission20150331v2",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AddPermission20150331v2 $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3012778312,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateFunctionCode20150331v2](https://traildiscover.cloud/#Lambda-UpdateFunctionCode20150331v2)\n\n**Description:** Updates a Lambda function's code. If code signing is enabled for the function, the code package must be signed by a trusted publisher.\n\n**Related Research:**\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n- [Enhancing Your Security Visibility and DetectionResponse Operations in AWS](https://pages.awscloud.com/rs/112-TZM-766/images/Visibility_detect_respond_AWS_SANS_whitepaper.pdf)\n- [How Attackers Can Misuse AWS CloudFront Access to Make It \u2018Rain\u2019 Cookies](https://medium.com/@adan.alvarez/how-attackers-can-misuse-aws-cloudfront-access-to-make-it-rain-cookies-acf9ce87541c)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1036840378,
                        "definition": {
                            "title": "UpdateFunctionCode20150331v2",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateFunctionCode20150331v2 $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2909771303,
                        "definition": {
                            "type": "note",
                            "content": "### [PutTargets](https://traildiscover.cloud/#events-PutTargets)\n\n**Description:** Adds the specified targets to the specified rule, or updates the targets if they are already associated with the rule.\n\n**Related Incidents:**\n- [Cloud Security Stories: From Risky Permissions to Ransomware Execution](https://sonraisecurity.com/blog/cloud-security-stories-from-risky-permissions-to-ransomware-execution/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 933833369,
                        "definition": {
                            "title": "PutTargets",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutTargets $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1863361435,
                        "definition": {
                            "type": "note",
                            "content": "### [PutRule](https://traildiscover.cloud/#events-PutRule)\n\n**Description:** Creates or updates the specified rule.\n\n**Related Incidents:**\n- [Cloud Security Stories: From Risky Permissions to Ransomware Execution](https://sonraisecurity.com/blog/cloud-security-stories-from-risky-permissions-to-ransomware-execution/)\n**Related Research:**\n- [Modify GuardDuty Configuration](https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2034907149,
                        "definition": {
                            "title": "PutRule",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutRule $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2906545517,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateSAMLProvider](https://traildiscover.cloud/#IAM-CreateSAMLProvider)\n\n**Description:** Creates an IAM resource that describes an identity provider (IdP) that supports SAML 2.0.\n\n**Related Incidents:**\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3078091231,
                        "definition": {
                            "title": "CreateSAMLProvider",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateSAMLProvider $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1015499293,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateLoginProfile](https://traildiscover.cloud/#IAM-UpdateLoginProfile)\n\n**Description:** Changes the password for the specified IAM user. You can use the AWS CLI, the AWS API, or the Users page in the IAM console to change the password for any IAM user.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Incident report: From CLI to console, chasing an attacker in AWS](https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/)\n- [LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD](https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud)\n**Related Research:**\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1087706120,
                        "definition": {
                            "title": "UpdateLoginProfile",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateLoginProfile $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4161245285,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateAccessKey](https://traildiscover.cloud/#IAM-UpdateAccessKey)\n\n**Description:** Changes the status of the specified access key from Active to Inactive, or vice versa.\n\n**Related Research:**\n- [AWS - IAM Privesc](https://cloud.hacktricks.xyz/pentesting-cloud/aws-security/aws-privilege-escalation/aws-iam-privesc)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2185307351,
                        "definition": {
                            "title": "UpdateAccessKey",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateAccessKey $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1766754766,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateAssumeRolePolicy](https://traildiscover.cloud/#IAM-UpdateAssumeRolePolicy)\n\n**Description:** Updates the policy that grants an IAM entity permission to assume a role.\n\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n- [AWS IAM Persistence Methods](https://hackingthe.cloud/aws/post_exploitation/iam_persistence/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4085784128,
                        "definition": {
                            "title": "UpdateAssumeRolePolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateAssumeRolePolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2076388823,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateAccessKey](https://traildiscover.cloud/#IAM-CreateAccessKey)\n\n**Description:** Creates a new AWS secret access key and corresponding AWS access key ID for the specified user. The default status for new keys is Active.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Incident report: From CLI to console, chasing an attacker in AWS](https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/)\n- [SCARLETEEL 2.0: Fargate, Kubernetes, and Crypto](https://sysdig.com/blog/scarleteel-2-0/)\n- [ANATOMY OF AN ATTACK: EXPOSED KEYS TO CRYPTO MINING](https://permiso.io/blog/s/anatomy-of-attack-exposed-keys-to-crypto-mining/)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n- [BrowserStack analysis: unpatched inactive machine compromised by shellshock vulnerability](https://www.databreaches.net/browserstack-analysis-unpatched-inactive-machine-compromised-by-shellshock-vulnerability/)\n- [LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD](https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud)\n- [New Developments in LLM Hijacking Activity](https://www.wiz.io/blog/jinx-2401-llm-hijacking-aws)\n**Related Research:**\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n- [AWS IAM Persistence Methods](https://hackingthe.cloud/aws/post_exploitation/iam_persistence/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 100450889,
                        "definition": {
                            "title": "CreateAccessKey",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateAccessKey $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1533445718,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateSAMLProvider](https://traildiscover.cloud/#IAM-UpdateSAMLProvider)\n\n**Description:** Updates the metadata document for an existing SAML provider resource object.\n\n**Related Research:**\n- [Gaining AWS Persistence by Updating a SAML Identity Provider](https://medium.com/@adan.alvarez/gaining-aws-persistence-by-updating-a-saml-identity-provider-ef57ebdc8db5)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1704991432,
                        "definition": {
                            "title": "UpdateSAMLProvider",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateSAMLProvider $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3312994180,
                        "definition": {
                            "type": "note",
                            "content": "### [StartSSO](https://traildiscover.cloud/#SSO-StartSSO)\n\n**Description:** Initialize AWS IAM Identity Center\n\n**Related Incidents:**\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1337056246,
                        "definition": {
                            "title": "StartSSO",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:StartSSO $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3407251782,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateOpenIDConnectProvider](https://traildiscover.cloud/#IAM-CreateOpenIDConnectProvider)\n\n**Description:** Creates an IAM entity to describe an identity provider (IdP) that supports OpenID Connect (OIDC)\n\n**Related Incidents:**\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1431313848,
                        "definition": {
                            "title": "CreateOpenIDConnectProvider",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateOpenIDConnectProvider $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2550053548,
                        "definition": {
                            "type": "note",
                            "content": "### [AttachUserPolicy](https://traildiscover.cloud/#IAM-AttachUserPolicy)\n\n**Description:** Attaches the specified managed policy to the specified user.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Incident report: From CLI to console, chasing an attacker in AWS](https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/)\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [Detecting AI resource-hijacking with Composite Alerts](https://www.lacework.com/blog/detecting-ai-resource-hijacking-with-composite-alerts)\n- [Tales from the cloud trenches: Unwanted visitor](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-unwanted-visitor/)\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 574115614,
                        "definition": {
                            "title": "AttachUserPolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AttachUserPolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2846976572,
                        "definition": {
                            "type": "note",
                            "content": "### [PutUserPolicy](https://traildiscover.cloud/#IAM-PutUserPolicy)\n\n**Description:** Adds or updates an inline policy document that is embedded in the specified IAM user.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [ANATOMY OF AN ATTACK: EXPOSED KEYS TO CRYPTO MINING](https://permiso.io/blog/s/anatomy-of-attack-exposed-keys-to-crypto-mining/)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2919183399,
                        "definition": {
                            "title": "PutUserPolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutUserPolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2105041443,
                        "definition": {
                            "type": "note",
                            "content": "### [ChangePassword](https://traildiscover.cloud/#IAM-ChangePassword)\n\n**Description:** Changes the password of the IAM user who is calling this operation.\n\n**Related Research:**\n- [AWS CloudTrail cheat sheet](https://www.invictus-ir.com/news/aws-cloudtrail-cheat-sheet)\n- [IAM User Changes Alarm](https://asecure.cloud/a/cwalarm_iam_user_changes/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 129103509,
                        "definition": {
                            "title": "ChangePassword",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ChangePassword $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1086813357,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateLoginProfile](https://traildiscover.cloud/#IAM-CreateLoginProfile)\n\n**Description:** Creates a password for the specified IAM user. A password allows an IAM user to access AWS services through the AWS Management Console.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Incident report: From CLI to console, chasing an attacker in AWS](https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/)\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n- [LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD](https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud)\n- [Detecting AI resource-hijacking with Composite Alerts](https://www.lacework.com/blog/detecting-ai-resource-hijacking-with-composite-alerts)\n- [Tales from the cloud trenches: Unwanted visitor](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-unwanted-visitor/)\n- [New Developments in LLM Hijacking Activity](https://www.wiz.io/blog/jinx-2401-llm-hijacking-aws)\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n**Related Research:**\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n- [AWS IAM Persistence Methods](https://hackingthe.cloud/aws/post_exploitation/iam_persistence/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3405842719,
                        "definition": {
                            "title": "CreateLoginProfile",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateLoginProfile $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3715378098,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateUser](https://traildiscover.cloud/#IAM-CreateUser)\n\n**Description:** Creates a new IAM user for your AWS account.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Ransomware in the cloud](https://www.invictus-ir.com/news/ransomware-in-the-cloud)\n- [Responding to an attack in AWS](https://awstip.com/responding-to-an-attack-in-aws-9048a1a551ac)\n- [Incident report: From CLI to console, chasing an attacker in AWS](https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/)\n- [ANATOMY OF AN ATTACK: EXPOSED KEYS TO CRYPTO MINING](https://permiso.io/blog/s/anatomy-of-attack-exposed-keys-to-crypto-mining/)\n- [Trouble in Paradise](https://blog.darklab.hk/2021/07/06/trouble-in-paradise/)\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [Exposed long-lived access key resulted in unauthorized access](https://twitter.com/jhencinski/status/1578371249792724992?t=6oYeGYgGZq1B-LXFZzIqhQ)\n- [SCARLETEEL 2.0: Fargate, Kubernetes, and Crypto](https://sysdig.com/blog/scarleteel-2-0/)\n- [Insider Threat Risks to Flat Environments](https://www.mandiant.com/sites/default/files/2021-09/rpt-mtrends-2021-3.pdf)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n- [Sendtech Pte. Ltd](https://www.pdpc.gov.sg/-/media/Files/PDPC/PDF-Files/Commissions-Decisions/Decision---Sendtech-Pte-Ltd---220721.ashx?la=en)\n- [BrowserStack analysis: unpatched inactive machine compromised by shellshock vulnerability](https://www.databreaches.net/browserstack-analysis-unpatched-inactive-machine-compromised-by-shellshock-vulnerability/)\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n- [LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD](https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud)\n- [Detecting AI resource-hijacking with Composite Alerts](https://www.lacework.com/blog/detecting-ai-resource-hijacking-with-composite-alerts)\n- [Tales from the cloud trenches: Unwanted visitor](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-unwanted-visitor/)\n- [New Developments in LLM Hijacking Activity](https://www.wiz.io/blog/jinx-2401-llm-hijacking-aws)\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n**Related Research:**\n- [Creating a new IAM user](https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/creating-new-iam-user/)\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [Following attackers\u2019 (Cloud)trail in AWS: Methodology and findings in the wild](https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1739440164,
                        "definition": {
                            "title": "CreateUser",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateUser $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3416367614,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateRole](https://traildiscover.cloud/#IAM-CreateRole)\n\n**Description:** Creates a new role for your AWS account.\n\n**Related Incidents:**\n- [Attack Scenario 2: From Misconfigured Firewall to Cryptojacking Botnet](https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/reports/unit42-cloud-threat-report-volume7.pdf)\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Tales from the cloud trenches: Unwanted visitor](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-unwanted-visitor/)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1440429680,
                        "definition": {
                            "title": "CreateRole",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateRole $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3793251002,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateGraphqlApi](https://traildiscover.cloud/#AppSync-UpdateGraphqlApi)\n\n**Description:** Updates a GraphqlApi object.\n\n**Related Research:**\n- [Distorting the Sync: How AWS AppSync Can Be Turned into an Attacker\u2019s Backdoor](https://medium.com/@adan.alvarez/distorting-the-sync-how-aws-appsync-can-be-turned-into-an-attackers-backdoor-8c015b8e52b8)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1817313068,
                        "definition": {
                            "title": "UpdateGraphqlApi",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateGraphqlApi $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4214420866,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateApiKey](https://traildiscover.cloud/#AppSync-CreateApiKey)\n\n**Description:** Creates a unique key that you can distribute to clients who invoke your API.\n\n**Related Research:**\n- [Distorting the Sync: How AWS AppSync Can Be Turned into an Attacker\u2019s Backdoor](https://medium.com/@adan.alvarez/distorting-the-sync-how-aws-appsync-can-be-turned-into-an-attackers-backdoor-8c015b8e52b8)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2238482932,
                        "definition": {
                            "title": "CreateApiKey",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateApiKey $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1686556085,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateResolver](https://traildiscover.cloud/#AppSync-UpdateResolver)\n\n**Description:** Updates a Resolver object.\n\n**Related Research:**\n- [Distorting the Sync: How AWS AppSync Can Be Turned into an Attacker\u2019s Backdoor](https://medium.com/@adan.alvarez/distorting-the-sync-how-aws-appsync-can-be-turned-into-an-attackers-backdoor-8c015b8e52b8)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3906246560,
                        "definition": {
                            "title": "UpdateResolver",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateResolver $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1967145146,
                        "definition": {
                            "type": "note",
                            "content": "### [StartInstances](https://traildiscover.cloud/#EC2-StartInstances)\n\n**Description:** Starts an Amazon EBS-backed instance that you've previously stopped.\n\n**Related Incidents:**\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n**Related Research:**\n- [Executing commands through EC2 user data](https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/executing-commands-through-user-data/)\n- [Attack Paths Into VMs in the Cloud](https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2039351973,
                        "definition": {
                            "title": "StartInstances",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:StartInstances $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 889172307,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateSecurityGroup](https://traildiscover.cloud/#EC2-CreateSecurityGroup)\n\n**Description:** Creates a security group.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [Behind the scenes in the Expel SOC: Alert-to-fix in AWS](https://expel.com/blog/behind-the-scenes-expel-soc-alert-aws/)\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n- [ANATOMY OF AN ATTACK: EXPOSED KEYS TO CRYPTO MINING](https://permiso.io/blog/s/anatomy-of-attack-exposed-keys-to-crypto-mining/)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n**Related Research:**\n- [Following attackers\u2019 (Cloud)trail in AWS: Methodology and findings in the wild](https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/)\n- [Abusing VPC Traffic Mirroring in AWS](https://rhinosecuritylabs.com/aws/abusing-vpc-traffic-mirroring-in-aws/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3208201669,
                        "definition": {
                            "title": "CreateSecurityGroup",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateSecurityGroup $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 388692727,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateDefaultVpc](https://traildiscover.cloud/#EC2-CreateDefaultVpc)\n\n**Description:** Creates a default VPC with a size /16 IPv4 CIDR block and a default subnet in each Availability Zone.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 460899554,
                        "definition": {
                            "title": "CreateDefaultVpc",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateDefaultVpc $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3699198067,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateNetworkAclEntry](https://traildiscover.cloud/#EC2-CreateNetworkAclEntry)\n\n**Description:** Creates an entry (a rule) in a network ACL with the specified rule number.\n\n**Related Research:**\n- [AWS EC2 Network Access Control List Creation](https://www.elastic.co/guide/en/security/current/aws-ec2-network-access-control-list-creation.html)\n- [Enhancing Your Security Visibility and DetectionResponse Operations in AWS](https://pages.awscloud.com/rs/112-TZM-766/images/Visibility_detect_respond_AWS_SANS_whitepaper.pdf)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1723260133,
                        "definition": {
                            "title": "CreateNetworkAclEntry",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateNetworkAclEntry $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1207507220,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateKeyPair](https://traildiscover.cloud/#EC2-CreateKeyPair)\n\n**Description:** Creates an ED25519 or 2048-bit RSA key pair with the specified name and in the specified PEM or PPK format.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [ANATOMY OF AN ATTACK: EXPOSED KEYS TO CRYPTO MINING](https://permiso.io/blog/s/anatomy-of-attack-exposed-keys-to-crypto-mining/)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n**Related Research:**\n- [Following attackers\u2019 (Cloud)trail in AWS: Methodology and findings in the wild](https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1379052934,
                        "definition": {
                            "title": "CreateKeyPair",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateKeyPair $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4120370506,
                        "definition": {
                            "type": "note",
                            "content": "### [AuthorizeSecurityGroupIngress](https://traildiscover.cloud/#EC2-AuthorizeSecurityGroupIngress)\n\n**Description:** Adds the specified inbound (ingress) rules to a security group.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Finding evil in AWS](https://expel.com/blog/finding-evil-in-aws/)\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [Behind the scenes in the Expel SOC: Alert-to-fix in AWS](https://expel.com/blog/behind-the-scenes-expel-soc-alert-aws/)\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n- [BrowserStack analysis: unpatched inactive machine compromised by shellshock vulnerability](https://www.databreaches.net/browserstack-analysis-unpatched-inactive-machine-compromised-by-shellshock-vulnerability/)\n- [Navigating the Cloud: Exploring Lateral Movement Techniques](https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/)\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n**Related Research:**\n- [Opening a security group to the Internet](https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/opening-security-group-port/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2144432572,
                        "definition": {
                            "title": "AuthorizeSecurityGroupIngress",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AuthorizeSecurityGroupIngress $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2534402012,
                        "definition": {
                            "type": "note",
                            "content": "### [RunInstances](https://traildiscover.cloud/#EC2-RunInstances)\n\n**Description:** Launches the specified number of instances using an AMI for which you have permissions.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [DXC spills AWS private keys on public GitHub](https://www.theregister.com/2017/11/14/dxc_github_aws_keys_leaked/)\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [Behind the scenes in the Expel SOC: Alert-to-fix in AWS](https://expel.com/blog/behind-the-scenes-expel-soc-alert-aws/)\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n- [SCARLETEEL 2.0: Fargate, Kubernetes, and Crypto](https://sysdig.com/blog/scarleteel-2-0/)\n- [ANATOMY OF AN ATTACK: EXPOSED KEYS TO CRYPTO MINING](https://permiso.io/blog/s/anatomy-of-attack-exposed-keys-to-crypto-mining/)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n- [Clear and Uncommon Story About Overcoming Issues With AWS](https://urancompany.com/blog/clear-and-uncommon-story-about-overcoming-issues-aws)\n- [onelogin 2017 Security Incident](https://web.archive.org/web/20210620180614/https://www.onelogin.com/blog/may-31-2017-security-incident)\n- [BrowserStack analysis: unpatched inactive machine compromised by shellshock vulnerability](https://www.databreaches.net/browserstack-analysis-unpatched-inactive-machine-compromised-by-shellshock-vulnerability/)\n- [Navigating the Cloud: Exploring Lateral Movement Techniques](https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/)\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n**Related Research:**\n- [Launching EC2 instances](https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/launching-ec2-instances/)\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n- [Abusing VPC Traffic Mirroring in AWS](https://rhinosecuritylabs.com/aws/abusing-vpc-traffic-mirroring-in-aws/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 558464078,
                        "definition": {
                            "title": "RunInstances",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:RunInstances $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1787816483,
                        "definition": {
                            "type": "note",
                            "content": "### [ImportKeyPair](https://traildiscover.cloud/#EC2-ImportKeyPair)\n\n**Description:** Imports the public key from an RSA or ED25519 key pair that you created with a third-party tool.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [Behind the scenes in the Expel SOC: Alert-to-fix in AWS](https://expel.com/blog/behind-the-scenes-expel-soc-alert-aws/)\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n**Related Research:**\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4106845845,
                        "definition": {
                            "title": "ImportKeyPair",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ImportKeyPair $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4198991891,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateStage](https://traildiscover.cloud/#APIGateway-CreateStage)\n\n**Description:** Creates a Stage for an API. A Stage is a named reference to a deployment of an API.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4271198718,
                        "definition": {
                            "title": "CreateStage",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateStage $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2538128877,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateApi](https://traildiscover.cloud/#APIGateway-CreateApi)\n\n**Description:** Creates an Api resource.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2610335704,
                        "definition": {
                            "title": "CreateApi",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateApi $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2933519449,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateIntegration](https://traildiscover.cloud/#APIGateway-CreateIntegration)\n\n**Description:** Creates an Integration. An Integration is a configuration that specifies the backend endpoint for an API route.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3005726276,
                        "definition": {
                            "title": "CreateIntegration",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateIntegration $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 580542737,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateRoute](https://traildiscover.cloud/#APIGateway-CreateRoute)\n\n**Description:** Creates a Route for an API. A Route is a configuration that specifies how API requests are routed to backend integrations.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 652749564,
                        "definition": {
                            "title": "CreateRoute",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateRoute $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    }
                ]
            },
            "layout": {
                "x": 0,
                "y": 17,
                "width": 12,
                "height": 30
            }
        },
        {
            "id": 3137596055,
            "definition": {
                "type": "group",
                "layout_type": "ordered",
                "background_color": "blue",
                "title": "TA0004 - Privilege Escalation",
                "show_title": true,
                "widgets": [
                    {
                        "id": 1191056860,
                        "definition": {
                            "type": "note",
                            "content": "### [AssumeRole](https://traildiscover.cloud/#STS-AssumeRole)\n\n**Description:** Returns a set of temporary security credentials that you can use to access AWS resources.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Trouble in Paradise](https://blog.darklab.hk/2021/07/06/trouble-in-paradise/)\n- [Tales from the cloud trenches: Unwanted visitor](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-unwanted-visitor/)\n**Related Research:**\n- [Role Chain Juggling](https://hackingthe.cloud/aws/post_exploitation/role-chain-juggling/)\n- [Detecting and removing risky actions out of your IAM security policies](https://www.solvo.cloud/blog/detecting-and-removing-risky-actions-out-of-your-iam-security-policies/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3510086222,
                        "definition": {
                            "title": "AssumeRole",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AssumeRole $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2394689644,
                        "definition": {
                            "type": "note",
                            "content": "### [GetCredentialsForIdentity](https://traildiscover.cloud/#CognitoIdentity-GetCredentialsForIdentity)\n\n**Description:** Returns credentials for the provided identity ID. Any provided logins will be validated against supported login providers.\n\n**Related Research:**\n- [Overpermissioned AWS Cognito Identity Pools](https://hackingthe.cloud/aws/exploitation/cognito_identity_pool_excessive_privileges/#exploitation)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2466896471,
                        "definition": {
                            "title": "GetCredentialsForIdentity",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetCredentialsForIdentity $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2972392854,
                        "definition": {
                            "type": "note",
                            "content": "### [GetId](https://traildiscover.cloud/#CognitoIdentity-GetId)\n\n**Description:** Generates (or retrieves) IdentityID. Supplying multiple logins will create an implicit linked account.\n\n**Related Research:**\n- [Overpermissioned AWS Cognito Identity Pools](https://hackingthe.cloud/aws/exploitation/cognito_identity_pool_excessive_privileges/#exploitation)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3143938568,
                        "definition": {
                            "title": "GetId",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetId $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1814726886,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateFunction20150331](https://traildiscover.cloud/#Lambda-CreateFunction20150331)\n\n**Description:** Creates a Lambda function.\n\n**Related Incidents:**\n- [Mining Crypto](https://twitter.com/jonnyplatt/status/1471453527390277638)\n- [Cloud Security Stories: From Risky Permissions to Ransomware Execution](https://sonraisecurity.com/blog/cloud-security-stories-from-risky-permissions-to-ransomware-execution/)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n**Related Research:**\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1886933713,
                        "definition": {
                            "title": "CreateFunction20150331",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateFunction20150331 $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1595428047,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateEventSourceMapping20150331](https://traildiscover.cloud/#Lambda-CreateEventSourceMapping20150331)\n\n**Description:** Creates a mapping between an event source and an AWS Lambda function.\n\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1667634874,
                        "definition": {
                            "title": "CreateEventSourceMapping20150331",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateEventSourceMapping20150331 $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3629670424,
                        "definition": {
                            "type": "note",
                            "content": "### [AddPermission20150331v2](https://traildiscover.cloud/#Lambda-AddPermission20150331v2)\n\n**Description:** Grants an AWS service, AWS account, or AWS organization permission to use a function.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3701877251,
                        "definition": {
                            "title": "AddPermission20150331v2",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AddPermission20150331v2 $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1507725805,
                        "definition": {
                            "type": "note",
                            "content": "### [Invoke](https://traildiscover.cloud/#Lambda-Invoke)\n\n**Description:** Invokes a Lambda function.\n\n**Related Incidents:**\n- [Mining Crypto](https://twitter.com/jonnyplatt/status/1471453527390277638)\n- [Cloud Security Stories: From Risky Permissions to Ransomware Execution](https://sonraisecurity.com/blog/cloud-security-stories-from-risky-permissions-to-ransomware-execution/)\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3826755167,
                        "definition": {
                            "title": "Invoke",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:Invoke $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 363419375,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateEventSourceMapping20150331](https://traildiscover.cloud/#Lambda-UpdateEventSourceMapping20150331)\n\n**Description:** Updates an event source mapping. You can change the function that AWS Lambda invokes, or pause invocation and resume later from the same location.\n\n**Related Research:**\n- [Enhancing Your Security Visibility and DetectionResponse Operations in AWS](https://pages.awscloud.com/rs/112-TZM-766/images/Visibility_detect_respond_AWS_SANS_whitepaper.pdf)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 435626202,
                        "definition": {
                            "title": "UpdateEventSourceMapping20150331",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateEventSourceMapping20150331 $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2768658227,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteRolePolicy](https://traildiscover.cloud/#IAM-DeleteRolePolicy)\n\n**Description:** Deletes the specified inline policy that is embedded in the specified IAM role.\n\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 792720293,
                        "definition": {
                            "title": "DeleteRolePolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteRolePolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3209233920,
                        "definition": {
                            "type": "note",
                            "content": "### [DetachRolePolicy](https://traildiscover.cloud/#IAM-DetachRolePolicy)\n\n**Description:** Removes the specified managed policy from the specified role.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3281440747,
                        "definition": {
                            "title": "DetachRolePolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DetachRolePolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 50094393,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateLoginProfile](https://traildiscover.cloud/#IAM-UpdateLoginProfile)\n\n**Description:** Changes the password for the specified IAM user. You can use the AWS CLI, the AWS API, or the Users page in the IAM console to change the password for any IAM user.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Incident report: From CLI to console, chasing an attacker in AWS](https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/)\n- [LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD](https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud)\n**Related Research:**\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2369123755,
                        "definition": {
                            "title": "UpdateLoginProfile",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateLoginProfile $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2655542613,
                        "definition": {
                            "type": "note",
                            "content": "### [CreatePolicy](https://traildiscover.cloud/#IAM-CreatePolicy)\n\n**Description:** Creates a new managed policy for your AWS account.\n\n**Related Incidents:**\n- [New Developments in LLM Hijacking Activity](https://www.wiz.io/blog/jinx-2401-llm-hijacking-aws)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 679604679,
                        "definition": {
                            "title": "CreatePolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreatePolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3300181493,
                        "definition": {
                            "type": "note",
                            "content": "### [AddUserToGroup](https://traildiscover.cloud/#IAM-AddUserToGroup)\n\n**Description:** Adds the specified user to the specified group.\n\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1324243559,
                        "definition": {
                            "title": "AddUserToGroup",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AddUserToGroup $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3048172401,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateAssumeRolePolicy](https://traildiscover.cloud/#IAM-UpdateAssumeRolePolicy)\n\n**Description:** Updates the policy that grants an IAM entity permission to assume a role.\n\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n- [AWS IAM Persistence Methods](https://hackingthe.cloud/aws/post_exploitation/iam_persistence/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3219718115,
                        "definition": {
                            "title": "UpdateAssumeRolePolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateAssumeRolePolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3357806458,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateAccessKey](https://traildiscover.cloud/#IAM-CreateAccessKey)\n\n**Description:** Creates a new AWS secret access key and corresponding AWS access key ID for the specified user. The default status for new keys is Active.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Incident report: From CLI to console, chasing an attacker in AWS](https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/)\n- [SCARLETEEL 2.0: Fargate, Kubernetes, and Crypto](https://sysdig.com/blog/scarleteel-2-0/)\n- [ANATOMY OF AN ATTACK: EXPOSED KEYS TO CRYPTO MINING](https://permiso.io/blog/s/anatomy-of-attack-exposed-keys-to-crypto-mining/)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n- [BrowserStack analysis: unpatched inactive machine compromised by shellshock vulnerability](https://www.databreaches.net/browserstack-analysis-unpatched-inactive-machine-compromised-by-shellshock-vulnerability/)\n- [LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD](https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud)\n- [New Developments in LLM Hijacking Activity](https://www.wiz.io/blog/jinx-2401-llm-hijacking-aws)\n**Related Research:**\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n- [AWS IAM Persistence Methods](https://hackingthe.cloud/aws/post_exploitation/iam_persistence/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3430013285,
                        "definition": {
                            "title": "CreateAccessKey",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateAccessKey $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1126223141,
                        "definition": {
                            "type": "note",
                            "content": "### [CreatePolicyVersion](https://traildiscover.cloud/#IAM-CreatePolicyVersion)\n\n**Description:** Creates a new version of the specified managed policy.\n\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1198429968,
                        "definition": {
                            "title": "CreatePolicyVersion",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreatePolicyVersion $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3782787821,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteUserPolicy](https://traildiscover.cloud/#IAM-DeleteUserPolicy)\n\n**Description:** Deletes the specified inline policy that is embedded in the specified IAM user.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1806849887,
                        "definition": {
                            "title": "DeleteUserPolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteUserPolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 667379705,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateSAMLProvider](https://traildiscover.cloud/#IAM-UpdateSAMLProvider)\n\n**Description:** Updates the metadata document for an existing SAML provider resource object.\n\n**Related Research:**\n- [Gaining AWS Persistence by Updating a SAML Identity Provider](https://medium.com/@adan.alvarez/gaining-aws-persistence-by-updating-a-saml-identity-provider-ef57ebdc8db5)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2986409067,
                        "definition": {
                            "title": "UpdateSAMLProvider",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateSAMLProvider $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1707787077,
                        "definition": {
                            "type": "note",
                            "content": "### [PutRolePermissionsBoundary](https://traildiscover.cloud/#IAM-PutRolePermissionsBoundary)\n\n**Description:** Adds or updates the policy that is specified as the IAM role's permissions boundary.\n\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3927477552,
                        "definition": {
                            "title": "PutRolePermissionsBoundary",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutRolePermissionsBoundary $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2075107756,
                        "definition": {
                            "type": "note",
                            "content": "### [PutUserPermissionsBoundary](https://traildiscover.cloud/#IAM-PutUserPermissionsBoundary)\n\n**Description:** Adds or updates the policy that is specified as the IAM user's permissions boundary.\n\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 99169822,
                        "definition": {
                            "title": "PutUserPermissionsBoundary",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutUserPermissionsBoundary $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 399068029,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteUserPermissionsBoundary](https://traildiscover.cloud/#IAM-DeleteUserPermissionsBoundary)\n\n**Description:** Deletes the permissions boundary for the specified IAM user.\n\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 471274856,
                        "definition": {
                            "title": "DeleteUserPermissionsBoundary",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteUserPermissionsBoundary $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3119164696,
                        "definition": {
                            "type": "note",
                            "content": "### [AttachRolePolicy](https://traildiscover.cloud/#IAM-AttachRolePolicy)\n\n**Description:** Attaches the specified managed policy to the specified IAM role. When you attach a managed policy to a role, the managed policy becomes part of the role's permission (access) policy.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Tales from the cloud trenches: Unwanted visitor](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-unwanted-visitor/)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1143226762,
                        "definition": {
                            "title": "AttachRolePolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AttachRolePolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 464494287,
                        "definition": {
                            "type": "note",
                            "content": "### [SetDefaultPolicyVersion](https://traildiscover.cloud/#IAM-SetDefaultPolicyVersion)\n\n**Description:** Sets the specified version of the specified policy as the policy's default (operative) version.\n\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2783523649,
                        "definition": {
                            "title": "SetDefaultPolicyVersion",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:SetDefaultPolicyVersion $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3831471183,
                        "definition": {
                            "type": "note",
                            "content": "### [AttachUserPolicy](https://traildiscover.cloud/#IAM-AttachUserPolicy)\n\n**Description:** Attaches the specified managed policy to the specified user.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Incident report: From CLI to console, chasing an attacker in AWS](https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/)\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [Detecting AI resource-hijacking with Composite Alerts](https://www.lacework.com/blog/detecting-ai-resource-hijacking-with-composite-alerts)\n- [Tales from the cloud trenches: Unwanted visitor](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-unwanted-visitor/)\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3903678010,
                        "definition": {
                            "title": "AttachUserPolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AttachUserPolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3912453555,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateGroup](https://traildiscover.cloud/#IAM-CreateGroup)\n\n**Description:** Creates a new group.\n\n**Related Research:**\n- [AWS IAM Group Creation](https://www.elastic.co/guide/en/security/current/aws-iam-group-creation.html)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3984660382,
                        "definition": {
                            "title": "CreateGroup",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateGroup $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1076250822,
                        "definition": {
                            "type": "note",
                            "content": "### [PutUserPolicy](https://traildiscover.cloud/#IAM-PutUserPolicy)\n\n**Description:** Adds or updates an inline policy document that is embedded in the specified IAM user.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [ANATOMY OF AN ATTACK: EXPOSED KEYS TO CRYPTO MINING](https://permiso.io/blog/s/anatomy-of-attack-exposed-keys-to-crypto-mining/)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3395280184,
                        "definition": {
                            "title": "PutUserPolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutUserPolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1202072329,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteRolePermissionsBoundary](https://traildiscover.cloud/#IAM-DeleteRolePermissionsBoundary)\n\n**Description:** Deletes the permissions boundary for the specified IAM role.\n\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1274279156,
                        "definition": {
                            "title": "DeleteRolePermissionsBoundary",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteRolePermissionsBoundary $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2039283537,
                        "definition": {
                            "type": "note",
                            "content": "### [PutGroupPolicy](https://traildiscover.cloud/#IAM-PutGroupPolicy)\n\n**Description:** Adds or updates an inline policy document that is embedded in the specified IAM group.\n\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 63345603,
                        "definition": {
                            "title": "PutGroupPolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutGroupPolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2091914293,
                        "definition": {
                            "type": "note",
                            "content": "### [ChangePassword](https://traildiscover.cloud/#IAM-ChangePassword)\n\n**Description:** Changes the password of the IAM user who is calling this operation.\n\n**Related Research:**\n- [AWS CloudTrail cheat sheet](https://www.invictus-ir.com/news/aws-cloudtrail-cheat-sheet)\n- [IAM User Changes Alarm](https://asecure.cloud/a/cwalarm_iam_user_changes/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2164121120,
                        "definition": {
                            "title": "ChangePassword",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ChangePassword $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2368230992,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateLoginProfile](https://traildiscover.cloud/#IAM-CreateLoginProfile)\n\n**Description:** Creates a password for the specified IAM user. A password allows an IAM user to access AWS services through the AWS Management Console.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Incident report: From CLI to console, chasing an attacker in AWS](https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/)\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n- [LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD](https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud)\n- [Detecting AI resource-hijacking with Composite Alerts](https://www.lacework.com/blog/detecting-ai-resource-hijacking-with-composite-alerts)\n- [Tales from the cloud trenches: Unwanted visitor](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-unwanted-visitor/)\n- [New Developments in LLM Hijacking Activity](https://www.wiz.io/blog/jinx-2401-llm-hijacking-aws)\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n**Related Research:**\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n- [AWS IAM Persistence Methods](https://hackingthe.cloud/aws/post_exploitation/iam_persistence/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2440437819,
                        "definition": {
                            "title": "CreateLoginProfile",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateLoginProfile $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2992046447,
                        "definition": {
                            "type": "note",
                            "content": "### [DetachUserPolicy](https://traildiscover.cloud/#IAM-DetachUserPolicy)\n\n**Description:** Removes the specified managed policy from the specified user.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1016108513,
                        "definition": {
                            "title": "DetachUserPolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DetachUserPolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2470981916,
                        "definition": {
                            "type": "note",
                            "content": "### [PutRolePolicy](https://traildiscover.cloud/#IAM-PutRolePolicy)\n\n**Description:** Adds or updates an inline policy document that is embedded in the specified IAM role.\n\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2543188743,
                        "definition": {
                            "title": "PutRolePolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutRolePolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1034734285,
                        "definition": {
                            "type": "note",
                            "content": "### [AddRoleToInstanceProfile](https://traildiscover.cloud/#IAM-AddRoleToInstanceProfile)\n\n**Description:** Adds the specified IAM role to the specified instance profile.\n\n**Related Research:**\n- [Cloudgoat AWS CTF solution- Scenerio 5 (iam_privesc_by_attachment)](https://pswalia2u.medium.com/cloudgoat-aws-ctf-solution-scenerio-5-iam-privesc-by-attachment-22145650f5f5)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1106941112,
                        "definition": {
                            "title": "AddRoleToInstanceProfile",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AddRoleToInstanceProfile $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2085933069,
                        "definition": {
                            "type": "note",
                            "content": "### [AttachGroupPolicy](https://traildiscover.cloud/#IAM-AttachGroupPolicy)\n\n**Description:** Attaches the specified managed policy to the specified IAM group.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 109995135,
                        "definition": {
                            "title": "AttachGroupPolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AttachGroupPolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2137421544,
                        "definition": {
                            "type": "note",
                            "content": "### [AssociateAccessPolicy](https://traildiscover.cloud/#EKS-AssociateAccessPolicy)\n\n**Description:** Associates an access policy and its scope to an access entry.\n\n**Related Research:**\n- [New attack vectors in EKS](https://www.wiz.io/blog/new-attack-vectors-emerge-via-recent-eks-access-entries-and-pod-identity-features)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 62144723,
                        "definition": {
                            "title": "AssociateAccessPolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AssociateAccessPolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4064620809,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateAccessEntry](https://traildiscover.cloud/#EKS-CreateAccessEntry)\n\n**Description:** Creates an access entry.\n\n**Related Research:**\n- [New attack vectors in EKS](https://www.wiz.io/blog/new-attack-vectors-emerge-via-recent-eks-access-entries-and-pod-identity-features)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2088682875,
                        "definition": {
                            "title": "CreateAccessEntry",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateAccessEntry $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3443391747,
                        "definition": {
                            "type": "note",
                            "content": "### [ModifyInstanceAttribute](https://traildiscover.cloud/#EC2-ModifyInstanceAttribute)\n\n**Description:** Modifies the specified attribute of the specified instance.\n\n**Related Research:**\n- [Executing commands through EC2 user data](https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/executing-commands-through-user-data/)\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [EC2 Privilege Escalation Through User Data](https://hackingthe.cloud/aws/exploitation/local_ec2_priv_esc_through_user_data/)\n- [User Data Script Persistence](https://hackingthe.cloud/aws/post_exploitation/user_data_script_persistence/)\n- [Attack Paths Into VMs in the Cloud](https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1467453813,
                        "definition": {
                            "title": "ModifyInstanceAttribute",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ModifyInstanceAttribute $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 735915368,
                        "definition": {
                            "type": "note",
                            "content": "### [ReplaceIamInstanceProfileAssociation](https://traildiscover.cloud/#EC2-ReplaceIamInstanceProfileAssociation)\n\n**Description:** Replaces an IAM instance profile for the specified running instance.\n\n**Related Incidents:**\n- [LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD](https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 808122195,
                        "definition": {
                            "title": "ReplaceIamInstanceProfileAssociation",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ReplaceIamInstanceProfileAssociation $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2145611215,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateDevEndpoint](https://traildiscover.cloud/#Glue-CreateDevEndpoint)\n\n**Description:** Creates a new development endpoint.\n\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 70334394,
                        "definition": {
                            "title": "CreateDevEndpoint",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateDevEndpoint $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3150279574,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateJob](https://traildiscover.cloud/#Glue-UpdateJob)\n\n**Description:** Updates an existing job definition.\n\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1174341640,
                        "definition": {
                            "title": "UpdateJob",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateJob $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2161499268,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateJob](https://traildiscover.cloud/#Glue-CreateJob)\n\n**Description:** Creates a new job definition.\n\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 185561334,
                        "definition": {
                            "title": "CreateJob",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateJob $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3845038195,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateDevEndpoint](https://traildiscover.cloud/#Glue-UpdateDevEndpoint)\n\n**Description:** Updates a specified development endpoint.\n\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1869100261,
                        "definition": {
                            "title": "UpdateDevEndpoint",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateDevEndpoint $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    }
                ]
            },
            "layout": {
                "x": 0,
                "y": 47,
                "width": 12,
                "height": 30
            }
        },
        {
            "id": 3514431184,
            "definition": {
                "type": "group",
                "layout_type": "ordered",
                "background_color": "blue",
                "title": "TA0005 - Defense Evasion",
                "show_title": true,
                "widgets": [
                    {
                        "id": 2985348985,
                        "definition": {
                            "type": "note",
                            "content": "### [InviteAccountToOrganization](https://traildiscover.cloud/#Organizations-InviteAccountToOrganization)\n\n**Description:** Sends an invitation to another account to join your organization as a member account.\n\n**Related Incidents:**\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1009411051,
                        "definition": {
                            "title": "InviteAccountToOrganization",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:InviteAccountToOrganization $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3395877815,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateAccount](https://traildiscover.cloud/#Organizations-CreateAccount)\n\n**Description:** Creates an AWS account that is automatically a member of the organization whose credentials made the request.\n\n**Related Incidents:**\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1419939881,
                        "definition": {
                            "title": "CreateAccount",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateAccount $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1938255732,
                        "definition": {
                            "type": "note",
                            "content": "### [LeaveOrganization](https://traildiscover.cloud/#Organizations-LeaveOrganization)\n\n**Description:** Removes a member account from its parent organization.\n\n**Related Incidents:**\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n**Related Research:**\n- [An AWS account attempted to leave the AWS Organization](https://docs.datadoghq.com/security/default_rules/aws-organizations-leave-organization/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4257285094,
                        "definition": {
                            "title": "LeaveOrganization",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:LeaveOrganization $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3361881759,
                        "definition": {
                            "type": "note",
                            "content": "### [PutLogEvents](https://traildiscover.cloud/#CloudWatchLogs-PutLogEvents)\n\n**Description:** Uploads a batch of log events to the specified log stream.\n\n**Related Incidents:**\n- [Cloud Security Stories: From Risky Permissions to Ransomware Execution](https://sonraisecurity.com/blog/cloud-security-stories-from-risky-permissions-to-ransomware-execution/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3434088586,
                        "definition": {
                            "title": "PutLogEvents",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutLogEvents $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1496354588,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteAlarms](https://traildiscover.cloud/#CloudWatch-DeleteAlarms)\n\n**Description:** Deletes the specified alarms. You can delete up to 100 alarms in one operation.\n\n**Related Research:**\n- [AWS CloudWatch Alarm Deletion](https://www.elastic.co/guide/en/security/current/aws-cloudwatch-alarm-deletion.html)\n- [Cloud-Conscious Tactics, Techniques,and Procedures (TTPs)](https://fwdcloudsec.org/assets/presentations/2024/europe/sebastian-walla-cloud-conscious-tactics-techniques-and-procedures-an-overview.pdf)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3815383950,
                        "definition": {
                            "title": "DeleteAlarms",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteAlarms $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3795779107,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteLogGroup](https://traildiscover.cloud/#CloudWatchLogs-DeleteLogGroup)\n\n**Description:** Deletes the specified log group and permanently deletes all the archived log events associated with the log group.\n\n**Related Research:**\n- [Penetration testing of aws-based environments](https://essay.utwente.nl/76955/1/Szabo_MSc_EEMCS.pdf)\n- [Generate Strong Security Signals with Sumo Logic & AWS Cloudtrail](https://expel.com/blog/following-cloudtrail-generating-aws-security-signals-sumo-logic/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3867985934,
                        "definition": {
                            "title": "DeleteLogGroup",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteLogGroup $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3212402782,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteLogStream](https://traildiscover.cloud/#CloudWatchLogs-DeleteLogStream)\n\n**Description:** Deletes the specified log stream and permanently deletes all the archived log events associated with the log stream.\n\n**Related Research:**\n- [Generate Strong Security Signals with Sumo Logic & AWS Cloudtrail](https://expel.com/blog/following-cloudtrail-generating-aws-security-signals-sumo-logic/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3284609609,
                        "definition": {
                            "title": "DeleteLogStream",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteLogStream $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3841030365,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateLogStream](https://traildiscover.cloud/#CloudWatchLogs-CreateLogStream)\n\n**Description:** Creates a log stream for the specified log group.\n\n**Related Incidents:**\n- [Cloud Security Stories: From Risky Permissions to Ransomware Execution](https://sonraisecurity.com/blog/cloud-security-stories-from-risky-permissions-to-ransomware-execution/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4012576079,
                        "definition": {
                            "title": "CreateLogStream",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateLogStream $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3417990936,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteRule](https://traildiscover.cloud/#events-DeleteRule)\n\n**Description:** Deletes the specified rule.\n\n**Related Research:**\n- [AWS EventBridge Rule Disabled or Deleted](https://www.elastic.co/guide/en/security/7.17/rules-api-delete.html)\n- [AWS EventBridge rule disabled or deleted](https://docs.datadoghq.com/security/default_rules/aws-eventbridge-rule-disabled-or-deleted/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1442053002,
                        "definition": {
                            "title": "DeleteRule",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteRule $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2238096116,
                        "definition": {
                            "type": "note",
                            "content": "### [RemoveTargets](https://traildiscover.cloud/#events-RemoveTargets)\n\n**Description:** Removes the specified targets from the specified rule.\n\n**Related Research:**\n- [Modify GuardDuty Configuration](https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 262158182,
                        "definition": {
                            "title": "RemoveTargets",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:RemoveTargets $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 827710038,
                        "definition": {
                            "type": "note",
                            "content": "### [DisableRule](https://traildiscover.cloud/#events-DisableRule)\n\n**Description:** Disables the specified rule.\n\n**Related Research:**\n- [AWS EventBridge Rule Disabled or Deleted](https://www.elastic.co/guide/en/security/7.17/rules-api-delete.html)\n- [AWS EventBridge rule disabled or deleted](https://docs.datadoghq.com/security/default_rules/aws-eventbridge-rule-disabled-or-deleted/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3146739400,
                        "definition": {
                            "title": "DisableRule",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DisableRule $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3000469346,
                        "definition": {
                            "type": "note",
                            "content": "### [PutRule](https://traildiscover.cloud/#events-PutRule)\n\n**Description:** Creates or updates the specified rule.\n\n**Related Incidents:**\n- [Cloud Security Stories: From Risky Permissions to Ransomware Execution](https://sonraisecurity.com/blog/cloud-security-stories-from-risky-permissions-to-ransomware-execution/)\n**Related Research:**\n- [Modify GuardDuty Configuration](https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1024531412,
                        "definition": {
                            "title": "PutRule",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutRule $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 426223390,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateInstances](https://traildiscover.cloud/#Lightsail-CreateInstances)\n\n**Description:** Creates one or more Amazon Lightsail instances.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2745252752,
                        "definition": {
                            "title": "CreateInstances",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateInstances $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2859680362,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteMembers](https://traildiscover.cloud/#SecurityHub-DeleteMembers)\n\n**Description:** Deletes the specified member accounts from Security Hub.\n\n**Related Research:**\n- [AWS CloudTrail cheat sheet](https://www.invictus-ir.com/news/aws-cloudtrail-cheat-sheet)\n- [AWS Incident Response](https://easttimor.github.io/aws-incident-response/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 784403541,
                        "definition": {
                            "title": "DeleteMembers",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteMembers $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 917440548,
                        "definition": {
                            "type": "note",
                            "content": "### [DetachRolePolicy](https://traildiscover.cloud/#IAM-DetachRolePolicy)\n\n**Description:** Removes the specified managed policy from the specified role.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 989647375,
                        "definition": {
                            "title": "DetachRolePolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DetachRolePolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1490994449,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteUserPolicy](https://traildiscover.cloud/#IAM-DeleteUserPolicy)\n\n**Description:** Deletes the specified inline policy that is embedded in the specified IAM user.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3810023811,
                        "definition": {
                            "title": "DeleteUserPolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteUserPolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2579310146,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteAccessKey](https://traildiscover.cloud/#IAM-DeleteAccessKey)\n\n**Description:** Deletes the access key pair associated with the specified IAM user.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 603372212,
                        "definition": {
                            "title": "DeleteAccessKey",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteAccessKey $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3736409687,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteUser](https://traildiscover.cloud/#IAM-DeleteUser)\n\n**Description:** Deletes the specified IAM user.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Insider Threat Risks to Flat Environments](https://www.mandiant.com/sites/default/files/2021-09/rpt-mtrends-2021-3.pdf)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1760471753,
                        "definition": {
                            "title": "DeleteUser",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteUser $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 700253075,
                        "definition": {
                            "type": "note",
                            "content": "### [DetachUserPolicy](https://traildiscover.cloud/#IAM-DetachUserPolicy)\n\n**Description:** Removes the specified managed policy from the specified user.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3019282437,
                        "definition": {
                            "title": "DetachUserPolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DetachUserPolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 932690244,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteLoginProfile](https://traildiscover.cloud/#IAM-DeleteLoginProfile)\n\n**Description:** Deletes the password for the specified IAM user.\n\n**Related Incidents:**\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3251719606,
                        "definition": {
                            "title": "DeleteLoginProfile",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteLoginProfile $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3716495853,
                        "definition": {
                            "type": "note",
                            "content": "### [DeactivateMFADevice](https://traildiscover.cloud/#IAM-DeactivateMFADevice)\n\n**Description:** Deactivates the specified MFA device and removes it from association with the user name for which it was originally enabled.\n\n**Related Research:**\n- [AWS IAM Deactivation of MFA Device](https://www.elastic.co/guide/en/security/current/aws-iam-deactivation-of-mfa-device.html)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3788702680,
                        "definition": {
                            "title": "DeactivateMFADevice",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeactivateMFADevice $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3918325434,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateRule](https://traildiscover.cloud/#ELBv2-CreateRule)\n\n**Description:** Creates a rule for the specified listener.\n\n**Related Research:**\n- [Rigging the Rules: Manipulating AWS ALB to Mine Sensitive Data](https://medium.com/@adan.alvarez/rigging-the-rules-manipulating-aws-alb-to-mine-sensitive-data-20e33dbc4994)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4089871148,
                        "definition": {
                            "title": "CreateRule",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateRule $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1144555187,
                        "definition": {
                            "type": "note",
                            "content": "### [StopLogging](https://traildiscover.cloud/#CloudTrail-StopLogging)\n\n**Description:** Suspends the recording of AWS API calls and log file delivery for the specified trail.\n\n**Related Incidents:**\n- [LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD](https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud)\n- [Securing a SaaS Company's AWS Environment After a Breach](https://badshah.io/case-studies/saas-aws-breach/)\n**Related Research:**\n- [Stopping a CloudTrail trail](https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/stopping-cloudtrail-trail/)\n- [AWS Defense Evasion Stop Logging Cloudtrail](https://research.splunk.com/cloud/8a2f3ca2-4eb5-4389-a549-14063882e537/)\n- [AWS Defense Evasion and Centralized Multi-Account Logging](https://logrhythm.com/blog/aws-defense-evasion-and-centralized-multi-account-logging/)\n- [Disrupting AWS logging](https://medium.com/daniel-grzelak/disrupting-aws-logging-a42e437d6594)\n- [Enhancing Your Security Visibility and DetectionResponse Operations in AWS](https://pages.awscloud.com/rs/112-TZM-766/images/Visibility_detect_respond_AWS_SANS_whitepaper.pdf)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3463584549,
                        "definition": {
                            "title": "StopLogging",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:StopLogging $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1692906827,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateTrail](https://traildiscover.cloud/#CloudTrail-UpdateTrail)\n\n**Description:** Updates trail settings that control what events you are logging, and how to handle log files.\n\n**Related Incidents:**\n- [Cloud-Conscious Tactics, Techniques,and Procedures (TTPs)](https://fwdcloudsec.org/assets/presentations/2024/europe/sebastian-walla-cloud-conscious-tactics-techniques-and-procedures-an-overview.pdf)\n**Related Research:**\n- [AWS Defense Evasion and Centralized Multi-Account Logging](https://logrhythm.com/blog/aws-defense-evasion-and-centralized-multi-account-logging/)\n- [Disrupting AWS logging](https://medium.com/daniel-grzelak/disrupting-aws-logging-a42e437d6594)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4011936189,
                        "definition": {
                            "title": "UpdateTrail",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateTrail $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 774521360,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteTrail](https://traildiscover.cloud/#CloudTrail-DeleteTrail)\n\n**Description:** Deletes a trail.\n\n**Related Incidents:**\n- [LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD](https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud)\n- [Cloud-Conscious Tactics, Techniques,and Procedures (TTPs)](https://fwdcloudsec.org/assets/presentations/2024/europe/sebastian-walla-cloud-conscious-tactics-techniques-and-procedures-an-overview.pdf)\n- [Securing a SaaS Company's AWS Environment After a Breach](https://badshah.io/case-studies/saas-aws-breach/)\n**Related Research:**\n- [AWS Defense Evasion Delete Cloudtrail](https://research.splunk.com/cloud/82092925-9ca1-4e06-98b8-85a2d3889552/)\n- [Generate Strong Security Signals with Sumo Logic & AWS Cloudtrail](https://expel.com/blog/following-cloudtrail-generating-aws-security-signals-sumo-logic/)\n- [Disrupting AWS logging](https://medium.com/daniel-grzelak/disrupting-aws-logging-a42e437d6594)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 946067074,
                        "definition": {
                            "title": "DeleteTrail",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteTrail $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 266296353,
                        "definition": {
                            "type": "note",
                            "content": "### [PutEventSelectors](https://traildiscover.cloud/#CloudTrail-PutEventSelectors)\n\n**Description:** Configures an event selector or advanced event selectors for your trail.\n\n**Related Incidents:**\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n**Related Research:**\n- [cloudtrail_guardduty_bypass](https://github.com/RhinoSecurityLabs/Cloud-Security-Research/tree/master/AWS/cloudtrail_guardduty_bypass)\n- [Detecting and removing risky actions out of your IAM security policies](https://www.solvo.cloud/blog/detecting-and-removing-risky-actions-out-of-your-iam-security-policies/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2585325715,
                        "definition": {
                            "title": "PutEventSelectors",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutEventSelectors $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2782875265,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateGraphqlApi](https://traildiscover.cloud/#AppSync-UpdateGraphqlApi)\n\n**Description:** Updates a GraphqlApi object.\n\n**Related Research:**\n- [Distorting the Sync: How AWS AppSync Can Be Turned into an Attacker\u2019s Backdoor](https://medium.com/@adan.alvarez/distorting-the-sync-how-aws-appsync-can-be-turned-into-an-attackers-backdoor-8c015b8e52b8)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 806937331,
                        "definition": {
                            "title": "UpdateGraphqlApi",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateGraphqlApi $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3204045129,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateApiKey](https://traildiscover.cloud/#AppSync-CreateApiKey)\n\n**Description:** Creates a unique key that you can distribute to clients who invoke your API.\n\n**Related Research:**\n- [Distorting the Sync: How AWS AppSync Can Be Turned into an Attacker\u2019s Backdoor](https://medium.com/@adan.alvarez/distorting-the-sync-how-aws-appsync-can-be-turned-into-an-attackers-backdoor-8c015b8e52b8)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1228107195,
                        "definition": {
                            "title": "CreateApiKey",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateApiKey $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 576841461,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateResolver](https://traildiscover.cloud/#AppSync-UpdateResolver)\n\n**Description:** Updates a Resolver object.\n\n**Related Research:**\n- [Distorting the Sync: How AWS AppSync Can Be Turned into an Attacker\u2019s Backdoor](https://medium.com/@adan.alvarez/distorting-the-sync-how-aws-appsync-can-be-turned-into-an-attackers-backdoor-8c015b8e52b8)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2895870823,
                        "definition": {
                            "title": "UpdateResolver",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateResolver $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2522514480,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteBucketPolicy](https://traildiscover.cloud/#S3-DeleteBucketPolicy)\n\n**Description:** Deletes the policy of a specified bucket.\n\n**Related Research:**\n- [AWS S3 Bucket Configuration Deletion](https://www.elastic.co/guide/en/security/7.17/aws-s3-bucket-configuration-deletion.html)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 546576546,
                        "definition": {
                            "title": "DeleteBucketPolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteBucketPolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1544614010,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteFlowLogs](https://traildiscover.cloud/#EC2-DeleteFlowLogs)\n\n**Description:** Deletes one or more flow logs.\n\n**Related Incidents:**\n- [Cloud-Conscious Tactics, Techniques,and Procedures (TTPs)](https://fwdcloudsec.org/assets/presentations/2024/europe/sebastian-walla-cloud-conscious-tactics-techniques-and-procedures-an-overview.pdf)\n**Related Research:**\n- [Removing VPC flow logs](https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/removing-vpc-flow-logs/)\n- [AWS Incident Response](https://github.com/easttimor/aws-incident-response)\n- [Proactive Cloud Security w/ AWS Organizations](https://witoff.medium.com/proactive-cloud-security-w-aws-organizations-d58695bcae16)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3863643372,
                        "definition": {
                            "title": "DeleteFlowLogs",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteFlowLogs $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 955216140,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteNetworkAcl](https://traildiscover.cloud/#EC2-DeleteNetworkAcl)\n\n**Description:** Deletes the specified network ACL.\n\n**Related Research:**\n- [Ensure CloudWatch has an Alarm for Network ACL Changes](https://www.intelligentdiscovery.io/controls/cloudwatch/cloudwatch-alarm-network-acl-change)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3274245502,
                        "definition": {
                            "title": "DeleteNetworkAcl",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteNetworkAcl $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2699336786,
                        "definition": {
                            "type": "note",
                            "content": "### [TerminateInstances](https://traildiscover.cloud/#EC2-TerminateInstances)\n\n**Description:** Shuts down the specified instances. This operation is idempotent; if you terminate an instance more than once, each call succeeds.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n- [Former Cisco engineer sentenced to prison for deleting 16k Webex accounts](https://www.zdnet.com/article/former-cisco-engineer-sentenced-to-prison-for-deleting-16k-webex-accounts/)\n- [Hacker Puts Hosting Service Code Spaces Out of Business](https://threatpost.com/hacker-puts-hosting-service-code-spaces-out-of-business/106761/)\n- [Securing a SaaS Company's AWS Environment After a Breach](https://badshah.io/case-studies/saas-aws-breach/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2870882500,
                        "definition": {
                            "title": "TerminateInstances",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:TerminateInstances $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3100493724,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteNetworkAclEntry](https://traildiscover.cloud/#EC2-DeleteNetworkAclEntry)\n\n**Description:** Deletes the specified ingress or egress entry (rule) from the specified network ACL.\n\n**Related Research:**\n- [Ensure CloudWatch has an Alarm for Network ACL Changes](https://www.intelligentdiscovery.io/controls/cloudwatch/cloudwatch-alarm-network-acl-change)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1025216903,
                        "definition": {
                            "title": "DeleteNetworkAclEntry",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteNetworkAclEntry $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2324585617,
                        "definition": {
                            "type": "note",
                            "content": "### [StopInstances](https://traildiscover.cloud/#EC2-StopInstances)\n\n**Description:** Stops an Amazon EBS-backed instance.\n\n**Related Incidents:**\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n**Related Research:**\n- [Executing commands through EC2 user data](https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/executing-commands-through-user-data/)\n- [Attack Paths Into VMs in the Cloud](https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 348647683,
                        "definition": {
                            "title": "StopInstances",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:StopInstances $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3472001464,
                        "definition": {
                            "type": "note",
                            "content": "### [AuthorizeDBSecurityGroupIngress](https://traildiscover.cloud/#RDS-AuthorizeDBSecurityGroupIngress)\n\n**Description:** Enables ingress to a DBSecurityGroup using one of two forms of authorization.\n\n**Related Research:**\n- [Enhancing Your Security Visibility and DetectionResponse Operations in AWS](https://pages.awscloud.com/rs/112-TZM-766/images/Visibility_detect_respond_AWS_SANS_whitepaper.pdf)\n- [Hunting AWS RDS security events with Sysdig](https://sysdig.com/blog/aws-rds-security-events-sysdig/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1496063530,
                        "definition": {
                            "title": "AuthorizeDBSecurityGroupIngress",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AuthorizeDBSecurityGroupIngress $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2854680033,
                        "definition": {
                            "type": "note",
                            "content": "### [ModifyActivityStream](https://traildiscover.cloud/#RDS-ModifyActivityStream)\n\n**Description:** Changes the audit policy state of a database activity stream to either locked (default) or unlocked.\n\n**Related Incidents:**\n- [Uncovering Hybrid Cloud Attacks Through Intelligence-Driven Incident Response: Part 3 \u2013 The Response](https://www.gem.security/post/uncovering-hybrid-cloud-attacks-through-intelligence-driven-incident-response-part-3-the-response)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 878742099,
                        "definition": {
                            "title": "ModifyActivityStream",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ModifyActivityStream $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1516098040,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteIdentity](https://traildiscover.cloud/#SES-DeleteIdentity)\n\n**Description:** Deletes the specified identity (an email address or a domain) from the list of verified identities.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3835127402,
                        "definition": {
                            "title": "DeleteIdentity",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteIdentity $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 717338885,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateIPSet](https://traildiscover.cloud/#GuardDuty-UpdateIPSet)\n\n**Description:** Updates the IPSet specified by the IPSet ID.\n\n**Related Research:**\n- [Modify GuardDuty Configuration](https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 789545712,
                        "definition": {
                            "title": "UpdateIPSet",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateIPSet $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1984805963,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteInvitations](https://traildiscover.cloud/#GuardDuty-DeleteInvitations)\n\n**Description:** Deletes invitations sent to the current member account by AWS accounts specified by their account IDs.\n\n**Related Incidents:**\n- [LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD](https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 8868029,
                        "definition": {
                            "title": "DeleteInvitations",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteInvitations $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2970302581,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateDetector](https://traildiscover.cloud/#GuardDuty-UpdateDetector)\n\n**Description:** Updates the GuardDuty detector specified by the detectorId.\n\n**Related Research:**\n- [Modify GuardDuty Configuration](https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 994364647,
                        "definition": {
                            "title": "UpdateDetector",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateDetector $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1929169259,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteDetector](https://traildiscover.cloud/#GuardDuty-DeleteDetector)\n\n**Description:** Deletes an Amazon GuardDuty detector that is specified by the detector ID.\n\n**Related Incidents:**\n- [LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD](https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud)\n**Related Research:**\n- [AWS GuardDuty detector deleted](https://docs.datadoghq.com/security/default_rules/cloudtrail-aws-guardduty-detector-deleted/)\n- [AWS GuardDuty Evasion](https://medium.com/@cloud_tips/aws-guardduty-evasion-c181e55f3af1)\n- [Threat Hunting with CloudTrail and GuardDuty in Splunk](https://www.chrisfarris.com/post/reinforce-threat-hunting/)\n- [Cloud-Conscious Tactics, Techniques,and Procedures (TTPs)](https://fwdcloudsec.org/assets/presentations/2024/europe/sebastian-walla-cloud-conscious-tactics-techniques-and-procedures-an-overview.pdf)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4148859734,
                        "definition": {
                            "title": "DeleteDetector",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteDetector $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3780982010,
                        "definition": {
                            "type": "note",
                            "content": "### [DeletePublishingDestination](https://traildiscover.cloud/#GuardDuty-DeletePublishingDestination)\n\n**Description:** Deletes the publishing definition with the specified destinationId.\n\n**Related Research:**\n- [Modify GuardDuty Configuration](https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 28,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1805044076,
                        "definition": {
                            "title": "DeletePublishingDestination",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeletePublishingDestination $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 28,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2104664972,
                        "definition": {
                            "type": "note",
                            "content": "### [DisassociateMembers](https://traildiscover.cloud/#GuardDuty-DisassociateMembers)\n\n**Description:** Disassociates GuardDuty member accounts (from the current administrator account) specified by the account IDs.\n\n**Related Research:**\n- [Threat Hunting with CloudTrail and GuardDuty in Splunk](https://www.chrisfarris.com/post/reinforce-threat-hunting/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 28,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2276210686,
                        "definition": {
                            "title": "DisassociateMembers",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DisassociateMembers $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 28,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1757376513,
                        "definition": {
                            "type": "note",
                            "content": "### [DisassociateFromMasterAccount](https://traildiscover.cloud/#GuardDuty-DisassociateFromMasterAccount)\n\n**Description:** Disassociates the current GuardDuty member account from its administrator account.\n\n**Related Incidents:**\n- [LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD](https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud)\n**Related Research:**\n- [Threat Hunting with CloudTrail and GuardDuty in Splunk](https://www.chrisfarris.com/post/reinforce-threat-hunting/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 28,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4076405875,
                        "definition": {
                            "title": "DisassociateFromMasterAccount",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DisassociateFromMasterAccount $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 28,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4166247489,
                        "definition": {
                            "type": "note",
                            "content": "### [StopMonitoringMembers](https://traildiscover.cloud/#GuardDuty-StopMonitoringMembers)\n\n**Description:** Stops GuardDuty monitoring for the specified member accounts.\n\n**Related Research:**\n- [Threat Hunting with CloudTrail and GuardDuty in Splunk](https://www.chrisfarris.com/post/reinforce-threat-hunting/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 30,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2190309555,
                        "definition": {
                            "title": "StopMonitoringMembers",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:StopMonitoringMembers $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 30,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1639498051,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateIPSet](https://traildiscover.cloud/#GuardDuty-CreateIPSet)\n\n**Description:** Creates a new IPSet, which is called a trusted IP list in the console user interface.\n\n**Related Research:**\n- [Modify GuardDuty Configuration](https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 30,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1711704878,
                        "definition": {
                            "title": "CreateIPSet",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateIPSet $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 30,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3625016359,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateFilter](https://traildiscover.cloud/#GuardDuty-CreateFilter)\n\n**Description:** Creates a filter using the specified finding criteria.\n\n**Related Research:**\n- [Modify GuardDuty Configuration](https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 30,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1649078425,
                        "definition": {
                            "title": "CreateFilter",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateFilter $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 30,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2859680362,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteMembers](https://traildiscover.cloud/#GuardDuty-DeleteMembers)\n\n**Description:** Deletes GuardDuty member accounts (to the current GuardDuty administrator account) specified by the account IDs.\n\n**Related Research:**\n- [Threat Hunting with CloudTrail and GuardDuty in Splunk](https://www.chrisfarris.com/post/reinforce-threat-hunting/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 32,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 784403541,
                        "definition": {
                            "title": "DeleteMembers",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteMembers $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 32,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 42319711,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteConfigurationRecorder](https://traildiscover.cloud/#Config-DeleteConfigurationRecorder)\n\n**Description:** Deletes the configuration recorder.\n\n**Related Research:**\n- [AWS Config Resource Deletion](https://www.elastic.co/guide/en/security/7.17/prebuilt-rule-7-16-4-aws-config-resource-deletion.html#prebuilt-rule-7-16-4-aws-config-resource-deletion)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 32,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2361349073,
                        "definition": {
                            "title": "DeleteConfigurationRecorder",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteConfigurationRecorder $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 32,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1020268063,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteDeliveryChannel](https://traildiscover.cloud/#Config-DeleteDeliveryChannel)\n\n**Description:** Deletes the delivery channel.\n\n**Related Research:**\n- [AWS Config Resource Deletion](https://www.elastic.co/guide/en/security/7.17/prebuilt-rule-7-16-4-aws-config-resource-deletion.html#prebuilt-rule-7-16-4-aws-config-resource-deletion)\n- [AWS Config modified](https://docs.datadoghq.com/security/default_rules/cloudtrail-aws-config-disabled/)\n- [Threat Hunting with CloudTrail and GuardDuty in Splunk](https://www.chrisfarris.com/post/reinforce-threat-hunting/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 32,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1092474890,
                        "definition": {
                            "title": "DeleteDeliveryChannel",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteDeliveryChannel $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 32,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 397661001,
                        "definition": {
                            "type": "note",
                            "content": "### [StopConfigurationRecorder](https://traildiscover.cloud/#Config-StopConfigurationRecorder)\n\n**Description:** Stops recording configurations of the AWS resources you have selected to record in your AWS account.\n\n**Related Research:**\n- [AWS Configuration Recorder Stopped](https://www.elastic.co/guide/en/security/current/prebuilt-rule-8-2-1-aws-configuration-recorder-stopped.html#prebuilt-rule-8-2-1-aws-configuration-recorder-stopped)\n- [AWS Config modified](https://docs.datadoghq.com/security/default_rules/cloudtrail-aws-config-disabled/)\n- [Threat Hunting with CloudTrail and GuardDuty in Splunk](https://www.chrisfarris.com/post/reinforce-threat-hunting/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 34,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2617351476,
                        "definition": {
                            "title": "StopConfigurationRecorder",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:StopConfigurationRecorder $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 34,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2167198281,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteConfigRule](https://traildiscover.cloud/#Config-DeleteConfigRule)\n\n**Description:** Deletes the specified AWS Config rule and all of its evaluation results.\n\n**Related Research:**\n- [AWS Config Resource Deletion](https://www.elastic.co/guide/en/security/7.17/prebuilt-rule-7-16-4-aws-config-resource-deletion.html#prebuilt-rule-7-16-4-aws-config-resource-deletion)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 34,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 191260347,
                        "definition": {
                            "title": "DeleteConfigRule",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteConfigRule $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 34,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2424240634,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteRuleGroup](https://traildiscover.cloud/#WAFV2-DeleteRuleGroup)\n\n**Description:** Deletes the specified RuleGroup.\n\n**Related Research:**\n- [AWS WAF Rule or Rule Group Deletion](https://www.elastic.co/guide/en/security/current/aws-waf-rule-or-rule-group-deletion.html)\n- [AWS Incident Response](https://easttimor.github.io/aws-incident-response/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 34,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 448302700,
                        "definition": {
                            "title": "DeleteRuleGroup",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteRuleGroup $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 34,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 717338885,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateIPSet](https://traildiscover.cloud/#WAFV2-UpdateIPSet)\n\n**Description:** Updates the specified IPSet.\n\n**Related Research:**\n- [AWS Incident Response](https://easttimor.github.io/aws-incident-response/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 36,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 789545712,
                        "definition": {
                            "title": "UpdateIPSet",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateIPSet $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 36,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 858589081,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteWebACL](https://traildiscover.cloud/#WAFV2-DeleteWebACL)\n\n**Description:** Deletes the specified WebACL.\n\n**Related Research:**\n- [AWS Incident Response](https://easttimor.github.io/aws-incident-response/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 36,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3177618443,
                        "definition": {
                            "title": "DeleteWebACL",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteWebACL $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 36,
                            "width": 2,
                            "height": 2
                        }
                    }
                ]
            },
            "layout": {
                "x": 0,
                "y": 77,
                "width": 12,
                "height": 40
            }
        },
        {
            "id": 3740927327,
            "definition": {
                "type": "group",
                "layout_type": "ordered",
                "background_color": "blue",
                "title": "TA0006 - Credential Access",
                "show_title": true,
                "widgets": [
                    {
                        "id": 2605378142,
                        "definition": {
                            "type": "note",
                            "content": "### [GetSecretValue](https://traildiscover.cloud/#SecretsManager-GetSecretValue)\n\n**Description:** Retrieves the contents of the encrypted fields SecretString or SecretBinary from the specified version of a secret, whichever contains content.\n\n**Related Incidents:**\n- [LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD](https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud)\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n- [Cloud-Conscious Tactics, Techniques,and Procedures (TTPs)](https://fwdcloudsec.org/assets/presentations/2024/europe/sebastian-walla-cloud-conscious-tactics-techniques-and-procedures-an-overview.pdf)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 629440208,
                        "definition": {
                            "title": "GetSecretValue",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetSecretValue $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 287973502,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeSecret](https://traildiscover.cloud/#SecretsManager-DescribeSecret)\n\n**Description:** Retrieves the details of a secret.\n\n**Related Incidents:**\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2607002864,
                        "definition": {
                            "title": "DescribeSecret",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeSecret $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3427898371,
                        "definition": {
                            "type": "note",
                            "content": "### [ListSecrets](https://traildiscover.cloud/#SecretsManager-ListSecrets)\n\n**Description:** Lists the secrets that are stored by Secrets Manager in the AWS account, not including secrets that are marked for deletion.\n\n**Related Incidents:**\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n- [Detecting AI resource-hijacking with Composite Alerts](https://www.lacework.com/blog/detecting-ai-resource-hijacking-with-composite-alerts)\n- [Tales from the cloud trenches: Raiding for AWS vaults, buckets and secrets](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-raiding-for-vaults-buckets-secrets/)\n- [Cloud-Conscious Tactics, Techniques,and Procedures (TTPs)](https://fwdcloudsec.org/assets/presentations/2024/europe/sebastian-walla-cloud-conscious-tactics-techniques-and-procedures-an-overview.pdf)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3500105198,
                        "definition": {
                            "title": "ListSecrets",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListSecrets $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1063122733,
                        "definition": {
                            "type": "note",
                            "content": "### [GetPasswordData](https://traildiscover.cloud/#EC2-GetPasswordData)\n\n**Description:** Retrieves the encrypted administrator password for a running Windows instance.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [Behind the scenes in the Expel SOC: Alert-to-fix in AWS](https://expel.com/blog/behind-the-scenes-expel-soc-alert-aws/)\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3382152095,
                        "definition": {
                            "title": "GetPasswordData",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetPasswordData $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4178343298,
                        "definition": {
                            "type": "note",
                            "content": "### [ModifyDBInstance](https://traildiscover.cloud/#RDS-ModifyDBInstance)\n\n**Description:** Modifies settings for a DB instance.\n\n**Related Incidents:**\n- [Securing a SaaS Company's AWS Environment After a Breach](https://badshah.io/case-studies/saas-aws-breach/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4250550125,
                        "definition": {
                            "title": "ModifyDBInstance",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ModifyDBInstance $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1744827761,
                        "definition": {
                            "type": "note",
                            "content": "### [GetParameters](https://traildiscover.cloud/#SSM-GetParameters)\n\n**Description:** Get information about one or more parameters by specifying multiple parameter names.\n\n**Related Research:**\n- [Detecting and removing risky actions out of your IAM security policies](https://www.solvo.cloud/blog/detecting-and-removing-risky-actions-out-of-your-iam-security-policies/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1916373475,
                        "definition": {
                            "title": "GetParameters",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetParameters $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    }
                ]
            },
            "layout": {
                "x": 0,
                "y": 117,
                "width": 12,
                "height": 6
            }
        },
        {
            "id": 2321670875,
            "definition": {
                "type": "group",
                "layout_type": "ordered",
                "background_color": "blue",
                "title": "TA0007 - Discovery",
                "show_title": true,
                "widgets": [
                    {
                        "id": 3836034965,
                        "definition": {
                            "type": "note",
                            "content": "### [ListDomains](https://traildiscover.cloud/#route53domains-ListDomains)\n\n**Description:** This operation returns all the domain names registered with Amazon Route 53 for the current AWS account if no filtering conditions are used.\n\n**Related Research:**\n- [Following attackers\u2019 (Cloud)trail in AWS: Methodology and findings in the wild](https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3908241792,
                        "definition": {
                            "title": "ListDomains",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListDomains $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2861723841,
                        "definition": {
                            "type": "note",
                            "content": "### [GetHostedZoneCount](https://traildiscover.cloud/#Route53-GetHostedZoneCount)\n\n**Description:** Retrieves the number of hosted zones that are associated with the current AWS account.\n\n**Related Research:**\n- [Following attackers\u2019 (Cloud)trail in AWS: Methodology and findings in the wild](https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 885785907,
                        "definition": {
                            "title": "GetHostedZoneCount",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetHostedZoneCount $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1263843953,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeOrganization](https://traildiscover.cloud/#Organizations-DescribeOrganization)\n\n**Description:** Retrieves information about the organization that the user's account belongs to.\n\n**Related Incidents:**\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1435389667,
                        "definition": {
                            "title": "DescribeOrganization",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeOrganization $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1326673253,
                        "definition": {
                            "type": "note",
                            "content": "### [ListOrganizationalUnitsForParent](https://traildiscover.cloud/#Organizations-ListOrganizationalUnitsForParent)\n\n**Description:** Lists the organizational units (OUs) in a parent organizational unit or root.\n\n**Related Incidents:**\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3645702615,
                        "definition": {
                            "title": "ListOrganizationalUnitsForParent",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListOrganizationalUnitsForParent $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1839156670,
                        "definition": {
                            "type": "note",
                            "content": "### [ListAccounts](https://traildiscover.cloud/#Organizations-ListAccounts)\n\n**Description:** Lists all the accounts in the organization.\n\n**Related Incidents:**\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4158186032,
                        "definition": {
                            "title": "ListAccounts",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListAccounts $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 549164963,
                        "definition": {
                            "type": "note",
                            "content": "### [GetCallerIdentity](https://traildiscover.cloud/#STS-GetCallerIdentity)\n\n**Description:** Returns details about the IAM user or role whose credentials are used to call the operation.\n\n**Related Incidents:**\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n- [GotRoot! AWS root Account Takeover](https://medium.com/@gchib/naturesbasket-aws-root-account-takeover-e4aa5c5e95e1)\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n- [Tales from the cloud trenches: Using malicious AWS activity to spot phishing campaigns](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-aws-activity-to-phishing/)\n- [Detecting AI resource-hijacking with Composite Alerts](https://www.lacework.com/blog/detecting-ai-resource-hijacking-with-composite-alerts)\n- [Cloud-Conscious Tactics, Techniques,and Procedures (TTPs)](https://fwdcloudsec.org/assets/presentations/2024/europe/sebastian-walla-cloud-conscious-tactics-techniques-and-procedures-an-overview.pdf)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n**Related Research:**\n- [Following attackers\u2019 (Cloud)trail in AWS: Methodology and findings in the wild](https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/)\n- [New attack vectors in EKS](https://www.wiz.io/blog/new-attack-vectors-emerge-via-recent-eks-access-entries-and-pod-identity-features)\n- [Enumerate AWS Account ID from an EC2 Instance](https://hackingthe.cloud/aws/enumeration/account_id_from_ec2/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2868194325,
                        "definition": {
                            "title": "GetCallerIdentity",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetCallerIdentity $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2094252380,
                        "definition": {
                            "type": "note",
                            "content": "### [ListTopics](https://traildiscover.cloud/#SNS-ListTopics)\n\n**Description:** Returns a list of the requester's topics.\n\n**Related Research:**\n- [NEW PHONE, WHO DIS? HOW CLOUD ENVIRONMENTS ARE EXPLOITED FOR SMISHING CAMPAIGNS](https://permiso.io/blog/s/smishing-attack-on-aws-sms-new-phone-who-dis/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 118314446,
                        "definition": {
                            "title": "ListTopics",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListTopics $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1470526220,
                        "definition": {
                            "type": "note",
                            "content": "### [ListSubscriptions](https://traildiscover.cloud/#SNS-ListSubscriptions)\n\n**Description:** Lists the calling AWS account's dedicated origination numbers and their metadata.\n\n**Related Research:**\n- [NEW PHONE, WHO DIS? HOW CLOUD ENVIRONMENTS ARE EXPLOITED FOR SMISHING CAMPAIGNS](https://permiso.io/blog/s/smishing-attack-on-aws-sms-new-phone-who-dis/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3789555582,
                        "definition": {
                            "title": "ListSubscriptions",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListSubscriptions $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3180686121,
                        "definition": {
                            "type": "note",
                            "content": "### [ListOriginationNumbers](https://traildiscover.cloud/#SNS-ListOriginationNumbers)\n\n**Description:** Lists the calling AWS account's dedicated origination numbers and their metadata.\n\n**Related Research:**\n- [NEW PHONE, WHO DIS? HOW CLOUD ENVIRONMENTS ARE EXPLOITED FOR SMISHING CAMPAIGNS](https://permiso.io/blog/s/smishing-attack-on-aws-sms-new-phone-who-dis/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1204748187,
                        "definition": {
                            "title": "ListOriginationNumbers",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListOriginationNumbers $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4210556024,
                        "definition": {
                            "type": "note",
                            "content": "### [GetSMSAttributes](https://traildiscover.cloud/#SNS-GetSMSAttributes)\n\n**Description:** Returns the settings for sending SMS messages from your AWS account.\n\n**Related Incidents:**\n- [NEW PHONE, WHO DIS? HOW CLOUD ENVIRONMENTS ARE EXPLOITED FOR SMISHING CAMPAIGNS](https://permiso.io/blog/s/smishing-attack-on-aws-sms-new-phone-who-dis/)\n- [Tales from the cloud trenches: Using malicious AWS activity to spot phishing campaigns](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-aws-activity-to-phishing/)\n**Related Research:**\n- [Following attackers\u2019 (Cloud)trail in AWS: Methodology and findings in the wild](https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2234618090,
                        "definition": {
                            "title": "GetSMSAttributes",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetSMSAttributes $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3539337908,
                        "definition": {
                            "type": "note",
                            "content": "### [GetSMSSandboxAccountStatus](https://traildiscover.cloud/#SNS-GetSMSSandboxAccountStatus)\n\n**Description:** Retrieves the SMS sandbox status for the calling AWS account in the target AWS Region.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: Using malicious AWS activity to spot phishing campaigns](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-aws-activity-to-phishing/)\n**Related Research:**\n- [NEW PHONE, WHO DIS? HOW CLOUD ENVIRONMENTS ARE EXPLOITED FOR SMISHING CAMPAIGNS](https://permiso.io/blog/s/smishing-attack-on-aws-sms-new-phone-who-dis/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1563399974,
                        "definition": {
                            "title": "GetSMSSandboxAccountStatus",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetSMSSandboxAccountStatus $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3670578990,
                        "definition": {
                            "type": "note",
                            "content": "### [IssueCertificate](https://traildiscover.cloud/#ACMPCA-IssueCertificate)\n\n**Description:** Uses your private certificate authority (CA), or one that has been shared with you, to issue a client certificate.\n\n**Related Research:**\n- [AWS API Call Hijacking via ACM-PCA](https://hackingthe.cloud/aws/exploitation/route53_modification_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1694641056,
                        "definition": {
                            "title": "IssueCertificate",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:IssueCertificate $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1821997608,
                        "definition": {
                            "type": "note",
                            "content": "### [GetCertificate](https://traildiscover.cloud/#ACMPCA-GetCertificate)\n\n**Description:** Retrieves a certificate from your private CA or one that has been shared with you.\n\n**Related Research:**\n- [AWS API Call Hijacking via ACM-PCA](https://hackingthe.cloud/aws/exploitation/route53_modification_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1993543322,
                        "definition": {
                            "title": "GetCertificate",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetCertificate $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 353602409,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeLogGroups](https://traildiscover.cloud/#CloudWatchLogs-DescribeLogGroups)\n\n**Description:** Lists the specified log groups.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2672631771,
                        "definition": {
                            "title": "DescribeLogGroups",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeLogGroups $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 706484636,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeSubscriptionFilters](https://traildiscover.cloud/#CloudWatchLogs-DescribeSubscriptionFilters)\n\n**Description:** Lists the subscription filters for the specified log group.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3025513998,
                        "definition": {
                            "title": "DescribeSubscriptionFilters",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeSubscriptionFilters $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3001397092,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeLogStreams](https://traildiscover.cloud/#CloudWatchLogs-DescribeLogStreams)\n\n**Description:** Lists the log streams for the specified log group.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1025459158,
                        "definition": {
                            "title": "DescribeLogStreams",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeLogStreams $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 229518382,
                        "definition": {
                            "type": "note",
                            "content": "### [GetLogRecord](https://traildiscover.cloud/#CloudWatchLogs-GetLogRecord)\n\n**Description:** Retrieves all of the fields and values of a single log event.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2548547744,
                        "definition": {
                            "title": "GetLogRecord",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetLogRecord $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 916006301,
                        "definition": {
                            "type": "note",
                            "content": "### [GetQueryResults](https://traildiscover.cloud/#Athena-GetQueryResults)\n\n**Description:** Streams the results of a single query execution specified by QueryExecutionId from the Athena query results location in Amazon S3.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3135696776,
                        "definition": {
                            "title": "GetQueryResults",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetQueryResults $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 806212822,
                        "definition": {
                            "type": "note",
                            "content": "### [ListTargetsByRule](https://traildiscover.cloud/#events-ListTargetsByRule)\n\n**Description:** Lists the targets assigned to the specified rule.\n\n**Related Research:**\n- [Modify GuardDuty Configuration](https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 878419649,
                        "definition": {
                            "title": "ListTargetsByRule",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListTargetsByRule $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4193560156,
                        "definition": {
                            "type": "note",
                            "content": "### [ListRules](https://traildiscover.cloud/#events-ListRules)\n\n**Description:** Lists your Amazon EventBridge rules. You can either list all the rules or you can provide a prefix to match to the rule names.\n\n**Related Research:**\n- [Modify GuardDuty Configuration](https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2217622222,
                        "definition": {
                            "title": "ListRules",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListRules $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1087893161,
                        "definition": {
                            "type": "note",
                            "content": "### [GetInstances](https://traildiscover.cloud/#LightSail-GetInstances)\n\n**Description:** Returns information about all Amazon Lightsail virtual private servers, or instances.\n\n**Related Research:**\n- [Following attackers\u2019 (Cloud)trail in AWS: Methodology and findings in the wild](https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3406922523,
                        "definition": {
                            "title": "GetInstances",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetInstances $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1254044026,
                        "definition": {
                            "type": "note",
                            "content": "### [GetRegions](https://traildiscover.cloud/#LightSail-GetRegions)\n\n**Description:** Returns a list of all valid regions for Amazon Lightsail.\n\n**Related Research:**\n- [Following attackers\u2019 (Cloud)trail in AWS: Methodology and findings in the wild](https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3573073388,
                        "definition": {
                            "title": "GetRegions",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetRegions $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 654532953,
                        "definition": {
                            "type": "note",
                            "content": "### [GetCostAndUsage](https://traildiscover.cloud/#CostExplorer-GetCostAndUsage)\n\n**Description:** Retrieves cost and usage metrics for your account.\n\n**Related Incidents:**\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2973562315,
                        "definition": {
                            "title": "GetCostAndUsage",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetCostAndUsage $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 572037980,
                        "definition": {
                            "type": "note",
                            "content": "### [ListGroupsForUser](https://traildiscover.cloud/#IAM-ListGroupsForUser)\n\n**Description:** Lists the IAM groups that the specified IAM user belongs to.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 743583694,
                        "definition": {
                            "title": "ListGroupsForUser",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListGroupsForUser $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2087851314,
                        "definition": {
                            "type": "note",
                            "content": "### [ListAccessKeys](https://traildiscover.cloud/#IAM-ListAccessKeys)\n\n**Description:** Returns information about the access key IDs associated with the specified IAM user.\n\n**Related Incidents:**\n- [Ransomware in the cloud](https://www.invictus-ir.com/news/ransomware-in-the-cloud)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2160058141,
                        "definition": {
                            "title": "ListAccessKeys",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListAccessKeys $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3575629314,
                        "definition": {
                            "type": "note",
                            "content": "### [ListUserPolicies](https://traildiscover.cloud/#IAM-ListUserPolicies)\n\n**Description:** Lists the names of the inline policies embedded in the specified IAM user.\n\n**Related Incidents:**\n- [Datadog threat roundup: top insights for Q4 2024](https://securitylabs.datadoghq.com/articles/2024-q4-threat-roundup/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3747175028,
                        "definition": {
                            "title": "ListUserPolicies",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListUserPolicies $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1233928427,
                        "definition": {
                            "type": "note",
                            "content": "### [SimulatePrincipalPolicy](https://traildiscover.cloud/#IAM-SimulatePrincipalPolicy)\n\n**Description:** Simulate how a set of IAM policies attached to an IAM entity works with a list of API operations and AWS resources to determine the policies' effective permissions.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3552957789,
                        "definition": {
                            "title": "SimulatePrincipalPolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:SimulatePrincipalPolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2642629072,
                        "definition": {
                            "type": "note",
                            "content": "### [GetAccountAuthorizationDetails](https://traildiscover.cloud/#IAM-GetAccountAuthorizationDetails)\n\n**Description:** Retrieves information about all IAM users, groups, roles, and policies in your AWS account, including their relationships to one another.\n\n**Related Research:**\n- [AWS - IAM Enum](https://cloud.hacktricks.xyz/pentesting-cloud/aws-security/aws-services/aws-iam-enum)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 567352251,
                        "definition": {
                            "title": "GetAccountAuthorizationDetails",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetAccountAuthorizationDetails $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 780637263,
                        "definition": {
                            "type": "note",
                            "content": "### [ListGroups](https://traildiscover.cloud/#IAM-ListGroups)\n\n**Description:** Lists the IAM groups that have the specified path prefix.\n\n**Related Incidents:**\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n**Related Research:**\n- [AWS - IAM Enum](https://cloud.hacktricks.xyz/pentesting-cloud/aws-security/aws-services/aws-iam-enum)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3099666625,
                        "definition": {
                            "title": "ListGroups",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListGroups $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3937510787,
                        "definition": {
                            "type": "note",
                            "content": "### [ListUsers](https://traildiscover.cloud/#IAM-ListUsers)\n\n**Description:** Lists the IAM users that have the specified path prefix. If no path prefix is specified, the operation returns all users in the AWS account.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Ransomware in the cloud](https://www.invictus-ir.com/news/ransomware-in-the-cloud)\n- [Incident report: From CLI to console, chasing an attacker in AWS](https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/)\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n- [Cloud-Conscious Tactics, Techniques,and Procedures (TTPs)](https://fwdcloudsec.org/assets/presentations/2024/europe/sebastian-walla-cloud-conscious-tactics-techniques-and-procedures-an-overview.pdf)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n- [Datadog threat roundup: top insights for Q4 2024](https://securitylabs.datadoghq.com/articles/2024-q4-threat-roundup/)\n**Related Research:**\n- [Following attackers\u2019 (Cloud)trail in AWS: Methodology and findings in the wild](https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1862233966,
                        "definition": {
                            "title": "ListUsers",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListUsers $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2008125643,
                        "definition": {
                            "type": "note",
                            "content": "### [ListAttachedUserPolicies](https://traildiscover.cloud/#IAM-ListAttachedUserPolicies)\n\n**Description:** Lists all managed policies that are attached to the specified IAM user.\n\n**Related Incidents:**\n- [Datadog threat roundup: top insights for Q4 2024](https://securitylabs.datadoghq.com/articles/2024-q4-threat-roundup/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 32187709,
                        "definition": {
                            "title": "ListAttachedUserPolicies",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListAttachedUserPolicies $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1296933734,
                        "definition": {
                            "type": "note",
                            "content": "### [ListRoles](https://traildiscover.cloud/#IAM-ListRoles)\n\n**Description:** Lists the IAM roles that have the specified path prefix. \n\n**Related Incidents:**\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n**Related Research:**\n- [AWS - IAM Enum](https://cloud.hacktricks.xyz/pentesting-cloud/aws-security/aws-services/aws-iam-enum)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1369140561,
                        "definition": {
                            "title": "ListRoles",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListRoles $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3380109560,
                        "definition": {
                            "type": "note",
                            "content": "### [ListSAMLProviders](https://traildiscover.cloud/#IAM-ListSAMLProviders)\n\n**Description:** Lists the SAML provider resource objects defined in IAM in the account.\n\n**Related Incidents:**\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3452316387,
                        "definition": {
                            "title": "ListSAMLProviders",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListSAMLProviders $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1469957349,
                        "definition": {
                            "type": "note",
                            "content": "### [GetUser](https://traildiscover.cloud/#IAM-GetUser)\n\n**Description:** Retrieves information about the specified IAM user, including the user's creation date, path, unique ID, and ARN.\n\n**Related Incidents:**\n- [GotRoot! AWS root Account Takeover](https://medium.com/@gchib/naturesbasket-aws-root-account-takeover-e4aa5c5e95e1)\n- [Tales from the cloud trenches: Raiding for AWS vaults, buckets and secrets](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-raiding-for-vaults-buckets-secrets/)\n- [Datadog threat roundup: top insights for Q4 2024](https://securitylabs.datadoghq.com/articles/2024-q4-threat-roundup/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1542164176,
                        "definition": {
                            "title": "GetUser",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetUser $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1731992539,
                        "definition": {
                            "type": "note",
                            "content": "### [ListAttachedRolePolicies](https://traildiscover.cloud/#IAM-ListAttachedRolePolicies)\n\n**Description:** Lists all managed policies that are attached to the specified IAM role.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4051021901,
                        "definition": {
                            "title": "ListAttachedRolePolicies",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListAttachedRolePolicies $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3690087192,
                        "definition": {
                            "type": "note",
                            "content": "### [ListServiceSpecificCredentials](https://traildiscover.cloud/#IAM-ListServiceSpecificCredentials)\n\n**Description:** Returns information about the service-specific credentials associated with the specified IAM user.\n\n**Related Incidents:**\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3762294019,
                        "definition": {
                            "title": "ListServiceSpecificCredentials",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListServiceSpecificCredentials $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1854702775,
                        "definition": {
                            "type": "note",
                            "content": "### [ListRolePolicies](https://traildiscover.cloud/#IAM-ListRolePolicies)\n\n**Description:** Lists the names of the inline policies that are embedded in the specified IAM role.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n- [Datadog threat roundup: top insights for Q4 2024](https://securitylabs.datadoghq.com/articles/2024-q4-threat-roundup/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1926909602,
                        "definition": {
                            "title": "ListRolePolicies",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListRolePolicies $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3987143642,
                        "definition": {
                            "type": "note",
                            "content": "### [ListSigningCertificates](https://traildiscover.cloud/#IAM-ListSigningCertificates)\n\n**Description:** Returns information about the signing certificates associated with the specified IAM user.\n\n**Related Incidents:**\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2011205708,
                        "definition": {
                            "title": "ListSigningCertificates",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListSigningCertificates $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 248081100,
                        "definition": {
                            "type": "note",
                            "content": "### [ListInstanceProfiles](https://traildiscover.cloud/#IAM-ListInstanceProfiles)\n\n**Description:** Lists the instance profiles that have the specified path prefix. If there are none, the operation returns an empty list.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 320287927,
                        "definition": {
                            "title": "ListInstanceProfiles",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListInstanceProfiles $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3078526204,
                        "definition": {
                            "type": "note",
                            "content": "### [ListSSHPublicKeys](https://traildiscover.cloud/#IAM-ListSSHPublicKeys)\n\n**Description:** Returns information about the SSH public keys associated with the specified IAM user.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1102588270,
                        "definition": {
                            "title": "ListSSHPublicKeys",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListSSHPublicKeys $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1028212350,
                        "definition": {
                            "type": "note",
                            "content": "### [ListOpenIDConnectProviders](https://traildiscover.cloud/#IAM-ListOpenIDConnectProviders)\n\n**Description:** Lists information about the IAM OpenID Connect (OIDC) provider resource objects defined in the AWS account.\n\n**Related Incidents:**\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3247902825,
                        "definition": {
                            "title": "ListOpenIDConnectProviders",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListOpenIDConnectProviders $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1726560942,
                        "definition": {
                            "type": "note",
                            "content": "### [GetLoginProfile](https://traildiscover.cloud/#IAM-GetLoginProfile)\n\n**Description:** Retrieves the user name for the specified IAM user.\n\n**Related Incidents:**\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3946251417,
                        "definition": {
                            "title": "GetLoginProfile",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetLoginProfile $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4022087461,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeLoadBalancers](https://traildiscover.cloud/#ELBv2-DescribeLoadBalancers)\n\n**Description:** Describes the specified load balancers or all of your load balancers.\n\n**Related Research:**\n- [Rigging the Rules: Manipulating AWS ALB to Mine Sensitive Data](https://medium.com/@adan.alvarez/rigging-the-rules-manipulating-aws-alb-to-mine-sensitive-data-20e33dbc4994)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 28,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4094294288,
                        "definition": {
                            "title": "DescribeLoadBalancers",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeLoadBalancers $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 28,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3076445180,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeListeners](https://traildiscover.cloud/#ELBv2-DescribeListeners)\n\n**Description:** Describes the specified listeners or the listeners for the specified Application Load Balancer, Network Load Balancer, or Gateway Load Balancer.\n\n**Related Research:**\n- [Rigging the Rules: Manipulating AWS ALB to Mine Sensitive Data](https://medium.com/@adan.alvarez/rigging-the-rules-manipulating-aws-alb-to-mine-sensitive-data-20e33dbc4994)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 28,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1100507246,
                        "definition": {
                            "title": "DescribeListeners",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeListeners $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 28,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2669975372,
                        "definition": {
                            "type": "note",
                            "content": "### [ListAssociatedAccessPolicies](https://traildiscover.cloud/#EKS-ListAssociatedAccessPolicies)\n\n**Description:** Lists the access policies associated with an access entry.\n\n**Related Research:**\n- [New attack vectors in EKS](https://www.wiz.io/blog/new-attack-vectors-emerge-via-recent-eks-access-entries-and-pod-identity-features)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 28,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2742182199,
                        "definition": {
                            "title": "ListAssociatedAccessPolicies",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListAssociatedAccessPolicies $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 28,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2640002668,
                        "definition": {
                            "type": "note",
                            "content": "### [ListClusters](https://traildiscover.cloud/#EKS-ListClusters)\n\n**Description:** Lists the Amazon EKS clusters in your AWS account in the specified AWS Region.\n\n**Related Research:**\n- [New attack vectors in EKS](https://www.wiz.io/blog/new-attack-vectors-emerge-via-recent-eks-access-entries-and-pod-identity-features)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 30,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 664064734,
                        "definition": {
                            "title": "ListClusters",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListClusters $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 30,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2403458808,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeAccessEntry](https://traildiscover.cloud/#EKS-DescribeAccessEntry)\n\n**Description:** Describes an access entry.\n\n**Related Research:**\n- [New attack vectors in EKS](https://www.wiz.io/blog/new-attack-vectors-emerge-via-recent-eks-access-entries-and-pod-identity-features)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 30,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 427520874,
                        "definition": {
                            "title": "DescribeAccessEntry",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeAccessEntry $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 30,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3823427200,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeCluster](https://traildiscover.cloud/#EKS-DescribeCluster)\n\n**Description:** Describes an Amazon EKS cluster.\n\n**Related Research:**\n- [New attack vectors in EKS](https://www.wiz.io/blog/new-attack-vectors-emerge-via-recent-eks-access-entries-and-pod-identity-features)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 30,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1847489266,
                        "definition": {
                            "title": "DescribeCluster",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeCluster $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 30,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2080142750,
                        "definition": {
                            "type": "note",
                            "content": "### [Search](https://traildiscover.cloud/#ResourceExplorer-Search)\n\n**Description:** Searches for resources and displays details about all resources that match the specified criteria.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 32,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 104204816,
                        "definition": {
                            "title": "Search",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:Search $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 32,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2979624101,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeKey](https://traildiscover.cloud/#KMS-DescribeKey)\n\n**Description:** Provides detailed information about a KMS key.\n\n**Related Research:**\n- [Encrypting buckets for compliance and ransom - How Attackers Can Use KMS to Ransomware S3 Buckets](https://blog.pepperclipp.com/pepperclipp-public/encrypting-buckets-for-compliance-and-ransom-how-attackers-can-use-kms-to-ransomware-s3-buckets)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 32,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3051830928,
                        "definition": {
                            "title": "DescribeKey",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeKey $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 32,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1203131404,
                        "definition": {
                            "type": "note",
                            "content": "### [LookupEvents](https://traildiscover.cloud/#CloudTrail-LookupEvents)\n\n**Description:** Looks up management events or CloudTrail Insights events that are captured by CloudTrail.\n\n**Related Incidents:**\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 32,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3522160766,
                        "definition": {
                            "title": "LookupEvents",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:LookupEvents $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 32,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1287795414,
                        "definition": {
                            "type": "note",
                            "content": "### [GetIntrospectionSchema](https://traildiscover.cloud/#AppSync-GetIntrospectionSchema)\n\n**Description:** Retrieves the introspection schema for a GraphQL API.\n\n**Related Research:**\n- [Distorting the Sync: How AWS AppSync Can Be Turned into an Attacker\u2019s Backdoor](https://medium.com/@adan.alvarez/distorting-the-sync-how-aws-appsync-can-be-turned-into-an-attackers-backdoor-8c015b8e52b8)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 34,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3606824776,
                        "definition": {
                            "title": "GetIntrospectionSchema",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetIntrospectionSchema $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 34,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2501955941,
                        "definition": {
                            "type": "note",
                            "content": "### [GetBucketVersioning](https://traildiscover.cloud/#S3-GetBucketVersioning)\n\n**Description:** Returns the versioning state of a bucket.\n\n**Related Incidents:**\n- [Ransomware in the cloud](https://www.invictus-ir.com/news/ransomware-in-the-cloud)\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 34,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 526018007,
                        "definition": {
                            "title": "GetBucketVersioning",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetBucketVersioning $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 34,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4208600881,
                        "definition": {
                            "type": "note",
                            "content": "### [GetBucketAccelerateConfiguration](https://traildiscover.cloud/#S3-GetBucketAccelerateConfiguration)\n\n**Description:** This implementation of the GET action uses the accelerate subresource to return the Transfer Acceleration state of a bucket, which is either Enabled or Suspended.\n\n**Related Incidents:**\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 34,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4280807708,
                        "definition": {
                            "title": "GetBucketAccelerateConfiguration",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetBucketAccelerateConfiguration $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 34,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1182667737,
                        "definition": {
                            "type": "note",
                            "content": "### [GetBucketLogging](https://traildiscover.cloud/#S3-GetBucketLogging)\n\n**Description:** Returns the logging status of a bucket and the permissions users have to view and modify that status.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 36,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3501697099,
                        "definition": {
                            "title": "GetBucketLogging",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetBucketLogging $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 36,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 810126779,
                        "definition": {
                            "type": "note",
                            "content": "### [GetObjectLockConfiguration](https://traildiscover.cloud/#S3-GetObjectLockConfiguration)\n\n**Description:** Gets the Object Lock configuration for a bucket.\n\n**Related Incidents:**\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 36,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 882333606,
                        "definition": {
                            "title": "GetObjectLockConfiguration",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetObjectLockConfiguration $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 36,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2501496091,
                        "definition": {
                            "type": "note",
                            "content": "### [GetBucketPolicy](https://traildiscover.cloud/#S3-GetBucketPolicy)\n\n**Description:** Returns the policy of a specified bucket.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 36,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2573702918,
                        "definition": {
                            "title": "GetBucketPolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetBucketPolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 36,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2036457423,
                        "definition": {
                            "type": "note",
                            "content": "### [GetBucketOwnershipControls](https://traildiscover.cloud/#S3-GetBucketOwnershipControls)\n\n**Description:** Retrieves OwnershipControls for an Amazon S3 bucket.\n\n**Related Incidents:**\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 38,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2108664250,
                        "definition": {
                            "title": "GetBucketOwnershipControls",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetBucketOwnershipControls $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 38,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 731067300,
                        "definition": {
                            "type": "note",
                            "content": "### [ListBuckets](https://traildiscover.cloud/#S3-ListBuckets)\n\n**Description:** Returns a list of all buckets owned by the authenticated sender of the request.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Ransomware in the cloud](https://www.invictus-ir.com/news/ransomware-in-the-cloud)\n- [ANATOMY OF AN ATTACK: EXPOSED KEYS TO CRYPTO MINING](https://permiso.io/blog/s/anatomy-of-attack-exposed-keys-to-crypto-mining/)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n- [A Technical Analysis of the Capital One Cloud Misconfiguration Breach](https://www.fugue.co/blog/a-technical-analysis-of-the-capital-one-cloud-misconfiguration-breach)\n- [Enumerate AWS Account ID from a Public S3 Bucket](https://hackingthe.cloud/aws/enumeration/account_id_from_s3_bucket/)\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n- [Tales from the cloud trenches: Raiding for AWS vaults, buckets and secrets](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-raiding-for-vaults-buckets-secrets/)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n- [Securing a SaaS Company's AWS Environment After a Breach](https://badshah.io/case-studies/saas-aws-breach/)\n**Related Research:**\n- [Following attackers\u2019 (Cloud)trail in AWS: Methodology and findings in the wild](https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 38,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3050096662,
                        "definition": {
                            "title": "ListBuckets",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListBuckets $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 38,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 102591892,
                        "definition": {
                            "type": "note",
                            "content": "### [GetBucketReplication](https://traildiscover.cloud/#S3-GetBucketReplication)\n\n**Description:** Returns the replication configuration of a bucket.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 38,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 174798719,
                        "definition": {
                            "title": "GetBucketReplication",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetBucketReplication $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 38,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2249674978,
                        "definition": {
                            "type": "note",
                            "content": "### [GetBucketLocation](https://traildiscover.cloud/#S3-GetBucketLocation)\n\n**Description:** Returns the Region the bucket resides in.\n\n**Related Incidents:**\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 40,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 273737044,
                        "definition": {
                            "title": "GetBucketLocation",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetBucketLocation $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 40,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3977065931,
                        "definition": {
                            "type": "note",
                            "content": "### [GetBucketAcl](https://traildiscover.cloud/#S3-GetBucketAcl)\n\n**Description:** This implementation of the GET action uses the acl subresource to return the access control list (ACL) of a bucket.\n\n**Related Incidents:**\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n**Related Research:**\n- [Public S3 bucket through bucket ACL](https://securitylabs.datadoghq.com/cloud-security-atlas/vulnerabilities/s3-bucket-public-acl/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 40,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2001127997,
                        "definition": {
                            "title": "GetBucketAcl",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetBucketAcl $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 40,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 373857681,
                        "definition": {
                            "type": "note",
                            "content": "### [HeadObject](https://traildiscover.cloud/#S3-HeadObject)\n\n**Description:** The HEAD operation retrieves metadata from an object without returning the object itself.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 40,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2593548156,
                        "definition": {
                            "title": "HeadObject",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:HeadObject $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 40,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3676920643,
                        "definition": {
                            "type": "note",
                            "content": "### [ListVaults](https://traildiscover.cloud/#S3-ListVaults)\n\n**Description:** This operation lists all vaults owned by the calling user\u2019s account.\n\n**Related Incidents:**\n- [Detecting AI resource-hijacking with Composite Alerts](https://www.lacework.com/blog/detecting-ai-resource-hijacking-with-composite-alerts)\n- [Tales from the cloud trenches: Raiding for AWS vaults, buckets and secrets](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-raiding-for-vaults-buckets-secrets/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 42,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1700982709,
                        "definition": {
                            "title": "ListVaults",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListVaults $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 42,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4220622651,
                        "definition": {
                            "type": "note",
                            "content": "### [GetBucketLifecycle](https://traildiscover.cloud/#S3-GetBucketLifecycle)\n\n**Description:** Returns the lifecycle configuration information set on the bucket.\n\n**Related Incidents:**\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 42,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2244684717,
                        "definition": {
                            "title": "GetBucketLifecycle",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetBucketLifecycle $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 42,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 138492075,
                        "definition": {
                            "type": "note",
                            "content": "### [GetPublicAccessBlock](https://traildiscover.cloud/#S3-GetPublicAccessBlock)\n\n**Description:** Retrieves the PublicAccessBlock configuration for an Amazon S3 bucket.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 42,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 210698902,
                        "definition": {
                            "title": "GetPublicAccessBlock",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetPublicAccessBlock $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 42,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 487276287,
                        "definition": {
                            "type": "note",
                            "content": "### [GetBucketTagging](https://traildiscover.cloud/#S3-GetBucketTagging)\n\n**Description:** Returns the tag set associated with the bucket.\n\n**Related Incidents:**\n- [Cloud Security Stories: From Risky Permissions to Ransomware Execution](https://sonraisecurity.com/blog/cloud-security-stories-from-risky-permissions-to-ransomware-execution/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 44,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2806305649,
                        "definition": {
                            "title": "GetBucketTagging",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetBucketTagging $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 44,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3426997,
                        "definition": {
                            "type": "note",
                            "content": "### [GetBucketRequestPayment](https://traildiscover.cloud/#S3-GetBucketRequestPayment)\n\n**Description:** Returns the request payment configuration of a bucket.\n\n**Related Incidents:**\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 44,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2322456359,
                        "definition": {
                            "title": "GetBucketRequestPayment",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetBucketRequestPayment $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 44,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3109044291,
                        "definition": {
                            "type": "note",
                            "content": "### [ListObjects](https://traildiscover.cloud/#S3-ListObjects)\n\n**Description:** Returns some or all (up to 1,000) of the objects in a bucket.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [Cloud Security Stories: From Risky Permissions to Ransomware Execution](https://sonraisecurity.com/blog/cloud-security-stories-from-risky-permissions-to-ransomware-execution/)\n- [Tales from the cloud trenches: Raiding for AWS vaults, buckets and secrets](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-raiding-for-vaults-buckets-secrets/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 44,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1033767470,
                        "definition": {
                            "title": "ListObjects",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListObjects $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 44,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3266665885,
                        "definition": {
                            "type": "note",
                            "content": "### [InvokeModel](https://traildiscover.cloud/#Bedrock-InvokeModel)\n\n**Description:** Invokes the specified Amazon Bedrock model to run inference using the prompt and inference parameters provided in the request body.\n\n**Related Incidents:**\n- [LLMjacking: Stolen Cloud Credentials Used in New AI Attack](https://sysdig.com/blog/llmjacking-stolen-cloud-credentials-used-in-new-ai-attack/)\n- [Detecting AI resource-hijacking with Composite Alerts](https://www.lacework.com/blog/detecting-ai-resource-hijacking-with-composite-alerts)\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n- [When AI Gets Hijacked: Exploiting Hosted Models for Dark Roleplaying](https://permiso.io/blog/exploiting-hosted-models)\n- [New Developments in LLM Hijacking Activity](https://www.wiz.io/blog/jinx-2401-llm-hijacking-aws)\n- [Datadog threat roundup: top insights for Q4 2024](https://securitylabs.datadoghq.com/articles/2024-q4-threat-roundup/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 46,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3338872712,
                        "definition": {
                            "title": "InvokeModel",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:InvokeModel $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 46,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4106314271,
                        "definition": {
                            "type": "note",
                            "content": "### [GetUseCaseForModelAccess](https://traildiscover.cloud/#Bedrock-GetUseCaseForModelAccess)\n\n**Description:** Grants permission to retrieve a use case for model access.\n\n**Related Incidents:**\n- [Detecting AI resource-hijacking with Composite Alerts](https://www.lacework.com/blog/detecting-ai-resource-hijacking-with-composite-alerts)\n- [When AI Gets Hijacked: Exploiting Hosted Models for Dark Roleplaying](https://permiso.io/blog/exploiting-hosted-models)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 46,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2130376337,
                        "definition": {
                            "title": "GetUseCaseForModelAccess",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetUseCaseForModelAccess $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 46,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 728052724,
                        "definition": {
                            "type": "note",
                            "content": "### [ListProvisionedModelThroughputs](https://traildiscover.cloud/#Bedrock-ListProvisionedModelThroughputs)\n\n**Description:** Grants permission to list provisioned model throughputs that you created earlier.\n\n**Related Incidents:**\n- [Detecting AI resource-hijacking with Composite Alerts](https://www.lacework.com/blog/detecting-ai-resource-hijacking-with-composite-alerts)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 46,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 800259551,
                        "definition": {
                            "title": "ListProvisionedModelThroughputs",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListProvisionedModelThroughputs $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 46,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4258987383,
                        "definition": {
                            "type": "note",
                            "content": "### [GetFoundationModelAvailability](https://traildiscover.cloud/#Bedrock-GetFoundationModelAvailability)\n\n**Description:** Grants permission to get the availability of a foundation model.\n\n**Related Incidents:**\n- [Detecting AI resource-hijacking with Composite Alerts](https://www.lacework.com/blog/detecting-ai-resource-hijacking-with-composite-alerts)\n- [When AI Gets Hijacked: Exploiting Hosted Models for Dark Roleplaying](https://permiso.io/blog/exploiting-hosted-models)\n- [Datadog threat roundup: top insights for Q4 2024](https://securitylabs.datadoghq.com/articles/2024-q4-threat-roundup/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 48,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2283049449,
                        "definition": {
                            "title": "GetFoundationModelAvailability",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetFoundationModelAvailability $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 48,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1508835753,
                        "definition": {
                            "type": "note",
                            "content": "### [ListFoundationModels](https://traildiscover.cloud/#Bedrock-ListFoundationModels)\n\n**Description:** Grants permission to list Bedrock foundation models that you can use.\n\n**Related Incidents:**\n- [Detecting AI resource-hijacking with Composite Alerts](https://www.lacework.com/blog/detecting-ai-resource-hijacking-with-composite-alerts)\n- [Datadog threat roundup: top insights for Q4 2024](https://securitylabs.datadoghq.com/articles/2024-q4-threat-roundup/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 48,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1581042580,
                        "definition": {
                            "title": "ListFoundationModels",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListFoundationModels $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 48,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 422380069,
                        "definition": {
                            "type": "note",
                            "content": "### [ListFoundationModelAgreementOffers](https://traildiscover.cloud/#Bedrock-ListFoundationModelAgreementOffers)\n\n**Description:** Grants permission to get a list of foundation model agreement offers.\n\n**Related Incidents:**\n- [Detecting AI resource-hijacking with Composite Alerts](https://www.lacework.com/blog/detecting-ai-resource-hijacking-with-composite-alerts)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 48,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 593925783,
                        "definition": {
                            "title": "ListFoundationModelAgreementOffers",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListFoundationModelAgreementOffers $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 48,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1544391637,
                        "definition": {
                            "type": "note",
                            "content": "### [GetModelInvocationLoggingConfiguration](https://traildiscover.cloud/#Bedrock-GetModelInvocationLoggingConfiguration)\n\n**Description:** Get the current configuration values for model invocation logging.\n\n**Related Incidents:**\n- [LLMjacking: Stolen Cloud Credentials Used in New AI Attack](https://sysdig.com/blog/llmjacking-stolen-cloud-credentials-used-in-new-ai-attack/)\n- [New Developments in LLM Hijacking Activity](https://www.wiz.io/blog/jinx-2401-llm-hijacking-aws)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 50,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3863420999,
                        "definition": {
                            "title": "GetModelInvocationLoggingConfiguration",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetModelInvocationLoggingConfiguration $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 50,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 251053637,
                        "definition": {
                            "type": "note",
                            "content": "### [GetConsoleScreenshot](https://traildiscover.cloud/#EC2-GetConsoleScreenshot)\n\n**Description:** Retrieve a JPG-format screenshot of a running instance to help with troubleshooting.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 50,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2570082999,
                        "definition": {
                            "title": "GetConsoleScreenshot",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetConsoleScreenshot $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 50,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 220835910,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeSnapshotTierStatus](https://traildiscover.cloud/#EC2-DescribeSnapshotTierStatus)\n\n**Description:** Describes the storage tier status of one or more Amazon EBS snapshots.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 50,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 392381624,
                        "definition": {
                            "title": "DescribeSnapshotTierStatus",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeSnapshotTierStatus $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 50,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1229617130,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeImages](https://traildiscover.cloud/#EC2-DescribeImages)\n\n**Description:** Describes the specified images (AMIs, AKIs, and ARIs) available to you or all of the images available to you.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 52,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3548646492,
                        "definition": {
                            "title": "DescribeImages",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeImages $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 52,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 957930978,
                        "definition": {
                            "type": "note",
                            "content": "### [GetEbsDefaultKmsKeyId](https://traildiscover.cloud/#EC2-GetEbsDefaultKmsKeyId)\n\n**Description:** Describes the default AWS KMS key for EBS encryption by default for your account in this Region.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 52,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3276960340,
                        "definition": {
                            "title": "GetEbsDefaultKmsKeyId",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetEbsDefaultKmsKeyId $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 52,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1699475396,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeAvailabilityZones](https://traildiscover.cloud/#EC2-DescribeAvailabilityZones)\n\n**Description:** Describes the Availability Zones, Local Zones, and Wavelength Zones that are available to you.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 52,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3919165871,
                        "definition": {
                            "title": "DescribeAvailabilityZones",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeAvailabilityZones $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 52,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 251260858,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeInstances](https://traildiscover.cloud/#EC2-DescribeInstances)\n\n**Description:** Describes the specified instances or all instances.\n\n**Related Incidents:**\n- [Following attackers\u2019 (Cloud)trail in AWS: Methodology and findings in the wild](https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/)\n**Related Research:**\n- [Abusing VPC Traffic Mirroring in AWS](https://rhinosecuritylabs.com/aws/abusing-vpc-traffic-mirroring-in-aws/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 54,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 323467685,
                        "definition": {
                            "title": "DescribeInstances",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeInstances $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 54,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1904276058,
                        "definition": {
                            "type": "note",
                            "content": "### [GetTransitGatewayRouteTableAssociations](https://traildiscover.cloud/#EC2-GetTransitGatewayRouteTableAssociations)\n\n**Description:** Gets information about the associations for the specified transit gateway route table.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 54,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4223305420,
                        "definition": {
                            "title": "GetTransitGatewayRouteTableAssociations",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetTransitGatewayRouteTableAssociations $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 54,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 82555296,
                        "definition": {
                            "type": "note",
                            "content": "### [GetLaunchTemplateData](https://traildiscover.cloud/#EC2-GetLaunchTemplateData)\n\n**Description:** Retrieves the configuration data of the specified instance. You can use this data to create a launch template.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 54,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 154762123,
                        "definition": {
                            "title": "GetLaunchTemplateData",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetLaunchTemplateData $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 54,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 16562165,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeKeyPairs](https://traildiscover.cloud/#EC2-DescribeKeyPairs)\n\n**Description:** Describes the specified key pairs or all of your key pairs.\n\n**Related Incidents:**\n- [Behind the scenes in the Expel SOC: Alert-to-fix in AWS](https://expel.com/blog/behind-the-scenes-expel-soc-alert-aws/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 56,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 88768992,
                        "definition": {
                            "title": "DescribeKeyPairs",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeKeyPairs $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 56,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 535596393,
                        "definition": {
                            "type": "note",
                            "content": "### [GetEbsEncryptionByDefault](https://traildiscover.cloud/#EC2-GetEbsEncryptionByDefault)\n\n**Description:** Describes whether EBS encryption by default is enabled for your account in the current Region.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 56,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2854625755,
                        "definition": {
                            "title": "GetEbsEncryptionByDefault",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetEbsEncryptionByDefault $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 56,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3561967540,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeCarrierGateways](https://traildiscover.cloud/#EC2-DescribeCarrierGateways)\n\n**Description:** Describes one or more of your carrier gateways.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 56,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1586029606,
                        "definition": {
                            "title": "DescribeCarrierGateways",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeCarrierGateways $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 56,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4263176771,
                        "definition": {
                            "type": "note",
                            "content": "### [GetFlowLogsIntegrationTemplate](https://traildiscover.cloud/#EC2-GetFlowLogsIntegrationTemplate)\n\n**Description:** Generates a CloudFormation template that streamlines and automates the integration of VPC flow logs with Amazon Athena.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 58,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2287238837,
                        "definition": {
                            "title": "GetFlowLogsIntegrationTemplate",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetFlowLogsIntegrationTemplate $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 58,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3820818019,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeTransitGatewayMulticastDomains](https://traildiscover.cloud/#EC2-DescribeTransitGatewayMulticastDomains)\n\n**Description:** Describes one or more transit gateway multicast domains.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 58,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3893024846,
                        "definition": {
                            "title": "DescribeTransitGatewayMulticastDomains",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeTransitGatewayMulticastDomains $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 58,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1677695051,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeInstanceAttribute](https://traildiscover.cloud/#EC2-DescribeInstanceAttribute)\n\n**Description:** Describes the specified attribute of the specified instance. You can specify only one attribute at a time.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 58,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3996724413,
                        "definition": {
                            "title": "DescribeInstanceAttribute",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeInstanceAttribute $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 58,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 768152454,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeDhcpOptions](https://traildiscover.cloud/#EC2-DescribeDhcpOptions)\n\n**Description:** Describes one or more of your DHCP options sets.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 60,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 939698168,
                        "definition": {
                            "title": "DescribeDhcpOptions",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeDhcpOptions $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 60,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 267435171,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeVpcEndpointConnectionNotifications](https://traildiscover.cloud/#EC2-DescribeVpcEndpointConnectionNotifications)\n\n**Description:** Describes the connection notifications for VPC endpoints and VPC endpoint services.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 60,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 339641998,
                        "definition": {
                            "title": "DescribeVpcEndpointConnectionNotifications",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeVpcEndpointConnectionNotifications $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 60,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1984069389,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeFlowLogs](https://traildiscover.cloud/#EC2-DescribeFlowLogs)\n\n**Description:** Describes one or more flow logs.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 60,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2056276216,
                        "definition": {
                            "title": "DescribeFlowLogs",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeFlowLogs $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 60,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2780504770,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeSnapshotAttribute](https://traildiscover.cloud/#EC2-DescribeSnapshotAttribute)\n\n**Description:** Describes the specified attribute of the specified snapshot.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 62,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2852711597,
                        "definition": {
                            "title": "DescribeSnapshotAttribute",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeSnapshotAttribute $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 62,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3880865481,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeVolumesModifications](https://traildiscover.cloud/#EC2-DescribeVolumesModifications)\n\n**Description:** Describes the most recent volume modification request for the specified EBS volumes.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 62,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1904927547,
                        "definition": {
                            "title": "DescribeVolumesModifications",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeVolumesModifications $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 62,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3387837849,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeRegions](https://traildiscover.cloud/#EC2-DescribeRegions)\n\n**Description:** Describes the Regions that are enabled for your account, or all Regions.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n**Related Research:**\n- [Following attackers\u2019 (Cloud)trail in AWS: Methodology and findings in the wild](https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 62,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1411899915,
                        "definition": {
                            "title": "DescribeRegions",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeRegions $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 62,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2533529369,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeSecurityGroups](https://traildiscover.cloud/#EC2-DescribeSecurityGroups)\n\n**Description:** Describes the specified security groups or all of your security groups.\n\n**Related Incidents:**\n- [Case Study: Responding to an Attack in AWS](https://www.cadosecurity.com/case-study-responding-to-an-attack-in-aws/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 64,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2605736196,
                        "definition": {
                            "title": "DescribeSecurityGroups",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeSecurityGroups $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 64,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2074304126,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeVpcs](https://traildiscover.cloud/#EC2-DescribeVpcs)\n\n**Description:** Describes one or more of your VPCs.\n\n**Related Incidents:**\n- [Following attackers\u2019 (Cloud)trail in AWS: Methodology and findings in the wild](https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 64,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2146510953,
                        "definition": {
                            "title": "DescribeVpcs",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeVpcs $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 64,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1188349369,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeBundleTasks](https://traildiscover.cloud/#EC2-DescribeBundleTasks)\n\n**Description:** Describes the specified bundle tasks or all of your bundle tasks.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 64,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1260556196,
                        "definition": {
                            "title": "DescribeBundleTasks",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeBundleTasks $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 64,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3455157476,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeAccountAttributes](https://traildiscover.cloud/#EC2-DescribeAccountAttributes)\n\n**Description:** Describes attributes of your AWS account.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 66,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1479219542,
                        "definition": {
                            "title": "DescribeAccountAttributes",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeAccountAttributes $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 66,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1222328876,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeVolumes](https://traildiscover.cloud/#EC2-DescribeVolumes)\n\n**Description:** Describes the specified EBS volumes or all of your EBS volumes.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 66,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1294535703,
                        "definition": {
                            "title": "DescribeVolumes",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeVolumes $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 66,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1049315704,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeInstanceTypes](https://traildiscover.cloud/#EC2-DescribeInstanceTypes)\n\n**Description:** Describes the details of the instance types that are offered in a location.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 66,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1121522531,
                        "definition": {
                            "title": "DescribeInstanceTypes",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeInstanceTypes $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 66,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 848768863,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeClientVpnRoutes](https://traildiscover.cloud/#EC2-DescribeClientVpnRoutes)\n\n**Description:** Describes the routes for the specified Client VPN endpoint.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 68,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3167798225,
                        "definition": {
                            "title": "DescribeClientVpnRoutes",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeClientVpnRoutes $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 68,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 82555296,
                        "definition": {
                            "type": "note",
                            "content": "### [GetLaunchTemplateData](https://traildiscover.cloud/#EC2-GetLaunchTemplateData)\n\n**Description:** Retrieves the configuration data of the specified instance. You can use this data to create a launch template.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 68,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 154762123,
                        "definition": {
                            "title": "GetLaunchTemplateData",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetLaunchTemplateData $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 68,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3322955765,
                        "definition": {
                            "type": "note",
                            "content": "### [GetParameters](https://traildiscover.cloud/#SSM-GetParameters)\n\n**Description:** Get information about one or more parameters by specifying multiple parameter names.\n\n**Related Research:**\n- [Detecting and removing risky actions out of your IAM security policies](https://www.solvo.cloud/blog/detecting-and-removing-risky-actions-out-of-your-iam-security-policies/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 68,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1347017831,
                        "definition": {
                            "title": "GetParameters",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetParameters $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 68,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3469185677,
                        "definition": {
                            "type": "note",
                            "content": "### [DescribeInstanceInformation](https://traildiscover.cloud/#SSM-DescribeInstanceInformation)\n\n**Description:** Provides information about one or more of your managed nodes, including the operating system platform, SSM Agent version, association status, and IP address.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 70,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1493247743,
                        "definition": {
                            "title": "DescribeInstanceInformation",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DescribeInstanceInformation $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 70,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1361217679,
                        "definition": {
                            "type": "note",
                            "content": "### [ListEmailIdentities](https://traildiscover.cloud/#SES-ListEmailIdentities)\n\n**Description:** Returns a list of all of the email identities that are associated with your AWS account.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: Unwanted visitor](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-unwanted-visitor/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 70,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3680247041,
                        "definition": {
                            "title": "ListEmailIdentities",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListEmailIdentities $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 70,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1680115490,
                        "definition": {
                            "type": "note",
                            "content": "### [GetIdentityVerificationAttributes](https://traildiscover.cloud/#SES-GetIdentityVerificationAttributes)\n\n**Description:** Given a list of identities (email addresses and/or domains), returns the verification status and (for domain identities) the verification token for each identity.\n\n**Related Incidents:**\n- [SES-PIONAGE](https://permiso.io/blog/s/aws-ses-pionage-detecting-ses-abuse/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 70,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1752322317,
                        "definition": {
                            "title": "GetIdentityVerificationAttributes",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetIdentityVerificationAttributes $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 70,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3520352326,
                        "definition": {
                            "type": "note",
                            "content": "### [GetAccountSendingEnabled](https://traildiscover.cloud/#SES-GetAccountSendingEnabled)\n\n**Description:** Returns the email sending status of the Amazon SES account for the current Region.\n\n**Related Incidents:**\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n**Related Research:**\n- [SES-PIONAGE](https://permiso.io/blog/s/aws-ses-pionage-detecting-ses-abuse/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 72,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3691898040,
                        "definition": {
                            "title": "GetAccountSendingEnabled",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetAccountSendingEnabled $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 72,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2243736792,
                        "definition": {
                            "type": "note",
                            "content": "### [ListIdentities](https://traildiscover.cloud/#SES-ListIdentities)\n\n**Description:** Returns a list containing all of the identities (email addresses and domains) for your AWS account in the current AWS Region, regardless of verification status.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Ransomware in the cloud](https://www.invictus-ir.com/news/ransomware-in-the-cloud)\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n- [SES-PIONAGE](https://permiso.io/blog/s/aws-ses-pionage-detecting-ses-abuse/)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n**Related Research:**\n- [Following attackers\u2019 (Cloud)trail in AWS: Methodology and findings in the wild](https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 72,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2415282506,
                        "definition": {
                            "title": "ListIdentities",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListIdentities $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 72,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 824479475,
                        "definition": {
                            "type": "note",
                            "content": "### [GetSendQuota](https://traildiscover.cloud/#SES-GetSendQuota)\n\n**Description:** Provides the sending limits for the Amazon SES account.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Ransomware in the cloud](https://www.invictus-ir.com/news/ransomware-in-the-cloud)\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [SES-PIONAGE](https://permiso.io/blog/s/aws-ses-pionage-detecting-ses-abuse/)\n- [Tales from the cloud trenches: Unwanted visitor](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-unwanted-visitor/)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n**Related Research:**\n- [Following attackers\u2019 (Cloud)trail in AWS: Methodology and findings in the wild](https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 72,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3143508837,
                        "definition": {
                            "title": "GetSendQuota",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetSendQuota $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 72,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2326492287,
                        "definition": {
                            "type": "note",
                            "content": "### [GetAccount](https://traildiscover.cloud/#SES-GetAccount)\n\n**Description:** Obtain information about the email-sending status and capabilities of your Amazon SES account in the current AWS Region.\n\n**Related Incidents:**\n- [Ransomware in the cloud](https://www.invictus-ir.com/news/ransomware-in-the-cloud)\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n- [SES-PIONAGE](https://permiso.io/blog/s/aws-ses-pionage-detecting-ses-abuse/)\n- [Tales from the cloud trenches: Unwanted visitor](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-unwanted-visitor/)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n**Related Research:**\n- [Following attackers\u2019 (Cloud)trail in AWS: Methodology and findings in the wild](https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 74,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 350554353,
                        "definition": {
                            "title": "GetAccount",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetAccount $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 74,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4027182171,
                        "definition": {
                            "type": "note",
                            "content": "### [GetFindings](https://traildiscover.cloud/#GuardDuty-GetFindings)\n\n**Description:** Returns a list of findings that match the specified criteria.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 74,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2051244237,
                        "definition": {
                            "title": "GetFindings",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetFindings $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 74,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3053407042,
                        "definition": {
                            "type": "note",
                            "content": "### [ListFindings](https://traildiscover.cloud/#GuardDuty-ListFindings)\n\n**Description:** Lists GuardDuty findings for the specified detector ID.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 74,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3125613869,
                        "definition": {
                            "title": "ListFindings",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListFindings $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 74,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3266086241,
                        "definition": {
                            "type": "note",
                            "content": "### [ListDetectors](https://traildiscover.cloud/#GuardDuty-ListDetectors)\n\n**Description:** Lists detectorIds of all the existing Amazon GuardDuty detector resources.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n**Related Research:**\n- [Modify GuardDuty Configuration](https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 76,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1290148307,
                        "definition": {
                            "title": "ListDetectors",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListDetectors $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 76,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 66822332,
                        "definition": {
                            "type": "note",
                            "content": "### [GetDetector](https://traildiscover.cloud/#GuardDuty-GetDetector)\n\n**Description:** Retrieves an Amazon GuardDuty detector specified by the detectorId.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 76,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2385851694,
                        "definition": {
                            "title": "GetDetector",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetDetector $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 76,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3214871229,
                        "definition": {
                            "type": "note",
                            "content": "### [ListIPSets](https://traildiscover.cloud/#GuardDuty-ListIPSets)\n\n**Description:** Lists the IPSets of the GuardDuty service specified by the detector ID.\n\n**Related Research:**\n- [Modify GuardDuty Configuration](https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 76,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1238933295,
                        "definition": {
                            "title": "ListIPSets",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListIPSets $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 76,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2658353801,
                        "definition": {
                            "type": "note",
                            "content": "### [ListServiceQuotas](https://traildiscover.cloud/#ServiceQuotas-ListServiceQuotas)\n\n**Description:** Lists the applied quota values for the specified AWS service.\n\n**Related Incidents:**\n- [Ransomware in the cloud](https://www.invictus-ir.com/news/ransomware-in-the-cloud)\n- [SES-PIONAGE](https://permiso.io/blog/s/aws-ses-pionage-detecting-ses-abuse/)\n**Related Research:**\n- [Following attackers\u2019 (Cloud)trail in AWS: Methodology and findings in the wild](https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 78,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2829899515,
                        "definition": {
                            "title": "ListServiceQuotas",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ListServiceQuotas $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 78,
                            "width": 2,
                            "height": 2
                        }
                    }
                ]
            },
            "layout": {
                "x": 0,
                "y": 123,
                "width": 12,
                "height": 82
            }
        },
        {
            "id": 965900792,
            "definition": {
                "type": "group",
                "layout_type": "ordered",
                "background_color": "blue",
                "title": "TA0008 - Lateral Movement",
                "show_title": true,
                "widgets": [
                    {
                        "id": 763763691,
                        "definition": {
                            "type": "note",
                            "content": "### [AssumeRoleWithWebIdentity](https://traildiscover.cloud/#STS-AssumeRoleWithWebIdentity)\n\n**Description:** Returns a set of temporary security credentials for users who have been authenticated in a mobile or web application with a web identity provider.\n\n**Related Research:**\n- [From GitHub To Account Takeover: Misconfigured Actions Place GCP & AWS Accounts At Risk](https://www.rezonate.io/blog/github-misconfigurations-put-gcp-aws-in-account-takeover-risk/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 935309405,
                        "definition": {
                            "title": "AssumeRoleWithWebIdentity",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AssumeRoleWithWebIdentity $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 591382920,
                        "definition": {
                            "type": "note",
                            "content": "### [SwitchRole](https://traildiscover.cloud/#SignIn-SwitchRole)\n\n**Description:** This event is recorded when a user manually switches to a different IAM role within the AWS Management Console.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: Unwanted visitor](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-unwanted-visitor/)\n**Related Research:**\n- [AWS CloudTrail cheat sheet](https://www.invictus-ir.com/news/aws-cloudtrail-cheat-sheet)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2910412282,
                        "definition": {
                            "title": "SwitchRole",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:SwitchRole $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2456170334,
                        "definition": {
                            "type": "note",
                            "content": "### [EnableSerialConsoleAccess](https://traildiscover.cloud/#EC2-EnableSerialConsoleAccess)\n\n**Description:** Enables access to the EC2 serial console of all instances for your account.\n\n**Related Incidents:**\n- [LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD](https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud)\n**Related Research:**\n- [How to detect EC2 Serial Console enabled](https://sysdig.com/blog/ec2-serial-console-enabled/)\n- [Attack Paths Into VMs in the Cloud](https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 480232400,
                        "definition": {
                            "title": "EnableSerialConsoleAccess",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:EnableSerialConsoleAccess $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 400816971,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateVolume](https://traildiscover.cloud/#EC2-CreateVolume)\n\n**Description:** Creates an EBS volume that can be attached to an instance in the same Availability Zone.\n\n**Related Incidents:**\n- [Navigating the Cloud: Exploring Lateral Movement Techniques](https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2719846333,
                        "definition": {
                            "title": "CreateVolume",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateVolume $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2013949635,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateSecurityGroup](https://traildiscover.cloud/#EC2-CreateSecurityGroup)\n\n**Description:** Creates a security group.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [Behind the scenes in the Expel SOC: Alert-to-fix in AWS](https://expel.com/blog/behind-the-scenes-expel-soc-alert-aws/)\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n- [ANATOMY OF AN ATTACK: EXPOSED KEYS TO CRYPTO MINING](https://permiso.io/blog/s/anatomy-of-attack-exposed-keys-to-crypto-mining/)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n**Related Research:**\n- [Following attackers\u2019 (Cloud)trail in AWS: Methodology and findings in the wild](https://securitylabs.datadoghq.com/articles/following-attackers-trail-in-aws-methodology-findings-in-the-wild/)\n- [Abusing VPC Traffic Mirroring in AWS](https://rhinosecuritylabs.com/aws/abusing-vpc-traffic-mirroring-in-aws/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 38011701,
                        "definition": {
                            "title": "CreateSecurityGroup",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateSecurityGroup $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2292343336,
                        "definition": {
                            "type": "note",
                            "content": "### [AuthorizeSecurityGroupIngress](https://traildiscover.cloud/#EC2-AuthorizeSecurityGroupIngress)\n\n**Description:** Adds the specified inbound (ingress) rules to a security group.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Finding evil in AWS](https://expel.com/blog/finding-evil-in-aws/)\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [Behind the scenes in the Expel SOC: Alert-to-fix in AWS](https://expel.com/blog/behind-the-scenes-expel-soc-alert-aws/)\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n- [BrowserStack analysis: unpatched inactive machine compromised by shellshock vulnerability](https://www.databreaches.net/browserstack-analysis-unpatched-inactive-machine-compromised-by-shellshock-vulnerability/)\n- [Navigating the Cloud: Exploring Lateral Movement Techniques](https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/)\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n**Related Research:**\n- [Opening a security group to the Internet](https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/opening-security-group-port/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 316405402,
                        "definition": {
                            "title": "AuthorizeSecurityGroupIngress",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AuthorizeSecurityGroupIngress $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3220147166,
                        "definition": {
                            "type": "note",
                            "content": "### [SendSSHPublicKey](https://traildiscover.cloud/#EC2InstanceConnect-SendSSHPublicKey)\n\n**Description:** Pushes an SSH public key to the specified EC2 instance for use by the specified user.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [Navigating the Cloud: Exploring Lateral Movement Techniques](https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/)\n- [Cloud-Conscious Tactics, Techniques,and Procedures (TTPs)](https://fwdcloudsec.org/assets/presentations/2024/europe/sebastian-walla-cloud-conscious-tactics-techniques-and-procedures-an-overview.pdf)\n**Related Research:**\n- [Attack Paths Into VMs in the Cloud](https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1244209232,
                        "definition": {
                            "title": "SendSSHPublicKey",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:SendSSHPublicKey $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1917349655,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateSnapshot](https://traildiscover.cloud/#EC2-CreateSnapshot)\n\n**Description:** Creates a snapshot of an EBS volume and stores it in Amazon S3.\n\n**Related Incidents:**\n- [CrowdStrike\u2019s work with the Democratic National Committee: Setting the record straight](https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/)\n- [Navigating the Cloud: Exploring Lateral Movement Techniques](https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/)\n**Related Research:**\n- [Stealing an EBS snapshot by creating a snapshot and sharing it](https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/sharing-ebs-snapshot/)\n- [Exfiltrate EBS Snapshot by Sharing It](https://stratus-red-team.cloud/attack-techniques/AWS/aws.exfiltration.ec2-share-ebs-snapshot/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2088895369,
                        "definition": {
                            "title": "CreateSnapshot",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateSnapshot $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1511695692,
                        "definition": {
                            "type": "note",
                            "content": "### [RunInstances](https://traildiscover.cloud/#EC2-RunInstances)\n\n**Description:** Launches the specified number of instances using an AMI for which you have permissions.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [DXC spills AWS private keys on public GitHub](https://www.theregister.com/2017/11/14/dxc_github_aws_keys_leaked/)\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [Behind the scenes in the Expel SOC: Alert-to-fix in AWS](https://expel.com/blog/behind-the-scenes-expel-soc-alert-aws/)\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n- [SCARLETEEL 2.0: Fargate, Kubernetes, and Crypto](https://sysdig.com/blog/scarleteel-2-0/)\n- [ANATOMY OF AN ATTACK: EXPOSED KEYS TO CRYPTO MINING](https://permiso.io/blog/s/anatomy-of-attack-exposed-keys-to-crypto-mining/)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n- [Clear and Uncommon Story About Overcoming Issues With AWS](https://urancompany.com/blog/clear-and-uncommon-story-about-overcoming-issues-aws)\n- [onelogin 2017 Security Incident](https://web.archive.org/web/20210620180614/https://www.onelogin.com/blog/may-31-2017-security-incident)\n- [BrowserStack analysis: unpatched inactive machine compromised by shellshock vulnerability](https://www.databreaches.net/browserstack-analysis-unpatched-inactive-machine-compromised-by-shellshock-vulnerability/)\n- [Navigating the Cloud: Exploring Lateral Movement Techniques](https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/)\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n**Related Research:**\n- [Launching EC2 instances](https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/launching-ec2-instances/)\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n- [Abusing VPC Traffic Mirroring in AWS](https://rhinosecuritylabs.com/aws/abusing-vpc-traffic-mirroring-in-aws/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3830725054,
                        "definition": {
                            "title": "RunInstances",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:RunInstances $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2809142653,
                        "definition": {
                            "type": "note",
                            "content": "### [AttachVolume](https://traildiscover.cloud/#EC2-AttachVolume)\n\n**Description:** Attaches an EBS volume to a running or stopped instance and exposes it to the instance with the specified device name.\n\n**Related Incidents:**\n- [Navigating the Cloud: Exploring Lateral Movement Techniques](https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2980688367,
                        "definition": {
                            "title": "AttachVolume",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AttachVolume $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1207581869,
                        "definition": {
                            "type": "note",
                            "content": "### [SendSerialConsoleSSHPublicKey](https://traildiscover.cloud/#EC2InstanceConnect-SendSerialConsoleSSHPublicKey)\n\n**Description:** Pushes an SSH public key to the specified EC2 instance.\n\n**Related Incidents:**\n- [LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD](https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud)\n- [Navigating the Cloud: Exploring Lateral Movement Techniques](https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/)\n- [Cloud-Conscious Tactics, Techniques,and Procedures (TTPs)](https://fwdcloudsec.org/assets/presentations/2024/europe/sebastian-walla-cloud-conscious-tactics-techniques-and-procedures-an-overview.pdf)\n**Related Research:**\n- [Attack Paths Into VMs in the Cloud](https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1279788696,
                        "definition": {
                            "title": "SendSerialConsoleSSHPublicKey",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:SendSerialConsoleSSHPublicKey $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1285792295,
                        "definition": {
                            "type": "note",
                            "content": "### [ModifyDBInstance](https://traildiscover.cloud/#RDS-ModifyDBInstance)\n\n**Description:** Modifies settings for a DB instance.\n\n**Related Incidents:**\n- [Securing a SaaS Company's AWS Environment After a Breach](https://badshah.io/case-studies/saas-aws-breach/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3604821657,
                        "definition": {
                            "title": "ModifyDBInstance",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ModifyDBInstance $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 41873971,
                        "definition": {
                            "type": "note",
                            "content": "### [SendCommand](https://traildiscover.cloud/#SSM-SendCommand)\n\n**Description:** Runs commands on one or more managed nodes.\n\n**Related Incidents:**\n- [Navigating the Cloud: Exploring Lateral Movement Techniques](https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/)\n- [Cloud-Conscious Tactics, Techniques,and Procedures (TTPs)](https://fwdcloudsec.org/assets/presentations/2024/europe/sebastian-walla-cloud-conscious-tactics-techniques-and-procedures-an-overview.pdf)\n**Related Research:**\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [Run Shell Commands on EC2 with Send Command or Session Manager](https://hackingthe.cloud/aws/post_exploitation/run_shell_commands_on_ec2/)\n- [Attack Paths Into VMs in the Cloud](https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2360903333,
                        "definition": {
                            "title": "SendCommand",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:SendCommand $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 660010138,
                        "definition": {
                            "type": "note",
                            "content": "### [StartSession](https://traildiscover.cloud/#SSM-StartSession)\n\n**Description:** Initiates a connection to a target (for example, a managed node) for a Session Manager session.\n\n**Related Incidents:**\n- [Navigating the Cloud: Exploring Lateral Movement Techniques](https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/)\n**Related Research:**\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [Run Shell Commands on EC2 with Send Command or Session Manager](https://hackingthe.cloud/aws/post_exploitation/run_shell_commands_on_ec2/)\n- [Attack Paths Into VMs in the Cloud](https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 732216965,
                        "definition": {
                            "title": "StartSession",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:StartSession $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 570900234,
                        "definition": {
                            "type": "note",
                            "content": "### [ResumeSession](https://traildiscover.cloud/#SSM-ResumeSession)\n\n**Description:** Reconnects a session to a managed node after it has been disconnected.\n\n**Related Research:**\n- [Attack Paths Into VMs in the Cloud](https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 643107061,
                        "definition": {
                            "title": "ResumeSession",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ResumeSession $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    }
                ]
            },
            "layout": {
                "x": 0,
                "y": 205,
                "width": 12,
                "height": 12
            }
        },
        {
            "id": 1594793995,
            "definition": {
                "type": "group",
                "layout_type": "ordered",
                "background_color": "blue",
                "title": "TA0009 - Collection",
                "show_title": true,
                "widgets": [
                    {
                        "id": 3412044878,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateFunctionCode20150331v2](https://traildiscover.cloud/#Lambda-UpdateFunctionCode20150331v2)\n\n**Description:** Updates a Lambda function's code. If code signing is enabled for the function, the code package must be signed by a trusted publisher.\n\n**Related Research:**\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n- [Enhancing Your Security Visibility and DetectionResponse Operations in AWS](https://pages.awscloud.com/rs/112-TZM-766/images/Visibility_detect_respond_AWS_SANS_whitepaper.pdf)\n- [How Attackers Can Misuse AWS CloudFront Access to Make It \u2018Rain\u2019 Cookies](https://medium.com/@adan.alvarez/how-attackers-can-misuse-aws-cloudfront-access-to-make-it-rain-cookies-acf9ce87541c)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1436106944,
                        "definition": {
                            "title": "UpdateFunctionCode20150331v2",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateFunctionCode20150331v2 $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1769895163,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateDistribution](https://traildiscover.cloud/#CloudFront-UpdateDistribution)\n\n**Description:** Updates the configuration for a CloudFront distribution.\n\n**Related Research:**\n- [How Attackers Can Misuse AWS CloudFront Access to Make It \u2018Rain\u2019 Cookies](https://medium.com/@adan.alvarez/how-attackers-can-misuse-aws-cloudfront-access-to-make-it-rain-cookies-acf9ce87541c)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4088924525,
                        "definition": {
                            "title": "UpdateDistribution",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateDistribution $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2811782112,
                        "definition": {
                            "type": "note",
                            "content": "### [PublishFunction](https://traildiscover.cloud/#CloudFront-PublishFunction)\n\n**Description:** Publishes a CloudFront function by copying the function code from the DEVELOPMENT stage to LIVE.\n\n**Related Research:**\n- [How Attackers Can Misuse AWS CloudFront Access to Make It \u2018Rain\u2019 Cookies](https://medium.com/@adan.alvarez/how-attackers-can-misuse-aws-cloudfront-access-to-make-it-rain-cookies-acf9ce87541c)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2983327826,
                        "definition": {
                            "title": "PublishFunction",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PublishFunction $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 226082595,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateFunction](https://traildiscover.cloud/#CloudFront-CreateFunction)\n\n**Description:** Creates a CloudFront function.\n\n**Related Research:**\n- [How Attackers Can Misuse AWS CloudFront Access to Make It \u2018Rain\u2019 Cookies](https://medium.com/@adan.alvarez/how-attackers-can-misuse-aws-cloudfront-access-to-make-it-rain-cookies-acf9ce87541c)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2545111957,
                        "definition": {
                            "title": "CreateFunction",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateFunction $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2832000887,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateInstanceExportTask](https://traildiscover.cloud/#EC2-CreateInstanceExportTask)\n\n**Description:** Exports a running or stopped instance to an Amazon S3 bucket.\n\n**Related Research:**\n- [AWS EC2 VM Export Failure](https://www.elastic.co/guide/en/security/current/aws-ec2-vm-export-failure.html)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 856062953,
                        "definition": {
                            "title": "CreateInstanceExportTask",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateInstanceExportTask $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1681684716,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateTrafficMirrorTarget](https://traildiscover.cloud/#EC2-CreateTrafficMirrorTarget)\n\n**Description:** Creates a target for your Traffic Mirror session.\n\n**Related Research:**\n- [Abusing VPC Traffic Mirroring in AWS](https://rhinosecuritylabs.com/aws/abusing-vpc-traffic-mirroring-in-aws/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1853230430,
                        "definition": {
                            "title": "CreateTrafficMirrorTarget",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateTrafficMirrorTarget $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1122566722,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateTrafficMirrorSession](https://traildiscover.cloud/#EC2-CreateTrafficMirrorSession)\n\n**Description:** Creates a Traffic Mirror session.\n\n**Related Research:**\n- [Abusing VPC Traffic Mirroring in AWS](https://rhinosecuritylabs.com/aws/abusing-vpc-traffic-mirroring-in-aws/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3342257197,
                        "definition": {
                            "title": "CreateTrafficMirrorSession",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateTrafficMirrorSession $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1832748166,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateRoute](https://traildiscover.cloud/#EC2-CreateRoute)\n\n**Description:** Creates a route in a route table within a VPC.\n\n**Related Research:**\n- [Ensure CloudWatch has an Alarm for Route Table Changes](https://www.intelligentdiscovery.io/controls/cloudwatch/cloudwatch-alarm-route-table-change)\n- [AWS Incident Response](https://easttimor.github.io/aws-incident-response/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1904954993,
                        "definition": {
                            "title": "CreateRoute",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateRoute $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3924499684,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateTrafficMirrorFilter](https://traildiscover.cloud/#EC2-CreateTrafficMirrorFilter)\n\n**Description:** Creates a Traffic Mirror filter.\n\n**Related Research:**\n- [Abusing VPC Traffic Mirroring in AWS](https://rhinosecuritylabs.com/aws/abusing-vpc-traffic-mirroring-in-aws/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3996706511,
                        "definition": {
                            "title": "CreateTrafficMirrorFilter",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateTrafficMirrorFilter $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 408302415,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateTrafficMirrorFilterRule](https://traildiscover.cloud/#EC2-CreateTrafficMirrorFilterRule)\n\n**Description:** Creates a Traffic Mirror filter rule.\n\n**Related Research:**\n- [Abusing VPC Traffic Mirroring in AWS](https://rhinosecuritylabs.com/aws/abusing-vpc-traffic-mirroring-in-aws/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2627992890,
                        "definition": {
                            "title": "CreateTrafficMirrorFilterRule",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateTrafficMirrorFilterRule $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    }
                ]
            },
            "layout": {
                "x": 0,
                "y": 217,
                "width": 12,
                "height": 10
            }
        },
        {
            "id": 807710805,
            "definition": {
                "type": "group",
                "layout_type": "ordered",
                "background_color": "blue",
                "title": "TA0010 - Exfiltration",
                "show_title": true,
                "widgets": [
                    {
                        "id": 2740912246,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateUser](https://traildiscover.cloud/#TransferFamily-CreateUser)\n\n**Description:** Creates a user and associates them with an existing file transfer protocol-enabled server.\n\n**Related Incidents:**\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 764974312,
                        "definition": {
                            "title": "CreateUser",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateUser $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2753611101,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateServer](https://traildiscover.cloud/#TransferFamily-CreateServer)\n\n**Description:** Instantiates an auto-scaling virtual server based on the selected file transfer protocol in AWS.\n\n**Related Incidents:**\n- [Muddled Libra\u2019s Evolution to the Cloud](https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 777673167,
                        "definition": {
                            "title": "CreateServer",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateServer $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 452440322,
                        "definition": {
                            "type": "note",
                            "content": "### [PutBucketPolicy](https://traildiscover.cloud/#S3-PutBucketPolicy)\n\n**Description:** Applies an Amazon S3 bucket policy to an Amazon S3 bucket.\n\n**Related Research:**\n- [Detecting and removing risky actions out of your IAM security policies](https://www.solvo.cloud/blog/detecting-and-removing-risky-actions-out-of-your-iam-security-policies/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 623986036,
                        "definition": {
                            "title": "PutBucketPolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutBucketPolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3671732729,
                        "definition": {
                            "type": "note",
                            "content": "### [PutBucketAcl](https://traildiscover.cloud/#S3-PutBucketAcl)\n\n**Description:** Sets the permissions on an existing bucket using access control lists (ACL).\n\n**Related Research:**\n- [AWS S3 Bucket ACL made public](https://docs.datadoghq.com/security/default_rules/aws-bucket-acl-made-public/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1695794795,
                        "definition": {
                            "title": "PutBucketAcl",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutBucketAcl $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2532144043,
                        "definition": {
                            "type": "note",
                            "content": "### [PutBucketVersioning](https://traildiscover.cloud/#S3-PutBucketVersioning)\n\n**Description:** Sets the versioning state of an existing bucket.\n\n**Related Incidents:**\n- [Ransomware in the cloud](https://www.invictus-ir.com/news/ransomware-in-the-cloud)\n**Related Research:**\n- [Exfiltrating S3 Data with Bucket Replication Policies](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2604350870,
                        "definition": {
                            "title": "PutBucketVersioning",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutBucketVersioning $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4205232693,
                        "definition": {
                            "type": "note",
                            "content": "### [PutBucketReplication](https://traildiscover.cloud/#S3-PutBucketReplication)\n\n**Description:** Creates a replication configuration or replaces an existing one.\n\n**Related Research:**\n- [Exfiltrating S3 Data with Bucket Replication Policies](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2229294759,
                        "definition": {
                            "title": "PutBucketReplication",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutBucketReplication $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 582360698,
                        "definition": {
                            "type": "note",
                            "content": "### [GetObject](https://traildiscover.cloud/#S3-GetObject)\n\n**Description:** Retrieves an object from Amazon S3.\n\n**Related Incidents:**\n- [Ransomware in the cloud](https://www.invictus-ir.com/news/ransomware-in-the-cloud)\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [Incident 2 - Additional details of the attack](https://support.lastpass.com/s/document-item?language=en_US&bundleId=lastpass&topicId=LastPass/incident-2-details.html&_LANG=enus)\n- [Aruba Central Security Incident](https://www.arubanetworks.com/support-services/security-bulletins/central-incident-faq/)\n- [Sendtech Pte. Ltd](https://www.pdpc.gov.sg/-/media/Files/PDPC/PDF-Files/Commissions-Decisions/Decision---Sendtech-Pte-Ltd---220721.ashx?la=en)\n- [GotRoot! AWS root Account Takeover](https://medium.com/@gchib/naturesbasket-aws-root-account-takeover-e4aa5c5e95e1)\n- [A Technical Analysis of the Capital One Cloud Misconfiguration Breach](https://www.fugue.co/blog/a-technical-analysis-of-the-capital-one-cloud-misconfiguration-breach)\n- [Chegg, Inc](https://www.ftc.gov/system/files/ftc_gov/pdf/2023151-Chegg-Complaint.pdf)\n- [Scattered Spider Attack Analysis](https://www.reliaquest.com/blog/scattered-spider-attack-analysis-account-compromise/)\n- [Enumerate AWS Account ID from a Public S3 Bucket](https://hackingthe.cloud/aws/enumeration/account_id_from_s3_bucket/)\n- [Cloud Security Stories: From Risky Permissions to Ransomware Execution](https://sonraisecurity.com/blog/cloud-security-stories-from-risky-permissions-to-ransomware-execution/)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n- [Securing a SaaS Company's AWS Environment After a Breach](https://badshah.io/case-studies/saas-aws-breach/)\n- [Top employee monitoring app leaks 21 million screenshots on thousands of users](https://www.techradar.com/pro/security/top-employee-monitoring-app-leaks-21-million-screenshots-on-thousands-of-users)\n**Related Research:**\n- [Data Exfiltration through S3 Server Access Logs](https://hackingthe.cloud/aws/exploitation/s3_server_access_logs/)\n- [S3 Streaming Copy](https://hackingthe.cloud/aws/exploitation/s3_streaming_copy/)\n- [Encrypting buckets for compliance and ransom - How Attackers Can Use KMS to Ransomware S3 Buckets](https://blog.pepperclipp.com/pepperclipp-public/encrypting-buckets-for-compliance-and-ransom-how-attackers-can-use-kms-to-ransomware-s3-buckets)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 753906412,
                        "definition": {
                            "title": "GetObject",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GetObject $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 667271465,
                        "definition": {
                            "type": "note",
                            "content": "### [JobCreated](https://traildiscover.cloud/#S3-JobCreated)\n\n**Description:** When a Batch Operations job is created, it is recorded as a JobCreated event in CloudTrail.\n\n**Related Research:**\n- [Exfiltrating S3 Data with Bucket Replication Policies](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 739478292,
                        "definition": {
                            "title": "JobCreated",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:JobCreated $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1509989343,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateInstanceExportTask](https://traildiscover.cloud/#EC2-CreateInstanceExportTask)\n\n**Description:** Exports a running or stopped instance to an Amazon S3 bucket.\n\n**Related Research:**\n- [AWS EC2 VM Export Failure](https://www.elastic.co/guide/en/security/current/aws-ec2-vm-export-failure.html)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3829018705,
                        "definition": {
                            "title": "CreateInstanceExportTask",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateInstanceExportTask $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3883291104,
                        "definition": {
                            "type": "note",
                            "content": "### [ModifySnapshotAttribute](https://traildiscover.cloud/#EC2-ModifySnapshotAttribute)\n\n**Description:** Adds or removes permission settings for the specified snapshot.\n\n**Related Incidents:**\n- [CrowdStrike\u2019s work with the Democratic National Committee: Setting the record straight](https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4054836818,
                        "definition": {
                            "title": "ModifySnapshotAttribute",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ModifySnapshotAttribute $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 611979339,
                        "definition": {
                            "type": "note",
                            "content": "### [SharedSnapshotCopyInitiated](https://traildiscover.cloud/#EC2-SharedSnapshotCopyInitiated)\n\n**Description:** Modifies the specified attribute of the specified instance.\n\n**Related Incidents:**\n- [M-Trends Report - 2020](https://www.mandiant.com/sites/default/files/2021-09/mtrends-2020.pdf)\n- [Democratic National Committee hack](https://www.politico.com/f/?id=00000168-6161-de11-af7d-ef7327ea0000)\n**Related Research:**\n- [Detecting exfiltration of EBS snapshots in AWS](https://twitter.com/christophetd/status/1574681313218506753)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 783525053,
                        "definition": {
                            "title": "SharedSnapshotCopyInitiated",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:SharedSnapshotCopyInitiated $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2960303021,
                        "definition": {
                            "type": "note",
                            "content": "### [SharedSnapshotVolumeCreated](https://traildiscover.cloud/#EC2-SharedSnapshotVolumeCreated)\n\n**Description:** Modifies the specified attribute of the specified instance.\n\n**Related Incidents:**\n- [M-Trends Report - 2020](https://www.mandiant.com/sites/default/files/2021-09/mtrends-2020.pdf)\n- [Democratic National Committee hack](https://www.politico.com/f/?id=00000168-6161-de11-af7d-ef7327ea0000)\n**Related Research:**\n- [Detecting exfiltration of EBS snapshots in AWS](https://twitter.com/christophetd/status/1574681313218506753)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 885026200,
                        "definition": {
                            "title": "SharedSnapshotVolumeCreated",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:SharedSnapshotVolumeCreated $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 722766212,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateSnapshot](https://traildiscover.cloud/#EC2-CreateSnapshot)\n\n**Description:** Creates a snapshot of an EBS volume and stores it in Amazon S3.\n\n**Related Incidents:**\n- [CrowdStrike\u2019s work with the Democratic National Committee: Setting the record straight](https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/)\n- [Navigating the Cloud: Exploring Lateral Movement Techniques](https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/)\n**Related Research:**\n- [Stealing an EBS snapshot by creating a snapshot and sharing it](https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/sharing-ebs-snapshot/)\n- [Exfiltrate EBS Snapshot by Sharing It](https://stratus-red-team.cloud/attack-techniques/AWS/aws.exfiltration.ec2-share-ebs-snapshot/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3041795574,
                        "definition": {
                            "title": "CreateSnapshot",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateSnapshot $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3142546902,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateImage](https://traildiscover.cloud/#EC2-CreateImage)\n\n**Description:** Creates an Amazon EBS-backed AMI from an Amazon EBS-backed instance that is either running or stopped.\n\n**Related Incidents:**\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1166608968,
                        "definition": {
                            "title": "CreateImage",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateImage $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1488164709,
                        "definition": {
                            "type": "note",
                            "content": "### [AuthorizeSecurityGroupEgress](https://traildiscover.cloud/#EC2-AuthorizeSecurityGroupEgress)\n\n**Description:** Adds the specified outbound (egress) rules to a security group.\n\n**Related Incidents:**\n- [Trouble in Paradise](https://blog.darklab.hk/2021/07/06/trouble-in-paradise/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3807194071,
                        "definition": {
                            "title": "AuthorizeSecurityGroupEgress",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:AuthorizeSecurityGroupEgress $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 784732426,
                        "definition": {
                            "type": "note",
                            "content": "### [ModifyImageAttribute](https://traildiscover.cloud/#EC2-ModifyImageAttribute)\n\n**Description:** Modifies the specified attribute of the specified AMI.\n\n**Related Research:**\n- [AWS AMI Atttribute Modification for Exfiltration](https://research.splunk.com/cloud/f2132d74-cf81-4c5e-8799-ab069e67dc9f/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3103761788,
                        "definition": {
                            "title": "ModifyImageAttribute",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ModifyImageAttribute $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2256143052,
                        "definition": {
                            "type": "note",
                            "content": "### [ModifyDBSnapshotAttribute](https://traildiscover.cloud/#RDS-ModifyDBSnapshotAttribute)\n\n**Description:** Adds an attribute and values to, or removes an attribute and values from, a manual DB snapshot.\n\n**Related Incidents:**\n- [Imperva Security Update](https://www.imperva.com/blog/ceoblog/)\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n**Related Research:**\n- [Stealing an RDS database by creating a snapshot and sharing it](https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/sharing-rds-snapshot/)\n- [Hunting AWS RDS security events with Sysdig](https://sysdig.com/blog/aws-rds-security-events-sysdig/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2328349879,
                        "definition": {
                            "title": "ModifyDBSnapshotAttribute",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ModifyDBSnapshotAttribute $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2243531325,
                        "definition": {
                            "type": "note",
                            "content": "### [StartExportTask](https://traildiscover.cloud/#RDS-StartExportTask)\n\n**Description:** Starts an export of DB snapshot or DB cluster data to Amazon S3.\n\n**Related Research:**\n- [AWS - RDS Post Exploitation](https://cloud.hacktricks.xyz/pentesting-cloud/aws-security/aws-post-exploitation/aws-rds-post-exploitation)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 267593391,
                        "definition": {
                            "title": "StartExportTask",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:StartExportTask $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 104069396,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateDBSecurityGroup](https://traildiscover.cloud/#RDS-CreateDBSecurityGroup)\n\n**Description:** Creates a new DB security group. DB security groups control access to a DB instance.\n\n**Related Research:**\n- [Enhancing Your Security Visibility and DetectionResponse Operations in AWS](https://pages.awscloud.com/rs/112-TZM-766/images/Visibility_detect_respond_AWS_SANS_whitepaper.pdf)\n- [Hunting AWS RDS security events with Sysdig](https://sysdig.com/blog/aws-rds-security-events-sysdig/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2423098758,
                        "definition": {
                            "title": "CreateDBSecurityGroup",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateDBSecurityGroup $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4220039833,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateDBSnapshot](https://traildiscover.cloud/#RDS-CreateDBSnapshot)\n\n**Description:** Creates a snapshot of a DB instance.\n\n**Related Incidents:**\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n**Related Research:**\n- [Stealing an RDS database by creating a snapshot and sharing it](https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/sharing-rds-snapshot/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4292246660,
                        "definition": {
                            "title": "CreateDBSnapshot",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateDBSnapshot $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    }
                ]
            },
            "layout": {
                "x": 0,
                "y": 227,
                "width": 12,
                "height": 16
            }
        },
        {
            "id": 1141837258,
            "definition": {
                "type": "group",
                "layout_type": "ordered",
                "background_color": "blue",
                "title": "TA0040 - Impact",
                "show_title": true,
                "widgets": [
                    {
                        "id": 3762289639,
                        "definition": {
                            "type": "note",
                            "content": "### [ChangeResourceRecordSets](https://traildiscover.cloud/#Route53-ChangeResourceRecordSets)\n\n**Description:** Creates, changes, or deletes a resource record set, which contains authoritative DNS information for a specified domain name or subdomain name.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n**Related Research:**\n- [AWS API Call Hijacking via ACM-PCA](https://hackingthe.cloud/aws/exploitation/route53_modification_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1786351705,
                        "definition": {
                            "title": "ChangeResourceRecordSets",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ChangeResourceRecordSets $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 8280475,
                        "definition": {
                            "type": "note",
                            "content": "### [RegisterDomain](https://traildiscover.cloud/#route53domains-RegisterDomain)\n\n**Description:** This operation registers a domain. For some top-level domains (TLDs), this operation requires extra parameters.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 80487302,
                        "definition": {
                            "title": "RegisterDomain",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:RegisterDomain $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1044143932,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateHostedZone](https://traildiscover.cloud/#Route53-CreateHostedZone)\n\n**Description:** Creates a new public or private hosted zone. You create records in a public hosted zone to define how you want to route traffic on the internet for a domain, such as example.com, and its subdomains.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n**Related Research:**\n- [AWS API Call Hijacking via ACM-PCA](https://hackingthe.cloud/aws/exploitation/route53_modification_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3363173294,
                        "definition": {
                            "title": "CreateHostedZone",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateHostedZone $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 0,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1569677539,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateStack](https://traildiscover.cloud/#CloudFormation-CreateStack)\n\n**Description:** Creates a stack as specified in the template.\n\n**Related Incidents:**\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3888706901,
                        "definition": {
                            "title": "CreateStack",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateStack $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 407538668,
                        "definition": {
                            "type": "note",
                            "content": "### [Publish](https://traildiscover.cloud/#SNS-Publish)\n\n**Description:** Sends a message to an Amazon SNS topic, a text message (SMS message) directly to a phone number, or a message to a mobile platform endpoint (when you specify the TargetArn).\n\n**Related Incidents:**\n- [Tales from the cloud trenches: Using malicious AWS activity to spot phishing campaigns](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-aws-activity-to-phishing/)\n- [Cloud Security Stories: From Risky Permissions to Ransomware Execution](https://sonraisecurity.com/blog/cloud-security-stories-from-risky-permissions-to-ransomware-execution/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 579084382,
                        "definition": {
                            "title": "Publish",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:Publish $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3279093928,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateFunction20150331](https://traildiscover.cloud/#Lambda-CreateFunction20150331)\n\n**Description:** Creates a Lambda function.\n\n**Related Incidents:**\n- [Mining Crypto](https://twitter.com/jonnyplatt/status/1471453527390277638)\n- [Cloud Security Stories: From Risky Permissions to Ransomware Execution](https://sonraisecurity.com/blog/cloud-security-stories-from-risky-permissions-to-ransomware-execution/)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n- [Tales from the cloud trenches: The Attacker doth persist too much, methinks](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/)\n**Related Research:**\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3351300755,
                        "definition": {
                            "title": "CreateFunction20150331",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateFunction20150331 $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 2,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4100303276,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateFunctionCode20150331v2](https://traildiscover.cloud/#Lambda-UpdateFunctionCode20150331v2)\n\n**Description:** Updates a Lambda function's code. If code signing is enabled for the function, the code package must be signed by a trusted publisher.\n\n**Related Research:**\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n- [Enhancing Your Security Visibility and DetectionResponse Operations in AWS](https://pages.awscloud.com/rs/112-TZM-766/images/Visibility_detect_respond_AWS_SANS_whitepaper.pdf)\n- [How Attackers Can Misuse AWS CloudFront Access to Make It \u2018Rain\u2019 Cookies](https://medium.com/@adan.alvarez/how-attackers-can-misuse-aws-cloudfront-access-to-make-it-rain-cookies-acf9ce87541c)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2124365342,
                        "definition": {
                            "title": "UpdateFunctionCode20150331v2",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateFunctionCode20150331v2 $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2972092847,
                        "definition": {
                            "type": "note",
                            "content": "### [Invoke](https://traildiscover.cloud/#Lambda-Invoke)\n\n**Description:** Invokes a Lambda function.\n\n**Related Incidents:**\n- [Mining Crypto](https://twitter.com/jonnyplatt/status/1471453527390277638)\n- [Cloud Security Stories: From Risky Permissions to Ransomware Execution](https://sonraisecurity.com/blog/cloud-security-stories-from-risky-permissions-to-ransomware-execution/)\n**Related Research:**\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3143638561,
                        "definition": {
                            "title": "Invoke",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:Invoke $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2169204818,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteFileSystem](https://traildiscover.cloud/#elasticfilesystem-DeleteFileSystem)\n\n**Description:** Deletes a file system, permanently severing access to its contents.\n\n**Related Research:**\n- [AWS EFS File System or Mount Deleted](https://www.elastic.co/guide/en/security/7.17/aws-efs-file-system-or-mount-deleted.html)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 193266884,
                        "definition": {
                            "title": "DeleteFileSystem",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteFileSystem $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 4,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 224115253,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteMountTarget](https://traildiscover.cloud/#elasticfilesystem-DeleteMountTarget)\n\n**Description:** Deletes the specified mount target.\n\n**Related Research:**\n- [AWS EFS File System or Mount Deleted](https://www.elastic.co/guide/en/security/7.17/aws-efs-file-system-or-mount-deleted.html)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2543144615,
                        "definition": {
                            "title": "DeleteMountTarget",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteMountTarget $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2879184054,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteRule](https://traildiscover.cloud/#events-DeleteRule)\n\n**Description:** Deletes the specified rule.\n\n**Related Research:**\n- [AWS EventBridge Rule Disabled or Deleted](https://www.elastic.co/guide/en/security/7.17/rules-api-delete.html)\n- [AWS EventBridge rule disabled or deleted](https://docs.datadoghq.com/security/default_rules/aws-eventbridge-rule-disabled-or-deleted/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 903246120,
                        "definition": {
                            "title": "DeleteRule",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteRule $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 846350371,
                        "definition": {
                            "type": "note",
                            "content": "### [RemoveTargets](https://traildiscover.cloud/#events-RemoveTargets)\n\n**Description:** Removes the specified targets from the specified rule.\n\n**Related Research:**\n- [Modify GuardDuty Configuration](https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3165379733,
                        "definition": {
                            "title": "RemoveTargets",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:RemoveTargets $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 6,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 288903156,
                        "definition": {
                            "type": "note",
                            "content": "### [DisableRule](https://traildiscover.cloud/#events-DisableRule)\n\n**Description:** Disables the specified rule.\n\n**Related Research:**\n- [AWS EventBridge Rule Disabled or Deleted](https://www.elastic.co/guide/en/security/7.17/rules-api-delete.html)\n- [AWS EventBridge rule disabled or deleted](https://docs.datadoghq.com/security/default_rules/aws-eventbridge-rule-disabled-or-deleted/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2607932518,
                        "definition": {
                            "title": "DisableRule",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DisableRule $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3756207249,
                        "definition": {
                            "type": "note",
                            "content": "### [PutRule](https://traildiscover.cloud/#events-PutRule)\n\n**Description:** Creates or updates the specified rule.\n\n**Related Incidents:**\n- [Cloud Security Stories: From Risky Permissions to Ransomware Execution](https://sonraisecurity.com/blog/cloud-security-stories-from-risky-permissions-to-ransomware-execution/)\n**Related Research:**\n- [Modify GuardDuty Configuration](https://hackingthe.cloud/aws/avoiding-detection/modify-guardduty-config/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1780269315,
                        "definition": {
                            "title": "PutRule",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutRule $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4182383804,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateInstances](https://traildiscover.cloud/#Lightsail-CreateInstances)\n\n**Description:** Creates one or more Amazon Lightsail instances.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2206445870,
                        "definition": {
                            "title": "CreateInstances",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateInstances $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 8,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3346011564,
                        "definition": {
                            "type": "note",
                            "content": "### [GenerateDataKeyWithoutPlaintext](https://traildiscover.cloud/#KMS-GenerateDataKeyWithoutPlaintext)\n\n**Description:** Returns a unique symmetric data key for use outside of AWS KMS.\n\n**Related Incidents:**\n- [Cloud Security Stories: From Risky Permissions to Ransomware Execution](https://sonraisecurity.com/blog/cloud-security-stories-from-risky-permissions-to-ransomware-execution/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3418218391,
                        "definition": {
                            "title": "GenerateDataKeyWithoutPlaintext",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:GenerateDataKeyWithoutPlaintext $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1409732124,
                        "definition": {
                            "type": "note",
                            "content": "### [PutKeyPolicy](https://traildiscover.cloud/#KMS-PutKeyPolicy)\n\n**Description:** Attaches a key policy to the specified KMS key.\n\n**Related Research:**\n- [Encrypting buckets for compliance and ransom - How Attackers Can Use KMS to Ransomware S3 Buckets](https://blog.pepperclipp.com/pepperclipp-public/encrypting-buckets-for-compliance-and-ransom-how-attackers-can-use-kms-to-ransomware-s3-buckets)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3728761486,
                        "definition": {
                            "title": "PutKeyPolicy",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutKeyPolicy $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1312193623,
                        "definition": {
                            "type": "note",
                            "content": "### [ScheduleKeyDeletion](https://traildiscover.cloud/#KMS-ScheduleKeyDeletion)\n\n**Description:** Schedules the deletion of a KMS key.\n\n**Related Research:**\n- [ Threat Hunting with CloudTrail and GuardDuty in Splunk](https://www.chrisfarris.com/post/reinforce-threat-hunting/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3531884098,
                        "definition": {
                            "title": "ScheduleKeyDeletion",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:ScheduleKeyDeletion $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 10,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 575400953,
                        "definition": {
                            "type": "note",
                            "content": "### [Encrypt](https://traildiscover.cloud/#KMS-Encrypt)\n\n**Description:** Encrypts plaintext of up to 4,096 bytes using a KMS key. \n\n**Related Incidents:**\n- [Cloud Security Stories: From Risky Permissions to Ransomware Execution](https://sonraisecurity.com/blog/cloud-security-stories-from-risky-permissions-to-ransomware-execution/)\n**Related Research:**\n- [Encrypting buckets for compliance and ransom - How Attackers Can Use KMS to Ransomware S3 Buckets](https://blog.pepperclipp.com/pepperclipp-public/encrypting-buckets-for-compliance-and-ransom-how-attackers-can-use-kms-to-ransomware-s3-buckets)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2894430315,
                        "definition": {
                            "title": "Encrypt",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:Encrypt $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4082248566,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateKey](https://traildiscover.cloud/#KMS-CreateKey)\n\n**Description:** Creates a unique customer managed KMS key in your AWS account and Region.\n\n**Related Research:**\n- [Encrypting buckets for compliance and ransom - How Attackers Can Use KMS to Ransomware S3 Buckets](https://blog.pepperclipp.com/pepperclipp-public/encrypting-buckets-for-compliance-and-ransom-how-attackers-can-use-kms-to-ransomware-s3-buckets)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 4253794280,
                        "definition": {
                            "title": "CreateKey",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateKey $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3496923842,
                        "definition": {
                            "type": "note",
                            "content": "### [PutObject](https://traildiscover.cloud/#S3-PutObject)\n\n**Description:** Adds an object to a bucket.\n\n**Related Incidents:**\n- [Incident Report: TaskRouter JS SDK Security Incident - July 19, 2020](https://www.twilio.com/en-us/blog/incident-report-taskrouter-js-sdk-july-2020)\n- [LA Times homicide website throttles cryptojacking attack](https://www.tripwire.com/state-of-security/la-times-website-cryptojacking-attack)\n**Related Research:**\n- [Encrypting buckets for compliance and ransom - How Attackers Can Use KMS to Ransomware S3 Buckets](https://blog.pepperclipp.com/pepperclipp-public/encrypting-buckets-for-compliance-and-ransom-how-attackers-can-use-kms-to-ransomware-s3-buckets)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1520985908,
                        "definition": {
                            "title": "PutObject",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutObject $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 12,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1052767539,
                        "definition": {
                            "type": "note",
                            "content": "### [PutBucketVersioning](https://traildiscover.cloud/#S3-PutBucketVersioning)\n\n**Description:** Sets the versioning state of an existing bucket.\n\n**Related Incidents:**\n- [Ransomware in the cloud](https://www.invictus-ir.com/news/ransomware-in-the-cloud)\n**Related Research:**\n- [Exfiltrating S3 Data with Bucket Replication Policies](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1124974366,
                        "definition": {
                            "title": "PutBucketVersioning",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutBucketVersioning $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2714965386,
                        "definition": {
                            "type": "note",
                            "content": "### [PutBucketLifecycle](https://traildiscover.cloud/#S3-PutBucketLifecycle)\n\n**Description:** Creates a new lifecycle configuration for the bucket or replaces an existing lifecycle configuration.\n\n**Related Incidents:**\n- [USA VS Nickolas Sharp](https://www.justice.gov/usao-sdny/press-release/file/1452706/dl)\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 739027452,
                        "definition": {
                            "title": "PutBucketLifecycle",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutBucketLifecycle $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1380512479,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteBucket](https://traildiscover.cloud/#S3-DeleteBucket)\n\n**Description:** Deletes the S3 bucket.\n\n**Related Incidents:**\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3699541841,
                        "definition": {
                            "title": "DeleteBucket",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteBucket $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 14,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 613022674,
                        "definition": {
                            "type": "note",
                            "content": "### [PutBucketEncryption](https://traildiscover.cloud/#S3-PutBucketEncryption)\n\n**Description:** This operation configures default encryption and Amazon S3 Bucket Keys for an existing bucket.\n\n**Related Research:**\n- [Encrypting buckets for compliance and ransom - How Attackers Can Use KMS to Ransomware S3 Buckets](https://blog.pepperclipp.com/pepperclipp-public/encrypting-buckets-for-compliance-and-ransom-how-attackers-can-use-kms-to-ransomware-s3-buckets)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2932052036,
                        "definition": {
                            "title": "PutBucketEncryption",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutBucketEncryption $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1031926373,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteObject](https://traildiscover.cloud/#S3-DeleteObject)\n\n**Description:** Removes an object from a bucket. The behavior depends on the bucket's versioning state.\n\n**Related Incidents:**\n- [Ransomware in the cloud](https://www.invictus-ir.com/news/ransomware-in-the-cloud)\n- [The attack on ONUS \u2013 A real-life case of the Log4Shell vulnerability](https://cystack.net/research/the-attack-on-onus-a-real-life-case-of-the-log4shell-vulnerability)\n- [20/20 Eye Care Network and Hearing Care Network notify 3,253,822 health plan members of breach that deleted contents of AWS buckets](https://www.databreaches.net/20-20-eye-care-network-and-hearing-care-network-notify-3253822-health-plan-members-of-breach-that-deleted-contents-of-aws-buckets/)\n- [Hacker Puts Hosting Service Code Spaces Out of Business](https://threatpost.com/hacker-puts-hosting-service-code-spaces-out-of-business/106761/)\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n- [Securing a SaaS Company's AWS Environment After a Breach](https://badshah.io/case-studies/saas-aws-breach/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3251616848,
                        "definition": {
                            "title": "DeleteObject",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteObject $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 416994227,
                        "definition": {
                            "type": "note",
                            "content": "### [InvokeModel](https://traildiscover.cloud/#Bedrock-InvokeModel)\n\n**Description:** Invokes the specified Amazon Bedrock model to run inference using the prompt and inference parameters provided in the request body.\n\n**Related Incidents:**\n- [LLMjacking: Stolen Cloud Credentials Used in New AI Attack](https://sysdig.com/blog/llmjacking-stolen-cloud-credentials-used-in-new-ai-attack/)\n- [Detecting AI resource-hijacking with Composite Alerts](https://www.lacework.com/blog/detecting-ai-resource-hijacking-with-composite-alerts)\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n- [When AI Gets Hijacked: Exploiting Hosted Models for Dark Roleplaying](https://permiso.io/blog/exploiting-hosted-models)\n- [New Developments in LLM Hijacking Activity](https://www.wiz.io/blog/jinx-2401-llm-hijacking-aws)\n- [Datadog threat roundup: top insights for Q4 2024](https://securitylabs.datadoghq.com/articles/2024-q4-threat-roundup/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 489201054,
                        "definition": {
                            "title": "InvokeModel",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:InvokeModel $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 16,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2736781780,
                        "definition": {
                            "type": "note",
                            "content": "### [PutFoundationModelEntitlement](https://traildiscover.cloud/#Bedrock-PutFoundationModelEntitlement)\n\n**Description:** Grants permission to put entitlement to access a foundation model.\n\n**Related Incidents:**\n- [Detecting AI resource-hijacking with Composite Alerts](https://www.lacework.com/blog/detecting-ai-resource-hijacking-with-composite-alerts)\n- [When AI Gets Hijacked: Exploiting Hosted Models for Dark Roleplaying](https://permiso.io/blog/exploiting-hosted-models)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2808988607,
                        "definition": {
                            "title": "PutFoundationModelEntitlement",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutFoundationModelEntitlement $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3074261877,
                        "definition": {
                            "type": "note",
                            "content": "### [InvokeModelWithResponseStream](https://traildiscover.cloud/#Bedrock-InvokeModelWithResponseStream)\n\n**Description:** Grants permission to invoke the specified Bedrock model to run inference using the input provided in the request body with streaming response.\n\n**Related Incidents:**\n- [Detecting AI resource-hijacking with Composite Alerts](https://www.lacework.com/blog/detecting-ai-resource-hijacking-with-composite-alerts)\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n- [New Developments in LLM Hijacking Activity](https://www.wiz.io/blog/jinx-2401-llm-hijacking-aws)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1098323943,
                        "definition": {
                            "title": "InvokeModelWithResponseStream",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:InvokeModelWithResponseStream $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3292937846,
                        "definition": {
                            "type": "note",
                            "content": "### [PutUseCaseForModelAccess](https://traildiscover.cloud/#Bedrock-PutUseCaseForModelAccess)\n\n**Description:** Grants permission to put a use case for model access.\n\n**Related Incidents:**\n- [Detecting AI resource-hijacking with Composite Alerts](https://www.lacework.com/blog/detecting-ai-resource-hijacking-with-composite-alerts)\n- [When AI Gets Hijacked: Exploiting Hosted Models for Dark Roleplaying](https://permiso.io/blog/exploiting-hosted-models)\n- [New Developments in LLM Hijacking Activity](https://www.wiz.io/blog/jinx-2401-llm-hijacking-aws)\n- [Datadog threat roundup: top insights for Q4 2024](https://securitylabs.datadoghq.com/articles/2024-q4-threat-roundup/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3464483560,
                        "definition": {
                            "title": "PutUseCaseForModelAccess",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:PutUseCaseForModelAccess $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 18,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1258273715,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateFoundationModelAgreement](https://traildiscover.cloud/#Bedrock-CreateFoundationModelAgreement)\n\n**Description:** Grants permission to create a new foundation model agreement.\n\n**Related Incidents:**\n- [Detecting AI resource-hijacking with Composite Alerts](https://www.lacework.com/blog/detecting-ai-resource-hijacking-with-composite-alerts)\n- [When AI Gets Hijacked: Exploiting Hosted Models for Dark Roleplaying](https://permiso.io/blog/exploiting-hosted-models)\n- [New Developments in LLM Hijacking Activity](https://www.wiz.io/blog/jinx-2401-llm-hijacking-aws)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1429819429,
                        "definition": {
                            "title": "CreateFoundationModelAgreement",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateFoundationModelAgreement $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2149314562,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteVolume](https://traildiscover.cloud/#EC2-DeleteVolume)\n\n**Description:** Deletes the specified EBS volume. The volume must be in the available state (not attached to an instance).\n\n**Related Incidents:**\n- [Hacker Puts Hosting Service Code Spaces Out of Business](https://threatpost.com/hacker-puts-hosting-service-code-spaces-out-of-business/106761/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 74037741,
                        "definition": {
                            "title": "DeleteVolume",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteVolume $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2466107288,
                        "definition": {
                            "type": "note",
                            "content": "### [StartInstances](https://traildiscover.cloud/#EC2-StartInstances)\n\n**Description:** Starts an Amazon EBS-backed instance that you've previously stopped.\n\n**Related Incidents:**\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n**Related Research:**\n- [Executing commands through EC2 user data](https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/executing-commands-through-user-data/)\n- [Attack Paths Into VMs in the Cloud](https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2637653002,
                        "definition": {
                            "title": "StartInstances",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:StartInstances $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 20,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3134477404,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateDefaultVpc](https://traildiscover.cloud/#EC2-CreateDefaultVpc)\n\n**Description:** Creates a default VPC with a size /16 IPv4 CIDR block and a default subnet in each Availability Zone.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3206684231,
                        "definition": {
                            "title": "CreateDefaultVpc",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateDefaultVpc $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1307591041,
                        "definition": {
                            "type": "note",
                            "content": "### [TerminateInstances](https://traildiscover.cloud/#EC2-TerminateInstances)\n\n**Description:** Shuts down the specified instances. This operation is idempotent; if you terminate an instance more than once, each call succeeds.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n- [Former Cisco engineer sentenced to prison for deleting 16k Webex accounts](https://www.zdnet.com/article/former-cisco-engineer-sentenced-to-prison-for-deleting-16k-webex-accounts/)\n- [Hacker Puts Hosting Service Code Spaces Out of Business](https://threatpost.com/hacker-puts-hosting-service-code-spaces-out-of-business/106761/)\n- [Securing a SaaS Company's AWS Environment After a Breach](https://badshah.io/case-studies/saas-aws-breach/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3626620403,
                        "definition": {
                            "title": "TerminateInstances",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:TerminateInstances $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3933262383,
                        "definition": {
                            "type": "note",
                            "content": "### [StopInstances](https://traildiscover.cloud/#EC2-StopInstances)\n\n**Description:** Stops an Amazon EBS-backed instance.\n\n**Related Incidents:**\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n**Related Research:**\n- [Executing commands through EC2 user data](https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/executing-commands-through-user-data/)\n- [Attack Paths Into VMs in the Cloud](https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1957324449,
                        "definition": {
                            "title": "StopInstances",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:StopInstances $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 22,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 622941401,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteSnapshot](https://traildiscover.cloud/#EC2-DeleteSnapshot)\n\n**Description:** Deletes the specified snapshot.\n\n**Related Incidents:**\n- [Hacker Puts Hosting Service Code Spaces Out of Business](https://threatpost.com/hacker-puts-hosting-service-code-spaces-out-of-business/106761/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 695148228,
                        "definition": {
                            "title": "DeleteSnapshot",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteSnapshot $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 985219393,
                        "definition": {
                            "type": "note",
                            "content": "### [RunInstances](https://traildiscover.cloud/#EC2-RunInstances)\n\n**Description:** Launches the specified number of instances using an AMI for which you have permissions.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [DXC spills AWS private keys on public GitHub](https://www.theregister.com/2017/11/14/dxc_github_aws_keys_leaked/)\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [Behind the scenes in the Expel SOC: Alert-to-fix in AWS](https://expel.com/blog/behind-the-scenes-expel-soc-alert-aws/)\n- [When a Zero Day and Access Keys Collide in the Cloud: Responding to the SugarCRM Zero-Day Vulnerability](https://unit42.paloaltonetworks.com/sugarcrm-cloud-incident-black-hat/)\n- [SCARLETEEL 2.0: Fargate, Kubernetes, and Crypto](https://sysdig.com/blog/scarleteel-2-0/)\n- [ANATOMY OF AN ATTACK: EXPOSED KEYS TO CRYPTO MINING](https://permiso.io/blog/s/anatomy-of-attack-exposed-keys-to-crypto-mining/)\n- [UNMASKING GUI-VIL: FINANCIALLY MOTIVATED CLOUD THREAT ACTOR](https://permiso.io/blog/s/unmasking-guivil-new-cloud-threat-actor/)\n- [Clear and Uncommon Story About Overcoming Issues With AWS](https://urancompany.com/blog/clear-and-uncommon-story-about-overcoming-issues-aws)\n- [onelogin 2017 Security Incident](https://web.archive.org/web/20210620180614/https://www.onelogin.com/blog/may-31-2017-security-incident)\n- [BrowserStack analysis: unpatched inactive machine compromised by shellshock vulnerability](https://www.databreaches.net/browserstack-analysis-unpatched-inactive-machine-compromised-by-shellshock-vulnerability/)\n- [Navigating the Cloud: Exploring Lateral Movement Techniques](https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/)\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n- [Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments](https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/)\n**Related Research:**\n- [Launching EC2 instances](https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/launching-ec2-instances/)\n- [Hunting for signs of persistence in the cloud: an IR guide following the CircleCI incident](https://www.wiz.io/blog/hunting-for-signs-of-persistence-in-the-cloud-an-ir-guide)\n- [AWS IAM Privilege Escalation Techniques](https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/)\n- [Abusing VPC Traffic Mirroring in AWS](https://rhinosecuritylabs.com/aws/abusing-vpc-traffic-mirroring-in-aws/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3204909868,
                        "definition": {
                            "title": "RunInstances",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:RunInstances $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3919001856,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteGlobalCluster](https://traildiscover.cloud/#RDS-DeleteGlobalCluster)\n\n**Description:** Deletes a global database cluster. The primary and secondary clusters must already be detached or destroyed first.\n\n**Related Research:**\n- [AWS Deletion of RDS Instance or Cluster](https://www.elastic.co/guide/en/security/current/aws-deletion-of-rds-instance-or-cluster.html)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3991208683,
                        "definition": {
                            "title": "DeleteGlobalCluster",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteGlobalCluster $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 24,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2932533951,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteDBCluster](https://traildiscover.cloud/#RDS-DeleteDBCluster)\n\n**Description:** The DeleteDBCluster action deletes a previously provisioned DB cluster.\n\n**Related Incidents:**\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n**Related Research:**\n- [Hunting AWS RDS security events with Sysdig](https://sysdig.com/blog/aws-rds-security-events-sysdig/)\n- [AWS Deletion of RDS Instance or Cluster](https://www.elastic.co/guide/en/security/current/aws-deletion-of-rds-instance-or-cluster.html)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 956596017,
                        "definition": {
                            "title": "DeleteDBCluster",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteDBCluster $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 2547144291,
                        "definition": {
                            "type": "note",
                            "content": "### [DeleteDBInstance](https://traildiscover.cloud/#RDS-DeleteDBInstance)\n\n**Description:** Deletes a previously provisioned DB instance.\n\n**Related Incidents:**\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 571206357,
                        "definition": {
                            "title": "DeleteDBInstance",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:DeleteDBInstance $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1523675174,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateEmailIdentity](https://traildiscover.cloud/#SES-CreateEmailIdentity)\n\n**Description:** Starts the process of verifying an email identity. An identity is an email address or domain that you use when you send email.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1595882001,
                        "definition": {
                            "title": "CreateEmailIdentity",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateEmailIdentity $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 26,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 814417762,
                        "definition": {
                            "type": "note",
                            "content": "### [UpdateAccountSendingEnabled](https://traildiscover.cloud/#SES-UpdateAccountSendingEnabled)\n\n**Description:** Enables or disables email sending across your entire Amazon SES account in the current AWS Region.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n- [SES-PIONAGE](https://permiso.io/blog/s/aws-ses-pionage-detecting-ses-abuse/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 28,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 886624589,
                        "definition": {
                            "title": "UpdateAccountSendingEnabled",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:UpdateAccountSendingEnabled $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 28,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 761320824,
                        "definition": {
                            "type": "note",
                            "content": "### [VerifyEmailIdentity](https://traildiscover.cloud/#SES-VerifyEmailIdentity)\n\n**Description:** Adds an email address to the list of identities for your Amazon SES account in the current AWS Region and attempts to verify it.\n\n**Related Incidents:**\n- [Compromised Cloud Compute Credentials: Case Studies From the Wild](https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/#post-125981-_kdq0vw6banab)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 28,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3080350186,
                        "definition": {
                            "title": "VerifyEmailIdentity",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:VerifyEmailIdentity $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 28,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1646871160,
                        "definition": {
                            "type": "note",
                            "content": "### [RegisterTaskDefinition](https://traildiscover.cloud/#ECS-RegisterTaskDefinition)\n\n**Description:** Registers a new task definition from the supplied family and containerDefinitions.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 28,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3965900522,
                        "definition": {
                            "title": "RegisterTaskDefinition",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:RegisterTaskDefinition $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 28,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1048753880,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateService](https://traildiscover.cloud/#ECS-CreateService)\n\n**Description:** Runs and maintains your desired number of tasks from a specified task definition.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 0,
                            "y": 30,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3367783242,
                        "definition": {
                            "title": "CreateService",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateService $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 2,
                            "y": 30,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3201164627,
                        "definition": {
                            "type": "note",
                            "content": "### [CreateCluster](https://traildiscover.cloud/#ECS-CreateCluster)\n\n**Description:** Creates a new Amazon ECS cluster.\n\n**Related Incidents:**\n- [Tales from the cloud trenches: Amazon ECS is the new EC2 for crypto mining](https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-ecs-crypto-mining/)\n- [New tactics and techniques for proactive threat detection](https://reinforce.awsevents.com/content/dam/reinforce/2024/slides/TDR432_New-tactics-and-techniques-for-proactive-threat-detection.pdf)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 4,
                            "y": 30,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3273371454,
                        "definition": {
                            "title": "CreateCluster",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:CreateCluster $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 6,
                            "y": 30,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 1031087449,
                        "definition": {
                            "type": "note",
                            "content": "### [RequestServiceQuotaIncrease](https://traildiscover.cloud/#ServiceQuotas-RequestServiceQuotaIncrease)\n\n**Description:** Submits a quota increase request for the specified quota at the account or resource level.\n\n**Related Incidents:**\n- [The curious case of DangerDev@protonmail.me](https://www.invictus-ir.com/news/the-curious-case-of-dangerdev-protonmail-me)\n- [Incident report: From CLI to console, chasing an attacker in AWS](https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/)\n",
                            "background_color": "white",
                            "font_size": "14",
                            "text_align": "left",
                            "vertical_align": "top",
                            "show_tick": false,
                            "has_padding": true
                        },
                        "layout": {
                            "x": 8,
                            "y": 30,
                            "width": 2,
                            "height": 2
                        }
                    },
                    {
                        "id": 3350116811,
                        "definition": {
                            "title": "RequestServiceQuotaIncrease",
                            "title_size": "16",
                            "title_align": "left",
                            "type": "query_value",
                            "requests": [
                                {
                                    "response_format": "scalar",
                                    "queries": [
                                        {
                                            "data_source": "logs",
                                            "name": "query1",
                                            "indexes": [
                                                "*"
                                            ],
                                            "compute": {
                                                "aggregation": "count"
                                            },
                                            "search": {
                                                "query": "source:cloudtrail @evt.name:RequestServiceQuotaIncrease $userIdentity.arn $network.client.ip $account"
                                            }
                                        }
                                    ],
                                    "formulas": [
                                        {
                                            "formula": "query1"
                                        }
                                    ]
                                }
                            ],
                            "autoscale": true,
                            "precision": 2
                        },
                        "layout": {
                            "x": 10,
                            "y": 30,
                            "width": 2,
                            "height": 2
                        }
                    }
                ]
            },
            "layout": {
                "x": 0,
                "y": 243,
                "width": 12,
                "height": 34
            }
        }
    ],
    "layout_type": "ordered",
    "template_variables": [
        {
            "name": "userIdentity.arn",
            "prefix": "@userIdentity.arn",
            "available_values": [],
            "default": "*"
        },
        {
            "name": "network.client.ip",
            "prefix": "@network.client.ip",
            "available_values": [],
            "default": "*"
        },
        {
            "name": "account",
            "prefix": "account",
            "available_values": [],
            "default": "*"
        }
    ],
    "notify_list": [],
    "reflow_type": "fixed"
}